<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>stack_map &#8212; sofia_redux v1.3.4.dev38+g92ea2f4</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=6aa39468"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="icon" href="../_static/redux.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="stack_c3d" href="sofia_redux.instruments.forcast.stack.stack_c3d.html" />
    <link rel="prev" title="stack_c2nc2" href="sofia_redux.instruments.forcast.stack.stack_c2nc2.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://irsa.ipac.caltech.edu/Missions/sofia.html"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="sofia_redux.instruments.forcast.stack.stack_c3d.html" title="stack_c3d">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="sofia_redux.instruments.forcast.stack.stack_c2nc2.html" title="stack_c2nc2">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">sofia_redux v1.3.4.dev38+g92ea2f4</a>
	 &#187;
      </li>
      <li><a href="../sofia_redux/index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../manuals/forcast/developers/developers.html" accesskey="U">FORCAST Redux Developer’s Manual</a> &#187;</li>
      
      <li>stack_map</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="stack-map">
<h1>stack_map<a class="headerlink" href="#stack-map" title="Link to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="sofia_redux.instruments.forcast.stack.stack_map">
<span class="sig-prename descclassname"><span class="pre">sofia_redux.instruments.forcast.stack.</span></span><span class="sig-name descname"><span class="pre">stack_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bglevel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/instruments/forcast/stack.html#stack_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.instruments.forcast.stack.stack_map" title="Link to this definition">¶</a></dt>
<dd><p>Run the stacking algorithm on MAP (Mapping mode) data</p>
<p>Calculates the chop and nod-subtracted frames.  For each frame in a
set of 4 using scale s, the algorithm would be:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>chop1 = frame1 - (frame2 * s1/s2)</p></li>
<li><p>chop2 = frame3 - (frame4 * s3/s4)</p></li>
<li><p>nod = chop1 - (chop2 * s1/s3)</p></li>
<li><p>result = sum(nods from each set of 4)</p></li>
<li><p>if NODBEAM = ‘B’, multiply by -1</p></li>
</ol>
</div></blockquote>
<p>If the number of frames is not divisible by four, frames at the
end will be clipped from any reductions.  e.g., in the above
algorithm, if there were 10 frames, only frames 1-8 would be
included.  i.e. steps 1-3 would be run on frames 1-4, then on
frames 5-8, and then the sum would be returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>(npos, nrow, ncol)</p>
</dd>
<dt><strong>header</strong><span class="classifier">astropy.io.fits.header.Header</span></dt><dd><p>FITS header to update with HISTORY messages</p>
</dd>
<dt><strong>variance</strong><span class="classifier">numpy.ndarray, optional</span></dt><dd><p>variance array to propagate (npos, nrow, ncol)</p>
</dd>
<dt><strong>bglevel</strong><span class="classifier">array_like, optional</span></dt><dd><p>should be of length npos</p>
</dd>
<dt><strong>extra</strong><span class="classifier">dict, optional</span></dt><dd><dl class="simple">
<dt>If set will be updated with:</dt><dd><dl class="simple">
<dt>chopsub -&gt; numpy.ndarray (npos / 2, nrow, ncol)</dt><dd><p>chop-subtracted data</p>
</dd>
<dt>nodsub -&gt; numpy.ndarray (npos / 4, nrow, ncol)</dt><dd><p>nod-subtracted data</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>2-tuple</dt><dd><p>numpy.ndarray : The stacked data array (nrow, ncol)
numpy.ndarray : The propagated variance array (nrow, ncol)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">stack_map</a><ul>
<li><a class="reference internal" href="#sofia_redux.instruments.forcast.stack.stack_map"><code class="docutils literal notranslate"><span class="pre">stack_map()</span></code></a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/sofia_redux.instruments.forcast.stack.stack_map.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2024, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.2.6. &nbsp;
    Last built 05 Feb 2024. <br/>
  </p>
</footer>
  </body>
</html>