<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Polynomial Coefficients &#8212; sofia_redux v1.3.4.dev38+g92ea2f4</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    
    <script src="../../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../../_static/documentation_options.js?v=6aa39468"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/javascript" src="../../../_static/sidebar.js"></script>
    <script type="text/javascript" src="../../../_static/copybutton.js"></script>
    <link rel="icon" href="../../../_static/redux.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Image Algorithms (sofia_redux.toolkit.image)" href="../image/index.html" />
    <link rel="prev" title="Search Phase" href="fitpeaks1d.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://irsa.ipac.caltech.edu/Missions/sofia.html"></a></li>
    <li><a title="General Index" href="../../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="../image/index.html" title="Image Algorithms (sofia_redux.toolkit.image)">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="fitpeaks1d.html" title="Search Phase">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../../../index.html">sofia_redux v1.3.4.dev38+g92ea2f4</a>
	 &#187;
      </li>
      <li><a href="../../index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../index.html" >sofia_redux.toolkit: Shared Utilities for SOFIA Pipelines</a> &#187;</li>
      <li><a href="index.html" accesskey="U">Fitting  (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sofia_redux.toolkit.fitting</span></code>)</a> &#187;</li>
      
      <li>Polynomial Coefficients</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <p>Generally, polynomial algorithms in the <code class="xref py py-mod docutils literal notranslate"><span class="pre">sofia_redux.toolkit.fitting</span></code> module
either fit polynomial coefficients to a sample distribution, or evaluate
polynomial coefficients at a given location.  The <a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.polynomial.polyfitnd.html#sofia_redux.toolkit.fitting.polynomial.polyfitnd" title="sofia_redux.toolkit.fitting.polynomial.polyfitnd"><code class="xref py py-func docutils literal notranslate"><span class="pre">polyfitnd()</span></code></a> function
is used to derive polynomial coefficients, while <a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.polynomial.poly1d.html#sofia_redux.toolkit.fitting.polynomial.poly1d" title="sofia_redux.toolkit.fitting.polynomial.poly1d"><code class="xref py py-func docutils literal notranslate"><span class="pre">poly1d()</span></code></a> or
<a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.polynomial.polynd.html#sofia_redux.toolkit.fitting.polynomial.polynd" title="sofia_redux.toolkit.fitting.polynomial.polynd"><code class="xref py py-func docutils literal notranslate"><span class="pre">polynd()</span></code></a> functions evaluate coefficients in 1 or N dimensions
respectively.  The <a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.polynomial.Polyfit.html#sofia_redux.toolkit.fitting.polynomial.Polyfit" title="sofia_redux.toolkit.fitting.polynomial.Polyfit"><code class="xref py py-class docutils literal notranslate"><span class="pre">Polyfit</span></code></a> class is capable of both deriving and
evaluating polynomials.  However, if one only wishes to derive and then
evaluate a polynomial fit to data (i.e. resample) but does not require the
actual coefficients using piecewise fits, it is recommended to instead refer
to <a class="reference internal" href="../index.html#module-sofia_redux.toolkit.resampling" title="sofia_redux.toolkit.resampling"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sofia_redux.toolkit.resampling</span></code></a>, developed for just that purpose.</p>
<section id="polynomial-coefficients">
<h1>Polynomial Coefficients<a class="headerlink" href="#polynomial-coefficients" title="Link to this heading">¶</a></h1>
<p>In this scheme, coefficients are stored as an N-dimensional array with the
size of each dimension equal to the polynomial degree (order + 1) set for that
dimension. For example, if we wish to fit a set of 2-dimensional data with a
2nd order (degree=3) polynomial in x, and a 3rd order (degree=4) polynomial in
y, an array of shape (3, 4) would be used to contain the polynomial
coefficients necessary to model the data with the desired polynomial.</p>
<p>Polynomial functions model distribution <span class="math notranslate nohighlight">\(x\)</span> as:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[f(x) = \sum_{p_{1}=0}^{o_{1}} \sum_{p_{2}=0}^{o_{2}}
       ... \sum_{p_{N}=0}^{o_{N}}
    a_{(p_{1},p_{2},...,p_{N})}
    x_{1}^{p_{1}} x_{2}^{p_{2}} ... x_{N}^{p_{N}}\]</div>
</div></blockquote>
<p>in <span class="math notranslate nohighlight">\(N\)</span> dimensions where <span class="math notranslate nohighlight">\(o_{i}\)</span> is the polynomial order fitted to
dimension <span class="math notranslate nohighlight">\(i\)</span>, and <span class="math notranslate nohighlight">\(a\)</span> are the polynomial coefficients.  For
example, polynomial coefficients could be used to model the function</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[f(x) = 5 + 2x + 3xy + 0.5y^{2}\]</div>
</div></blockquote>
<p>as</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}a =
\begin{bmatrix}
        5   &amp; 2 &amp; 0 \\
        0   &amp; 3 &amp; 0 \\
        0.5 &amp; 0 &amp; 0
\end{bmatrix}\end{split}\]</div>
</div></blockquote>
<p>using a second order polynomial in both x and y.</p>
<p>The following example uses <a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.polynomial.polyfitnd.html#sofia_redux.toolkit.fitting.polynomial.polyfitnd" title="sofia_redux.toolkit.fitting.polynomial.polyfitnd"><code class="xref py py-func docutils literal notranslate"><span class="pre">polyfitnd()</span></code></a> to derive these coefficients:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sofia_redux.toolkit.fitting.polynomial</span> <span class="kn">import</span> <span class="n">polyfitnd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">]</span>
<span class="n">z</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">y</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">polyfitnd</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">[[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                       <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
</pre></div>
</div>
<p>These coefficients can then be evaluated using <a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.polynomial.polynd.html#sofia_redux.toolkit.fitting.polynomial.polynd" title="sofia_redux.toolkit.fitting.polynomial.polynd"><code class="xref py py-func docutils literal notranslate"><span class="pre">polynd()</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sofia_redux.toolkit.fitting.polynomial</span> <span class="kn">import</span> <span class="n">polynd</span>

<span class="n">fitted</span> <span class="o">=</span> <span class="n">polynd</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)),</span> <span class="n">a</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">fitted</span><span class="p">)</span>
</pre></div>
</div>
<p>Both derivation and evaluation can be performed by the <a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.polynomial.Polyfit.html#sofia_redux.toolkit.fitting.polynomial.Polyfit" title="sofia_redux.toolkit.fitting.polynomial.Polyfit"><code class="xref py py-class docutils literal notranslate"><span class="pre">Polyfit</span></code></a> class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sofia_redux.toolkit.fitting.polynomial</span> <span class="kn">import</span> <span class="n">Polyfit</span>

<span class="n">pfit</span> <span class="o">=</span> <span class="n">Polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">pfit</span><span class="o">.</span><span class="n">get_coefficients</span><span class="p">(),</span> <span class="n">a</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">pfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
<p>Please note however, that in all the above examples, we have used the default
redundant polynomial representation such that no coefficients will be
calculated for <span class="math notranslate nohighlight">\(a\)</span> when <span class="math notranslate nohighlight">\(\sum_{i=1}^{N}{p_i} &gt; max(o)\)</span>.  So for
a redundant (default) polynomial fit of order 2 in both dimensions</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}a =
\begin{bmatrix}
        5   &amp; 2 &amp; 0 \\
        0   &amp; 3 &amp; - \\
        0.5 &amp; - &amp; -
\end{bmatrix}\end{split}\]</div>
</div></blockquote>
<p>where values marked with <span class="math notranslate nohighlight">\(-\)</span> will always be set to zero since they are
defined as redundant.</p>
<p>This default redundancy behaviour may be overridden by explicitly providing
terms for which coefficients must be derived.  The format of these terms
should be provided as an integer array of shape (n_terms, n_dimensions), with
each value corresponding to the power of a single term in a specific dimension.
For example, in 3-dimensions, the value [1, 2, 3] would result in a coefficient
being calculated for term <span class="math notranslate nohighlight">\(xy^2z^3\)</span>.  The
<code class="xref py py-func docutils literal notranslate"><span class="pre">sofia_redux.toolkit.utilities.func.polyexp()</span></code> may be used for the purposes of
creating either full or redundant set of terms.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sofia_redux.toolkit.fitting.polynomial</span> <span class="kn">import</span> <span class="n">polyexp</span>
<span class="c1"># Create a redundant set of terms</span>
<span class="n">redundant</span> <span class="o">=</span> <span class="n">polyexp</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">redundant</span><span class="p">)</span>
<span class="c1"># [[0 0]</span>
<span class="c1">#  [1 0]</span>
<span class="c1">#  [2 0]</span>
<span class="c1">#  [0 1]</span>
<span class="c1">#  [1 1]</span>
<span class="c1">#  [0 2]]</span>
</pre></div>
</div>
<p>The above redundant set results in a function of the form:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[f(x) = a_{0,0} + a_{1,0}x + a_{2,0}x^2 + a_{0,1}y +
       a_{1,1}xy + a_{0,2}y^2\]</div>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a full set of terms</span>
<span class="n">full</span> <span class="o">=</span> <span class="n">polyexp</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">full</span><span class="p">)</span>
<span class="c1"># [[0 0]</span>
<span class="c1">#  [1 0]</span>
<span class="c1">#  [2 0]</span>
<span class="c1">#  [0 1]</span>
<span class="c1">#  [1 1]</span>
<span class="c1">#  [2 1]</span>
<span class="c1">#  [0 2]</span>
<span class="c1">#  [1 2]</span>
<span class="c1">#  [2 2]]</span>
</pre></div>
</div>
<p>The above full set results in a function of the form:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[f(x) = a_{0,0} + a_{1,0}x + a_{2,0}x^2 + a_{0,1}y +
       a_{1,1}xy + a_{2,1}x^2y + a_{0,2}y^2 + a_{1,2}xy^2 +
       a_{2,2}x^2y^2\]</div>
</div></blockquote>
<p>Alternatively, terms may be explicitly defined by the user:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">user</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
</pre></div>
</div>
<p>In this case, the user has specified that coefficients should only by derived
for the terms in the following function:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[f(x) = a_{2,0}x^2 + a_{1,1}xy\]</div>
</div></blockquote>
<p>For example, attempting to fit the function</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[f(x) = 1 + 2xy + 0.1x^2y^2\]</div>
</div></blockquote>
<p>can only be done with either a full or user defined set of terms since
<span class="math notranslate nohighlight">\(x^2y^2\)</span> will never appear in a redundant set of a 2nd order
2-dimensional polynomial function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">]</span>
<span class="n">z</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">y</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">redundant_pfit</span> <span class="o">=</span> <span class="n">Polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">redundant_pfit</span><span class="o">.</span><span class="n">get_coefficients</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="c1"># [[ 3.8 -3.2  0.6]</span>
<span class="c1">#  [-3.2  3.6  0. ]</span>
<span class="c1">#  [ 0.6  0.   0. ]]</span>

<span class="n">full_pfit</span> <span class="o">=</span> <span class="n">Polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">polyexp</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span> <span class="n">set_exponents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">full_pfit</span><span class="o">.</span><span class="n">get_coefficients</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="c1"># [[ 1.  -0.   0. ]</span>
<span class="c1">#  [-0.   2.  -0. ]</span>
<span class="c1">#  [ 0.  -0.   0.1]]</span>

<span class="n">user_pfit</span> <span class="o">=</span> <span class="n">Polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span> <span class="n">set_exponents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">user_pfit</span><span class="o">.</span><span class="n">get_coefficients</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="c1"># [[1.  0.  0. ]</span>
<span class="c1">#  [0.  2.  0. ]</span>
<span class="c1">#  [0.  0.  0.1]]</span>
</pre></div>
</div>
<p>As can be seen above, the default redundant set of terms failed to derive the
correct coefficients, but made its best attempt using those terms available.
The full and user defined sets both returned the correct values.  Note that in
order to override the default redundant behaviour, <code class="xref py py-obj docutils literal notranslate"><span class="pre">set_exponents=True</span></code> must
be set as a keyword argument.  Also note that while the redundant fit failed,
the resulting fit is the “best fit” with the terms available as can be
seen below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sofia_redux.toolkit.fitting.polynomial</span> <span class="kn">import</span> <span class="n">Polyfit</span>

<span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">]</span>
<span class="n">z</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">y</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">redundant_pfit</span> <span class="o">=</span> <span class="n">Polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">redundant_pfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Redundant fit&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;f(x, y)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Redundant term set fit&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../../_downloads/e9bd44443ac6861cf950bfc0580308b8/polynomial-1.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/91aee1777e8730b1b767ab07e97ebe14/polynomial-1.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/a175e0ed771132bf55b96c3e6c537647/polynomial-1.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/3e813a67dd7e4b3215f5ecf2c2bc90c6/polynomial-1.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../../_images/polynomial-1.png" class="plot-directive" src="../../../_images/polynomial-1.png" />
</figure>
<p>Plots for the full and user defined sets would reproduce the original data.</p>
</section>
<section id="fit-statistics">
<h1>Fit Statistics<a class="headerlink" href="#fit-statistics" title="Link to this heading">¶</a></h1>
<p>In addition to performing and evaluating a polynomial fit, <a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.polynomial.Polyfit.html#sofia_redux.toolkit.fitting.polynomial.Polyfit" title="sofia_redux.toolkit.fitting.polynomial.Polyfit"><code class="xref py py-class docutils literal notranslate"><span class="pre">Polyfit</span></code></a>
can also return useful statistics including covariance terms.  The
<code class="xref py py-attr docutils literal notranslate"><span class="pre">Polyfit.stats</span></code> attribute is a namespace containing the following
statistics:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">n</span></code>: Number of samples</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">dof</span></code>: Degrees of Freedom</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code>: An array containing the fit to the original data</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">residuals</span></code>: An array containing the difference between the data and the fit</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">sigma</span></code>: An array containing the error of each polynomial coefficient</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">rms</span></code>: The root-mean-square error on the fit</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">chi2</span></code>: The <span class="math notranslate nohighlight">\(\chi^2\)</span> statistic on the fit</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">rchi2</span></code>: The reduced <span class="math notranslate nohighlight">\(\chi^2\)</span> statistic on the fit</p></li>
<li><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">q</span></code>: Goodness of fit, or survival function.  The probability (0-&gt;1) that</dt><dd><p>one of the samples is greater than <span class="math notranslate nohighlight">\(\chi^2\)</span> away from the fit.</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p>These can be accessed directly or printed to screen by applying the standard
Python <a class="reference external" href="https://docs.python.org/3/library/functions.html#print" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">print()</span></code></a> function to an initialized <a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.polynomial.Polyfit.html#sofia_redux.toolkit.fitting.polynomial.Polyfit" title="sofia_redux.toolkit.fitting.polynomial.Polyfit"><code class="xref py py-class docutils literal notranslate"><span class="pre">Polyfit</span></code></a> object.  For
example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sofia_redux.toolkit.fitting.polynomial</span> <span class="kn">import</span> <span class="n">Polyfit</span>

<span class="c1"># Create function</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>

<span class="c1"># add noise with a normal distribution</span>
<span class="n">rand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">rand</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="n">y</span> <span class="o">+=</span> <span class="n">noise</span>

<span class="c1"># Fit a 2nd order polynomial to the noisy data</span>
<span class="c1"># Since we know the scale of the error, it may be included</span>
<span class="n">pfit</span> <span class="o">=</span> <span class="n">Polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Samples&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pfit</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">fit</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Fit&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Polynomial fit to noisy data&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pfit</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">residuals</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Residuals to the fit&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">pfit</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../../_downloads/e0ade7a3260715253879715690919b8c/polynomial-2.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/36af5ea9257ade8794ff92252cf82c3b/polynomial-2.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/173e29760896d5ca3fa023d21efb9194/polynomial-2.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/13d29f69f7da6e56a527c411cbc8a10c/polynomial-2.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../../_images/polynomial-2.png" class="plot-directive" src="../../../_images/polynomial-2.png" />
</figure>
<p>Textual output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Name: Polyfit

         Statistics
--------------------------------
Number of original points : 256
           Number of NaNs : 0
       Number of outliers : 0
     Number of points fit : 256
       Degrees of freedom : 253
              Chi-Squared : 240.743406
      Reduced Chi-Squared : 0.951555
      Goodness-of-fit (Q) : 0.300082
     RMS deviation of fit : 0.485822

    Exponents : Coefficients
--------------------------------
(0,) : 3.396036 +/- 0.093022
(1,) : -3.840006 +/- 0.214879
(2,) : 0.958356 +/- 0.104002
</pre></div>
</div>
<section id="covariance">
<h2>Covariance<a class="headerlink" href="#covariance" title="Link to this heading">¶</a></h2>
<p>The full covariance matrix is available in the <code class="xref py py-attr docutils literal notranslate"><span class="pre">Polyfit.covariance</span></code>
attribute.  Note that this is an (n_coefficient, n_coefficient) giving the
covariance between terms, with each axis ordered in the same manner as the
terms.  The order of the terms can be determined from the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">Polyfit.exponents</span></code> attribute.  For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sofia_redux.toolkit.fitting.polynomial</span> <span class="kn">import</span> <span class="n">Polyfit</span>

<span class="c1"># Create a function</span>
<span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[:</span><span class="mi">10</span><span class="p">,</span> <span class="p">:</span><span class="mi">10</span><span class="p">]</span>
<span class="n">z</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span>
<span class="n">pfit</span> <span class="o">=</span> <span class="n">Polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exponents:</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">pfit</span><span class="o">.</span><span class="n">exponents</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Covariance:</span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">pfit</span><span class="o">.</span><span class="n">covariance</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Exponents:
[[0 0]
 [1 0]
 [0 1]]

Covariance:
[[ 5.90909091e-02 -5.45454545e-03 -5.45454545e-03]
 [-5.45454545e-03  1.21212121e-03  4.33680869e-19]
 [-5.45454545e-03 -0.00000000e+00  1.21212121e-03]]
</pre></div>
</div>
<p>In the above example, the rows and columns of the  covariance matrix are
ordered as <span class="math notranslate nohighlight">\(a_{0,0}, a_{1, 0}, a_{0,1}\)</span> for the terms
<span class="math notranslate nohighlight">\(x^0y^0, x, y\)</span>.</p>
</section>
<section id="disabling-statistics">
<h2>Disabling Statistics<a class="headerlink" href="#disabling-statistics" title="Link to this heading">¶</a></h2>
<p>If statistics are not required, there is no need for a covariance matrix, and
processing speed is important, statistical calculations may be disabled by
setting <code class="xref py py-obj docutils literal notranslate"><span class="pre">stats=False</span></code> and/or covar=False during intialization.  If statistics
are disabled, they will no longer be calculated or displayed.  If covariance
calculations are disabled, the <code class="xref py py-attr docutils literal notranslate"><span class="pre">Polyfit.covariance</span></code> attribute will be
set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sofia_redux.toolkit.fitting.polynomial</span> <span class="kn">import</span> <span class="n">Polyfit</span>

<span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[:</span><span class="mi">10</span><span class="p">,</span> <span class="p">:</span><span class="mi">10</span><span class="p">]</span>
<span class="n">z</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span>
<span class="n">pfit</span> <span class="o">=</span> <span class="n">Polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">stats</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">covar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">pfit</span><span class="o">.</span><span class="n">covariance</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pfit</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Name: Polyfit

    Exponents : Coefficients
--------------------------------
(0, 0) : 1.000000
(1, 0) : -5.000000
(0, 1) : 3.000000
</pre></div>
</div>
<p>However, if robust outlier rejection is enabled, by necessity, both statistics
and covariance will be calculated regardless of user wishes.</p>
</section>
<section id="robust-outlier-rejection">
<h2>Robust Outlier Rejection<a class="headerlink" href="#robust-outlier-rejection" title="Link to this heading">¶</a></h2>
<p>Robust outlier rejection may be enabled by setting <code class="xref py py-obj docutils literal notranslate"><span class="pre">robust</span></code> &gt; 0 during
<a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.polynomial.Polyfit.html#sofia_redux.toolkit.fitting.polynomial.Polyfit" title="sofia_redux.toolkit.fitting.polynomial.Polyfit"><code class="xref py py-class docutils literal notranslate"><span class="pre">Polyfit</span></code></a> initialization.  If set, outliers are identified through an
iterative process: fitting the data then excluding any samples that fall
outside <code class="xref py py-obj docutils literal notranslate"><span class="pre">robust</span></code> sigmas from the fit before repeating.  Iterations are
terminated after:</p>
<ol class="arabic simple">
<li><p>A certain number of iterations have occurred.</p></li>
<li><p>The relative delta between successive residual RMS values is less than a set
value.</p></li>
</ol>
<ol class="arabic simple" start="4">
<li><p>Too many samples are excluded such that fitting the desired order of
polynomial will not be possible.</p></li>
<li><p>The fit failed.</p></li>
</ol>
<p>Whether the iteration succeeded can be determined from the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">Polyfit.success</span></code> attribute, while the termination condition encountered
is in the <code class="xref py py-attr docutils literal notranslate"><span class="pre">Polyfit.termination</span></code> attribute.  Which samples were excluded
during the rejection process can be determined from the <code class="xref py py-attr docutils literal notranslate"><span class="pre">Polyfit.mask</span></code>
attribute.  Additional statistics will also be displayed if statistics are
printed to screen.  For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sofia_redux.toolkit.fitting.polynomial</span> <span class="kn">import</span> <span class="n">Polyfit</span>

<span class="c1"># Create a function</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">x</span>
<span class="n">rand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Add noise</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">rand</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">y</span> <span class="o">+=</span> <span class="n">noise</span>

<span class="c1"># Add some obvious outliers, throwing off the fit</span>
<span class="n">inds</span> <span class="o">=</span> <span class="n">rand</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">y</span><span class="p">[</span><span class="n">inds</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">5</span>

<span class="c1"># Standard fit</span>
<span class="n">pfit</span> <span class="o">=</span> <span class="n">Polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Robust fit with 3 sigma outlier rejection</span>
<span class="n">rfit</span> <span class="o">=</span> <span class="n">Polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">robust</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">outliers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="o">~</span><span class="n">rfit</span><span class="o">.</span><span class="n">mask</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Samples&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pfit</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">fit</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Standard Fit&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">rfit</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">fit</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Robust Fit&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">outliers</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">outliers</span><span class="p">],</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Outliers&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Robust Outlier Rejection&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;f(x)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Display robust statistics</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rfit</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../../_downloads/93323af4569ad34911d774847f6f0782/polynomial-3.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/5acc03f5f79a393425365e49815c0b02/polynomial-3.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/e34e75db0159634878dd87831deb41b0/polynomial-3.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/f8574de4c26e9c248b1a0cef4ecae606/polynomial-3.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../../_images/polynomial-3.png" class="plot-directive" src="../../../_images/polynomial-3.png" />
</figure>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Name: Polyfit

         Statistics
--------------------------------
Number of origial points : 256
          Number of NaNs : 0
      Number of outliers : 24
    Number of points fit : 232
      Degrees of freedom : 230
             Chi-Squared : 53.825532
     Reduced Chi-Squared : 0.234024
     Goodness-of-fit (Q) : 0.000000
    RMS deviation of fit : 0.482712
 Outlier sigma threshold : 3
 eps (delta_sigma/sigma) : 0.01
              Iterations : 3
   Iteration termination : delta_rms = 0

    Exponents : Coefficients
--------------------------------
(0,) : 0.941421 +/- 0.129497
(1,) : 1.026215 +/- 0.045540
</pre></div>
</div>
<p>The above report indicates 24 outliers were found in which the residual was
greater than the <span class="math notranslate nohighlight">\(3\sigma\)</span> limit.  3 iterations were required,
terminated when no further outliers could be found (delta_rms = 0).</p>
</section>
</section>
<section id="special-case-1-d-and-2-d-functions">
<h1>Special Case 1-D and 2-D Functions<a class="headerlink" href="#special-case-1-d-and-2-d-functions" title="Link to this heading">¶</a></h1>
<p>For quick and easy derivation and evaluation of polynomial coefficients in
one or two dimensions, several functions are available that deviate from the
more general API presented above.</p>
<section id="dimensional-polynomial-derivation-and-evaluation">
<h2>1-Dimensional Polynomial Derivation and Evaluation<a class="headerlink" href="#dimensional-polynomial-derivation-and-evaluation" title="Link to this heading">¶</a></h2>
<p>For fitting a 1-dimensional polynomial to data where no special considerations
are necessary, there are already many functions available in standard
Python packages such as <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.polyfit.html#numpy.polyfit" title="(in NumPy v1.26)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.polyfit()</span></code></a>, so no attempt has been made to
recreate another version. <code class="xref py py-func docutils literal notranslate"><span class="pre">polyfit()</span></code> is perfectly capable of handling 1
dimensional cases with the added benefits of
<a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.polynomial.Polyfit.html#sofia_redux.toolkit.fitting.polynomial.Polyfit" title="sofia_redux.toolkit.fitting.polynomial.Polyfit"><code class="xref py py-class docutils literal notranslate"><span class="pre">sofia_redux.toolkit.fitting.polynomial.Polyfit</span></code></a> functionality.</p>
<p>However, for 1-dimensional evaluation, <a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.polynomial.poly1d.html#sofia_redux.toolkit.fitting.polynomial.poly1d" title="sofia_redux.toolkit.fitting.polynomial.poly1d"><code class="xref py py-func docutils literal notranslate"><span class="pre">poly1d()</span></code></a> is available to
evaluate coefficients, and optional variance if either the full covariance
matrix is provided, or the diagonal of the covariance matrix is given.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sofia_redux.toolkit.fitting.polynomial</span> <span class="kn">import</span> <span class="n">poly1d</span><span class="p">,</span> <span class="n">polyfitnd</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">41</span><span class="p">)</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="n">y</span> <span class="o">+=</span> <span class="n">error</span>

<span class="c1"># use polyfitnd to fit a polynomial and get the covariance on the fit</span>
<span class="c1"># coefficients</span>
<span class="n">coeffs</span><span class="p">,</span> <span class="n">cvar</span> <span class="o">=</span> <span class="n">polyfitnd</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">covar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">yfit</span><span class="p">,</span> <span class="n">yvar</span> <span class="o">=</span> <span class="n">poly1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span> <span class="n">covar</span><span class="o">=</span><span class="n">cvar</span><span class="p">)</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">yvar</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">yfit</span> <span class="o">-</span> <span class="n">error</span><span class="p">,</span> <span class="n">yfit</span> <span class="o">+</span> <span class="n">error</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
                 <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$1\sigma$ fit error&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">yfit</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;fit&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lime&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;7th order polynomial fit and fit error&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../../_downloads/8711519bb297f157679fa1909465654f/polynomial-4.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/2c9036bf6d1168304315c6be9c5151fe/polynomial-4.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/5ac8fad7171904e590afc4e4bccfd2cc/polynomial-4.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../../_downloads/dc7d5a256969affeac2891da21090b27/polynomial-4.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../../_images/polynomial-4.png" class="plot-directive" src="../../../_images/polynomial-4.png" />
</figure>
<p>Please note that <a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.polynomial.polynd.html#sofia_redux.toolkit.fitting.polynomial.polynd" title="sofia_redux.toolkit.fitting.polynomial.polynd"><code class="xref py py-func docutils literal notranslate"><span class="pre">polynd()</span></code></a> and <a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.polynomial.Polyfit.html#sofia_redux.toolkit.fitting.polynomial.Polyfit" title="sofia_redux.toolkit.fitting.polynomial.Polyfit"><code class="xref py py-class docutils literal notranslate"><span class="pre">Polyfit</span></code></a> are both capable of
producing the same results as <a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.polynomial.poly1d.html#sofia_redux.toolkit.fitting.polynomial.poly1d" title="sofia_redux.toolkit.fitting.polynomial.poly1d"><code class="xref py py-func docutils literal notranslate"><span class="pre">poly1d()</span></code></a>.  However, <a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.polynomial.poly1d.html#sofia_redux.toolkit.fitting.polynomial.poly1d" title="sofia_redux.toolkit.fitting.polynomial.poly1d"><code class="xref py py-func docutils literal notranslate"><span class="pre">poly1d()</span></code></a> is
a lighter version using <code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.poly1d()</span></code> to evaluate coefficients rather
than the engine used by <a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.polynomial.polynd.html#sofia_redux.toolkit.fitting.polynomial.polynd" title="sofia_redux.toolkit.fitting.polynomial.polynd"><code class="xref py py-func docutils literal notranslate"><span class="pre">polynd()</span></code></a>.</p>
</section>
<section id="id1">
<h2>2-Dimensional Polynomial Derivation and Evaluation<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h2>
<p>For 2-dimensional data, the <a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.polynomial.polyfit2d.html#sofia_redux.toolkit.fitting.polynomial.polyfit2d" title="sofia_redux.toolkit.fitting.polynomial.polyfit2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">polyfit2d()</span></code></a> and <a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.polynomial.poly2d.html#sofia_redux.toolkit.fitting.polynomial.poly2d" title="sofia_redux.toolkit.fitting.polynomial.poly2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">poly2d()</span></code></a> distinguish
between the full set of polynomial coefficients, and the more robust
redundancy controlled term coefficients in the same way as <a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.polynomial.polyfitnd.html#sofia_redux.toolkit.fitting.polynomial.polyfitnd" title="sofia_redux.toolkit.fitting.polynomial.polyfitnd"><code class="xref py py-func docutils literal notranslate"><span class="pre">polyfitnd()</span></code></a>.
This distinction is controlled by the <code class="xref py py-obj docutils literal notranslate"><span class="pre">full</span></code> keyword.  The following table
gives an example of the coefficients for a 2<sup>nd</sup> order polynomial with
<code class="xref py py-obj docutils literal notranslate"><span class="pre">full=True</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">full=False</span></code>.  Note that the order of coefficients in the
output table is different from <a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.polynomial.polyfitnd.html#sofia_redux.toolkit.fitting.polynomial.polyfitnd" title="sofia_redux.toolkit.fitting.polynomial.polyfitnd"><code class="xref py py-func docutils literal notranslate"><span class="pre">polyfitnd()</span></code></a>, with x coefficients running
along columns and y coefficients by rows, where the exponent of the coefficient
term is given by it’s index.  The order of polynomial must be given separately
for the x and y directions via the <code class="xref py py-obj docutils literal notranslate"><span class="pre">kx</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">ky</span></code> keyword arguments (default=2).</p>
<table class="docutils align-default" id="id2">
<caption><span class="caption-number">Table 34 </span><span class="caption-text"><strong>Polynomial Coefficients</strong> (<code class="docutils literal notranslate"><span class="pre">full=True</span></code>)</span><a class="headerlink" href="#id2" title="Link to this table">¶</a></caption>
<tbody>
<tr class="row-odd"><td></td>
<td><p><strong>x</strong><sup>0</sup></p></td>
<td><p><strong>x</strong><sup>1</sup></p></td>
<td><p><strong>x</strong><sup>2</sup></p></td>
</tr>
<tr class="row-even"><td><p><strong>y</strong><sup>0</sup></p></td>
<td><p>c<sub>0,0</sub></p></td>
<td><p>c<sub>1,0</sub></p></td>
<td><p>c<sub>2,0</sub></p></td>
</tr>
<tr class="row-odd"><td><p><strong>y</strong><sup>1</sup></p></td>
<td><p>c<sub>0,1</sub></p></td>
<td><p>c<sub>1,1</sub></p></td>
<td><p>c<sub>2,1</sub></p></td>
</tr>
<tr class="row-even"><td><p><strong>y</strong><sup>2</sup></p></td>
<td><p>c<sub>0,2</sub></p></td>
<td><p>c<sub>1,2</sub></p></td>
<td><p>c<sub>2,2</sub></p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id3">
<caption><span class="caption-number">Table 35 </span><span class="caption-text"><strong>Polynomial Coefficients</strong> (<code class="docutils literal notranslate"><span class="pre">full=False</span></code>)</span><a class="headerlink" href="#id3" title="Link to this table">¶</a></caption>
<tbody>
<tr class="row-odd"><td></td>
<td><p><strong>x</strong><sup>0</sup></p></td>
<td><p><strong>x</strong><sup>1</sup></p></td>
<td><p><strong>x</strong><sup>2</sup></p></td>
</tr>
<tr class="row-even"><td><p><strong>y</strong><sup>0</sup></p></td>
<td><p>c<sub>0,0</sub></p></td>
<td><p>c<sub>1,0</sub></p></td>
<td><p>c<sub>2,0</sub></p></td>
</tr>
<tr class="row-odd"><td><p><strong>y</strong><sup>1</sup></p></td>
<td><p>c<sub>0,1</sub></p></td>
<td><p>c<sub>1,1</sub></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>y</strong><sup>2</sup></p></td>
<td><p>c<sub>0,2</sub></p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="dimensional-examples">
<h2>2-Dimensional Examples<a class="headerlink" href="#dimensional-examples" title="Link to this heading">¶</a></h2>
<ul>
<li><p><a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.polynomial.polyfit2d.html#sofia_redux.toolkit.fitting.polynomial.polyfit2d" title="sofia_redux.toolkit.fitting.polynomial.polyfit2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">polyfit2d()</span></code></a> derives polynomial coefficients describing a surface:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sofia_redux.toolkit.fitting.polynomial</span> <span class="kn">import</span> <span class="n">polyfit2d</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.4</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.3</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">polyfit2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">kx</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ky</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">3</span><span class="p">)))</span>
<span class="go">[[0.5 0.4 0.1]</span>
<span class="go"> [0.3 0.2 0. ]</span>
<span class="go"> [0.  0.  0. ]]</span>
</pre></div>
</div>
</li>
<li><p><a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.polynomial.poly2d.html#sofia_redux.toolkit.fitting.polynomial.poly2d" title="sofia_redux.toolkit.fitting.polynomial.poly2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">poly2d()</span></code></a> evaluates 2-dimensional polynomial coefficients:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sofia_redux.toolkit.fitting.polynomial</span> <span class="kn">import</span> <span class="n">poly2d</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">poly2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="p">),</span> <span class="n">z</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</li>
<li><p><a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.polynomial.polyinterp2d.html#sofia_redux.toolkit.fitting.polynomial.polyinterp2d" title="sofia_redux.toolkit.fitting.polynomial.polyinterp2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">polyinterp2d()</span></code></a> derivates and evaluates 2-D polynomial coefficients:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sofia_redux.toolkit.fitting.polynomial</span> <span class="kn">import</span> <span class="n">polyinterp2d</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">polyinterp2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ky</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">kx</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="n">z</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</li>
</ul>
<p>These 2-dimensional functions are designed as lighter versions of
<a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.polynomial.polyfitnd.html#sofia_redux.toolkit.fitting.polynomial.polyfitnd" title="sofia_redux.toolkit.fitting.polynomial.polyfitnd"><code class="xref py py-func docutils literal notranslate"><span class="pre">polyfitnd()</span></code></a> and <a class="reference internal" href="../../../api/sofia_redux.toolkit.fitting.polynomial.polynd.html#sofia_redux.toolkit.fitting.polynomial.polynd" title="sofia_redux.toolkit.fitting.polynomial.polynd"><code class="xref py py-func docutils literal notranslate"><span class="pre">polynd()</span></code></a>, so should fit and evaluate data slightly
faster.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Polynomial Coefficients</a></li>
<li><a class="reference internal" href="#fit-statistics">Fit Statistics</a><ul>
<li><a class="reference internal" href="#covariance">Covariance</a></li>
<li><a class="reference internal" href="#disabling-statistics">Disabling Statistics</a></li>
<li><a class="reference internal" href="#robust-outlier-rejection">Robust Outlier Rejection</a></li>
</ul>
</li>
<li><a class="reference internal" href="#special-case-1-d-and-2-d-functions">Special Case 1-D and 2-D Functions</a><ul>
<li><a class="reference internal" href="#dimensional-polynomial-derivation-and-evaluation">1-Dimensional Polynomial Derivation and Evaluation</a></li>
<li><a class="reference internal" href="#id1">2-Dimensional Polynomial Derivation and Evaluation</a></li>
<li><a class="reference internal" href="#dimensional-examples">2-Dimensional Examples</a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../../../_sources/sofia_redux/toolkit/fitting/polynomial.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2024, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.2.6. &nbsp;
    Last built 05 Feb 2024. <br/>
  </p>
</footer>
  </body>
</html>