<!DOCTYPE html>

<html lang="en" data-content_root="../../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>sofia_redux.scan.coordinate_systems.galactic_coordinates &#8212; sofia_redux v1.3.4.dev38+g92ea2f4</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css" />
    
    <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../../../_static/documentation_options.js?v=6aa39468"></script>
    <script src="../../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script type="text/javascript" src="../../../../_static/sidebar.js"></script>
    <script type="text/javascript" src="../../../../_static/copybutton.js"></script>
    <link rel="icon" href="../../../../_static/redux.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../../../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://irsa.ipac.caltech.edu/Missions/sofia.html"></a></li>
    <li><a title="General Index" href="../../../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li>
	<a href="../../../../index.html">sofia_redux v1.3.4.dev38+g92ea2f4</a>
	 &#187;
      </li>
      <li><a href="../../../index.html" accesskey="U">Module code</a> &#187;</li>
      
       
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for sofia_redux.scan.coordinate_systems.galactic_coordinates</h1><div class="highlight"><pre>
<span></span># Licensed under a 3-clause BSD style license - see LICENSE.rst

from astropy import units

from sofia_redux.scan.coordinate_systems.equatorial_coordinates import \
    EquatorialCoordinates
from sofia_redux.scan.coordinate_systems.epoch.epoch import B1950, J2000
from sofia_redux.scan.coordinate_systems.coordinate_system import \
    CoordinateSystem
from sofia_redux.scan.coordinate_systems.celestial_coordinates import \
    CelestialCoordinates

__all__ = [&#39;GalacticCoordinates&#39;]


<div class="viewcode-block" id="GalacticCoordinates">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.coordinate_systems.galactic_coordinates.GalacticCoordinates.html#sofia_redux.scan.coordinate_systems.galactic_coordinates.GalacticCoordinates">[docs]</a>
class GalacticCoordinates(CelestialCoordinates):

    def __init__(self, coordinates=None, unit=&#39;degree&#39;, copy=True):
        &quot;&quot;&quot;
        Initialize galactic coordinates.

        Galactic coordinates use spherical coordinates in a celestial
        coordinate system with the Sun at the center with the primary
        direction aligned to the approximate center of the Milky Way with
        the fundamental plane parallel to an approximation of the galactic
        plane slightly offset to the north.  Coordinates are positive toward
        the north and east in the fundamental plane.

        The galactic longitude is the angular distance of an object eastward
        along the galactic equator from the galactic center.  The galactic
        latitude is the angle of an object northward of the galactic equator as
        viewed from Earth.

        Parameters
        ----------
        coordinates : list or tuple or array-like or units.Quantity, optional
            The coordinates used to populate the object during initialization.
            The first (0) value or index should represent longitudinal
            coordinates, and the second should represent latitude.
        unit : units.Unit or str, optional
            The angular unit for the spherical coordinates.  The default is
            &#39;degree&#39;.
        copy : bool, optional
            Whether to explicitly perform a copy operation on the input
            coordinates when storing them into these coordinates.  Note that it
            is extremely unlikely for the original coordinates to be passed in
            as a reference due to the significant checks performed on them.
        &quot;&quot;&quot;
        super().__init__(coordinates=coordinates, unit=unit, copy=copy)

<div class="viewcode-block" id="GalacticCoordinates.setup_coordinate_system">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.coordinate_systems.galactic_coordinates.GalacticCoordinates.html#sofia_redux.scan.coordinate_systems.galactic_coordinates.GalacticCoordinates.setup_coordinate_system">[docs]</a>
    def setup_coordinate_system(self):
        &quot;&quot;&quot;
        Setup the system for the coordinates.

        Returns
        -------
        None
        &quot;&quot;&quot;
        self.default_coordinate_system = CoordinateSystem(
            name=&#39;Galactic Coordinates&#39;)
        self.default_local_coordinate_system = CoordinateSystem(
            name=&#39;Galactic Offsets&#39;)
        lon_axis = self.create_axis(&#39;Galactic Longitude&#39;, &#39;GLON&#39;)
        lon_axis.reverse = True
        lat_axis = self.create_axis(&#39;Galactic Latitude&#39;, &#39;GLAT&#39;)
        lon_offset_axis = self.create_offset_axis(
            &#39;Galactic Longitude Offset&#39;, &#39;dGLON&#39;)
        lon_offset_axis.reverse = True
        lat_offset_axis = self.create_offset_axis(
            &#39;Galactic Latitude Offset&#39;, &#39;dGLAT&#39;)
        self.default_coordinate_system.add_axis(lon_axis)
        self.default_coordinate_system.add_axis(lat_axis)
        self.default_local_coordinate_system.add_axis(lon_offset_axis)
        self.default_local_coordinate_system.add_axis(lat_offset_axis)</div>


    @property
    def fits_longitude_stem(self):
        &quot;&quot;&quot;
        Return the string prefix for longitude (RA).

        Returns
        -------
        str
        &quot;&quot;&quot;
        return &#39;GLON&#39;

    @property
    def fits_latitude_stem(self):
        &quot;&quot;&quot;
        Return the string prefix for latitude (DEC).

        Returns
        -------
        str
        &quot;&quot;&quot;
        return &#39;GLAT&#39;

    @property
    def two_letter_code(self):
        &quot;&quot;&quot;
        Return the two-letter code for the coordinate system.

        Returns
        -------
        str
        &quot;&quot;&quot;
        return &#39;GA&#39;

    @property
    def equatorial_pole(self):
        &quot;&quot;&quot;
        Return an equatorial pole.

        Returns
        -------
        pole : EquatorialCoordinates
        &quot;&quot;&quot;
        return self.get_equatorial_pole()

<div class="viewcode-block" id="GalacticCoordinates.get_equatorial_pole">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.coordinate_systems.galactic_coordinates.GalacticCoordinates.html#sofia_redux.scan.coordinate_systems.galactic_coordinates.GalacticCoordinates.get_equatorial_pole">[docs]</a>
    @classmethod
    def get_equatorial_pole(cls):
        &quot;&quot;&quot;
        Return the equatorial pole.

        Returns
        -------
        pole : EquatorialCoordinates
        &quot;&quot;&quot;
        return EQUATORIAL_POLE</div>


<div class="viewcode-block" id="GalacticCoordinates.get_zero_longitude">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.coordinate_systems.galactic_coordinates.GalacticCoordinates.html#sofia_redux.scan.coordinate_systems.galactic_coordinates.GalacticCoordinates.get_zero_longitude">[docs]</a>
    @classmethod
    def get_zero_longitude(cls):
        &quot;&quot;&quot;
        Return the zero longitude value.

        Returns
        -------
        astropy.units.Quantity
        &quot;&quot;&quot;
        return PHI0</div>


<div class="viewcode-block" id="GalacticCoordinates.edit_header">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.coordinate_systems.galactic_coordinates.GalacticCoordinates.html#sofia_redux.scan.coordinate_systems.galactic_coordinates.GalacticCoordinates.edit_header">[docs]</a>
    def edit_header(self, header, key_stem, alt=&#39;&#39;):
        &quot;&quot;&quot;
        Edit the header with galactic coordinate information.

        Parameters
        ----------
        header : astropy.io.fits.header.Header
            The header to modify.
        key_stem : str
            The name of the header key to update.
        alt : str, optional
            The alternative coordinate system.

        Returns
        -------
        None
        &quot;&quot;&quot;
        if not self.singular:
            return  # Can&#39;t do this for multiple coordinates
        super().edit_header(header, key_stem, alt=alt)
        header[f&#39;WCSNAME{alt}&#39;] = (self.coordinate_system.name,
                                   &#39;coordinate system description.&#39;)</div>
</div>



# The following is used to determine the equatorial pole and zero longitude
_pole_ra = ((12 * units.Unit(&#39;hourangle&#39;))
            + (49 * units.Unit(&#39;hourangle&#39;) / 60))
_pole_dec = 27.4 * units.Unit(&#39;degree&#39;)

EQUATORIAL_POLE = EquatorialCoordinates([_pole_ra, _pole_dec], epoch=B1950)
PHI0 = 123 * units.Unit(&#39;degree&#39;)
zero = GalacticCoordinates([PHI0, 0.0 * units.Unit(&#39;degree&#39;)])
equatorial_zero = zero.to_equatorial()
equatorial_zero.precess(J2000)
zero.from_equatorial(equatorial_zero)
PHI0 = -zero.x
EQUATORIAL_POLE.precess(J2000)
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right"> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2024, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.2.6. &nbsp;
    Last built 05 Feb 2024. <br/>
  </p>
</footer>
  </body>
</html>