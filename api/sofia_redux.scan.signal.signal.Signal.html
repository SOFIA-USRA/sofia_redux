<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Signal &#8212; sofia_redux v1.3.4.dev38+g92ea2f4</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=6aa39468"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="icon" href="../_static/redux.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="SourceModel" href="sofia_redux.scan.source_models.source_model.SourceModel.html" />
    <link rel="prev" title="Scan" href="sofia_redux.scan.scan.scan.Scan.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://irsa.ipac.caltech.edu/Missions/sofia.html"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="sofia_redux.scan.source_models.source_model.SourceModel.html" title="SourceModel">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="sofia_redux.scan.scan.scan.Scan.html" title="Scan">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">sofia_redux v1.3.4.dev38+g92ea2f4</a>
	 &#187;
      </li>
      <li><a href="../sofia_redux/index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../manuals/hawc/developers/developers.html" accesskey="U">HAWC+ DRP Developer’s Manual</a> &#187;</li>
      
      <li>Signal</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="signal">
<h1>Signal<a class="headerlink" href="#signal" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sofia_redux.scan.signal.signal.</span></span><span class="sig-name descname"><span class="pre">Signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">integration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_floating</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/signal/signal.html#Signal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<p>Initialize a Signal object.</p>
<p>The Signal object is used to extract a gain signal from an integration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>integration</strong><span class="classifier">sofia_redux.scan.integration.integration.Integration</span></dt><dd><p>The integration to which the signal belongs.</p>
</dd>
<dt><strong>mode</strong><span class="classifier">sofia_redux.scan.channels.mode.mode.Mode, optional</span></dt><dd><p>The channel mode for which to create the signal.</p>
</dd>
<dt><strong>values</strong><span class="classifier">numpy.ndarray (float), optional</span></dt><dd><p>Optional signal values to apply.</p>
</dd>
<dt><strong>is_floating</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, indicates that the signal values have some arbitrary DC
offset.  This indicates that it would be advisable to “level”
(subtract this offset) from the signal values before any type of
application.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Attributes Summary</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.configuration" title="sofia_redux.scan.signal.signal.Signal.configuration"><code class="xref py py-obj docutils literal notranslate"><span class="pre">configuration</span></code></a></p></td>
<td><p>Return the configuration applicable to the signal.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.info" title="sofia_redux.scan.signal.signal.Signal.info"><code class="xref py py-obj docutils literal notranslate"><span class="pre">info</span></code></a></p></td>
<td><p>Return the info object specific to the signal integration.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.referenced_attributes" title="sofia_redux.scan.signal.signal.Signal.referenced_attributes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">referenced_attributes</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.size" title="sofia_redux.scan.signal.signal.Signal.size"><code class="xref py py-obj docutils literal notranslate"><span class="pre">size</span></code></a></p></td>
<td><p>Return the length of the signal.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods Summary</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.add" title="sofia_redux.scan.signal.signal.Signal.add"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add</span></code></a>(value)</p></td>
<td><p>Add a DC offset to all signal and drift values.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.add_drifts" title="sofia_redux.scan.signal.signal.Signal.add_drifts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_drifts</span></code></a>()</p></td>
<td><p>Add the drifts onto the signal value.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.copy" title="sofia_redux.scan.signal.signal.Signal.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a>()</p></td>
<td><p>Return a copy of the signal.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.differentiate" title="sofia_redux.scan.signal.signal.Signal.differentiate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">differentiate</span></code></a>()</p></td>
<td><p>Differentiate the signal values in-place.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.get_covariance" title="sofia_redux.scan.signal.signal.Signal.get_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_covariance</span></code></a>()</p></td>
<td><p>Return the signal covariance over all samples (frames, channels).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.get_differential" title="sofia_redux.scan.signal.signal.Signal.get_differential"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_differential</span></code></a>()</p></td>
<td><p>Return a differentiated copy of the signal.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.get_gain_increment" title="sofia_redux.scan.signal.signal.Signal.get_gain_increment"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_gain_increment</span></code></a>([robust])</p></td>
<td><p>Return the gain increment and weight increment for each mode channel.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.get_integral" title="sofia_redux.scan.signal.signal.Signal.get_integral"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_integral</span></code></a>()</p></td>
<td><p>Return an integrated copy of the signal.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.get_mean" title="sofia_redux.scan.signal.signal.Signal.get_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_mean</span></code></a>()</p></td>
<td><p>Return the mean signal value and weight.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.get_median" title="sofia_redux.scan.signal.signal.Signal.get_median"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_median</span></code></a>()</p></td>
<td><p>Return the median signal value and weight.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.get_ml_gain_increment" title="sofia_redux.scan.signal.signal.Signal.get_ml_gain_increment"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_ml_gain_increment</span></code></a>()</p></td>
<td><p>Get the maximum-likelihood (ML) gain increment for the signal.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.get_resolution" title="sofia_redux.scan.signal.signal.Signal.get_resolution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolution</span></code></a>()</p></td>
<td><p>Return the signal resolution.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.get_rms" title="sofia_redux.scan.signal.signal.Signal.get_rms"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_rms</span></code></a>()</p></td>
<td><p>Get the signal RMS.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.get_robust_gain_increment" title="sofia_redux.scan.signal.signal.Signal.get_robust_gain_increment"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_robust_gain_increment</span></code></a>()</p></td>
<td><p>Get the robust (median derived) gain increment for the signal.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.get_variance" title="sofia_redux.scan.signal.signal.Signal.get_variance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_variance</span></code></a>()</p></td>
<td><p>Get the signal variance.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.integrate" title="sofia_redux.scan.signal.signal.Signal.integrate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">integrate</span></code></a>()</p></td>
<td><p>Integrate the signal values in-place using the trapezoidal rule.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.level" title="sofia_redux.scan.signal.signal.Signal.level"><code class="xref py py-obj docutils literal notranslate"><span class="pre">level</span></code></a>([start_frame, end_frame, robust])</p></td>
<td><p>Remove the mean value from the signal values.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.prepare_frame_temp_fields" title="sofia_redux.scan.signal.signal.Signal.prepare_frame_temp_fields"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_frame_temp_fields</span></code></a>()</p></td>
<td><p>Prepare precalculated values for subsequent processing.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.remove_drifts" title="sofia_redux.scan.signal.signal.Signal.remove_drifts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove_drifts</span></code></a>([n_frames, ...])</p></td>
<td><p>Remove drifts from the signal.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.resync_gains" title="sofia_redux.scan.signal.signal.Signal.resync_gains"><code class="xref py py-obj docutils literal notranslate"><span class="pre">resync_gains</span></code></a>()</p></td>
<td><p>Resynchronize gains if any changes have occurred.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.scale" title="sofia_redux.scan.signal.signal.Signal.scale"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scale</span></code></a>(factor)</p></td>
<td><p>Scale the signal, drifts, and sync_gains by a given factor.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.set_sync_gains" title="sofia_redux.scan.signal.signal.Signal.set_sync_gains"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_sync_gains</span></code></a>(gains)</p></td>
<td><p>Copy the gains to the sync_gains attribute.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.smooth" title="sofia_redux.scan.signal.signal.Signal.smooth"><code class="xref py py-obj docutils literal notranslate"><span class="pre">smooth</span></code></a>(fwhm)</p></td>
<td><p>Smooth the signal to a given FWHM (given in frames).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.smooth_with_kernel" title="sofia_redux.scan.signal.signal.Signal.smooth_with_kernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">smooth_with_kernel</span></code></a>(kernel)</p></td>
<td><p>Smooth the signal with a given kernel.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.subtract" title="sofia_redux.scan.signal.signal.Signal.subtract"><code class="xref py py-obj docutils literal notranslate"><span class="pre">subtract</span></code></a>(value)</p></td>
<td><p>Subtract a DC offset from all signal and drift values.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.synchronize_gains" title="sofia_redux.scan.signal.signal.Signal.synchronize_gains"><code class="xref py py-obj docutils literal notranslate"><span class="pre">synchronize_gains</span></code></a>([sum_wc2, is_temp_ready])</p></td>
<td><p>Synchronize gains in the signal.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.value_at" title="sofia_redux.scan.signal.signal.Signal.value_at"><code class="xref py py-obj docutils literal notranslate"><span class="pre">value_at</span></code></a>(frame)</p></td>
<td><p>Return the signal value for a given integration frame index.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.weight_at" title="sofia_redux.scan.signal.signal.Signal.weight_at"><code class="xref py py-obj docutils literal notranslate"><span class="pre">weight_at</span></code></a>(frame)</p></td>
<td><p>Return the signal weight for a given integration frame index.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.write_signal_values" title="sofia_redux.scan.signal.signal.Signal.write_signal_values"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_signal_values</span></code></a>(out_file)</p></td>
<td><p>Write the signal information to a text file.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes Documentation</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal.configuration">
<span class="sig-name descname"><span class="pre">configuration</span></span><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal.configuration" title="Link to this definition">¶</a></dt>
<dd><p>Return the configuration applicable to the signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Configuration</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal.info">
<span class="sig-name descname"><span class="pre">info</span></span><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal.info" title="Link to this definition">¶</a></dt>
<dd><p>Return the info object specific to the signal integration.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Info</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal.referenced_attributes">
<span class="sig-name descname"><span class="pre">referenced_attributes</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['mode',</span> <span class="pre">'integration']</span></em><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal.referenced_attributes" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal.size">
<span class="sig-name descname"><span class="pre">size</span></span><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal.size" title="Link to this definition">¶</a></dt>
<dd><p>Return the length of the signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>n_signal</strong><span class="classifier">int</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<p class="rubric">Methods Documentation</p>
<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/signal/signal.html#Signal.add"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal.add" title="Link to this definition">¶</a></dt>
<dd><p>Add a DC offset to all signal and drift values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>value</strong><span class="classifier">float</span></dt><dd><p>The value to add.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal.add_drifts">
<span class="sig-name descname"><span class="pre">add_drifts</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/signal/signal.html#Signal.add_drifts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal.add_drifts" title="Link to this definition">¶</a></dt>
<dd><p>Add the drifts onto the signal value.</p>
<p>All drifts are erased following this operation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/signal/signal.html#Signal.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal.copy" title="Link to this definition">¶</a></dt>
<dd><p>Return a copy of the signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Signal</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal.differentiate">
<span class="sig-name descname"><span class="pre">differentiate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/signal/signal.html#Signal.differentiate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal.differentiate" title="Link to this definition">¶</a></dt>
<dd><p>Differentiate the signal values in-place.</p>
<p>Note that the spacing between sample values is assumed to be in
seconds when calculating the gradient.  The <code class="xref py py-obj docutils literal notranslate"><span class="pre">is_floating</span></code> attribute
is set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a> following this operation indicating that the
differentiated signal has no DC offset.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal.get_covariance">
<span class="sig-name descname"><span class="pre">get_covariance</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/signal/signal.html#Signal.get_covariance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal.get_covariance" title="Link to this definition">¶</a></dt>
<dd><p>Return the signal covariance over all samples (frames, channels).</p>
<p>The covariance only includes unflagged channels and unflagged samples.
The signal covariance is given as:</p>
<p>C = sum_{channels}(xs * xs) / sum_{channels}(ss * xx)</p>
<p>where xs = sum_{frames}(w * x * s), ss = sum_{frames}(w * s * s), and
xx = sum_{frames}(w * x * x).  Here w is the channel weight, s is the
signal value for each frame, and x are the frame data values.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>covariance</strong><span class="classifier">float</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal.get_differential">
<span class="sig-name descname"><span class="pre">get_differential</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/signal/signal.html#Signal.get_differential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal.get_differential" title="Link to this definition">¶</a></dt>
<dd><p>Return a differentiated copy of the signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Signal</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal.get_gain_increment">
<span class="sig-name descname"><span class="pre">get_gain_increment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">robust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/signal/signal.html#Signal.get_gain_increment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal.get_gain_increment" title="Link to this definition">¶</a></dt>
<dd><p>Return the gain increment and weight increment for each mode channel.</p>
<p>For the robust method, the gain increment value is determined as:</p>
<p>increment = median(frame_data / signal_value)</p>
<p>while the maximum-likelihood method gives the gain increment as:</p>
<p>increment = sum(frame_data * frame_weight * signal_value) / increment_w</p>
<p>Both methods are weighted by frame_weight * signal_value^2 and result
in an increment weight of:</p>
<p>increment_w = sum(frame_weight * signal_value^2).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>robust</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, use the robust method (median) to determine gain
increments.  Otherwise, use the maximum-likelihood method (mean).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>increment, increment_w</strong><span class="classifier">numpy.ndarray, numpy.ndarray</span></dt><dd><p>The gain increment and increment weight, both of shape
(n_channels,).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal.get_integral">
<span class="sig-name descname"><span class="pre">get_integral</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/signal/signal.html#Signal.get_integral"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal.get_integral" title="Link to this definition">¶</a></dt>
<dd><p>Return an integrated copy of the signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Signal</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal.get_mean">
<span class="sig-name descname"><span class="pre">get_mean</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/signal/signal.html#Signal.get_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal.get_mean" title="Link to this definition">¶</a></dt>
<dd><p>Return the mean signal value and weight.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>mean_value, mean_weight</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal.get_median">
<span class="sig-name descname"><span class="pre">get_median</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/signal/signal.html#Signal.get_median"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal.get_median" title="Link to this definition">¶</a></dt>
<dd><p>Return the median signal value and weight.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>median_value, median_weight</strong><span class="classifier">float, float</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal.get_ml_gain_increment">
<span class="sig-name descname"><span class="pre">get_ml_gain_increment</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/signal/signal.html#Signal.get_ml_gain_increment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal.get_ml_gain_increment" title="Link to this definition">¶</a></dt>
<dd><p>Get the maximum-likelihood (ML) gain increment for the signal.</p>
<p>The maximum likelihood gain increment for a given channel (c) is:</p>
<p>dG = sum(frame_data_{c} * frame_weight * signal_value) / dW
dW = sum(frame_weight * signal_value^2)</p>
<p>No invalid frames of modeling frames will be included in the sum.
Additionally, no flagged samples will be included.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>gain_increments, increment_weights</strong><span class="classifier">numpy.ndarray, numpy.ndarray</span></dt><dd><p>The gain increments and increment weights for each channel in the
signal mode channel group.  Both are arrays of shape (n_channels,).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal.get_resolution">
<span class="sig-name descname"><span class="pre">get_resolution</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/signal/signal.html#Signal.get_resolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal.get_resolution" title="Link to this definition">¶</a></dt>
<dd><p>Return the signal resolution.</p>
<p>The signal resolution is basically the number of frames for which a
single signal value may be applicable.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>resolution</strong><span class="classifier">int</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal.get_rms">
<span class="sig-name descname"><span class="pre">get_rms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/signal/signal.html#Signal.get_rms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal.get_rms" title="Link to this definition">¶</a></dt>
<dd><p>Get the signal RMS.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>rms</strong><span class="classifier">float</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal.get_robust_gain_increment">
<span class="sig-name descname"><span class="pre">get_robust_gain_increment</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/signal/signal.html#Signal.get_robust_gain_increment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal.get_robust_gain_increment" title="Link to this definition">¶</a></dt>
<dd><p>Get the robust (median derived) gain increment for the signal.</p>
<p>The gain increment for a given channel is:</p>
<p>increment = median(frame_data / signal_value)
increment_weight = sum(frame_weight * signal_value^2)</p>
<p>No invalid frames of modeling frames will be included in the sum.
Additionally, no flagged samples will be included.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>gain_increments, increment_weights</strong><span class="classifier">numpy.ndarray, numpy.ndarray</span></dt><dd><p>The gain increments and increment weights for each channel in the
signal mode channel group.  Both are arrays of shape (n_channels,).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal.get_variance">
<span class="sig-name descname"><span class="pre">get_variance</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/signal/signal.html#Signal.get_variance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal.get_variance" title="Link to this definition">¶</a></dt>
<dd><p>Get the signal variance.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>variance</strong><span class="classifier">float</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal.integrate">
<span class="sig-name descname"><span class="pre">integrate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/signal/signal.html#Signal.integrate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal.integrate" title="Link to this definition">¶</a></dt>
<dd><p>Integrate the signal values in-place using the trapezoidal rule.</p>
<p>Note that the spacing between sample values is assumed to be in
seconds.  The <code class="xref py py-obj docutils literal notranslate"><span class="pre">is_floating</span></code> attribute is set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> following this
operation indicating that the integrated signal has an arbitrary
DC offset.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal.level">
<span class="sig-name descname"><span class="pre">level</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">robust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/signal/signal.html#Signal.level"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal.level" title="Link to this definition">¶</a></dt>
<dd><p>Remove the mean value from the signal values.</p>
<p>The mean signal between a given start and end frame is calculated and
subtracted from the signal.  This value is returned to the user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>start_frame</strong><span class="classifier">int, optional</span></dt><dd><p>The starting frame from which to level.  The default is the first
frame (0).</p>
</dd>
<dt><strong>end_frame</strong><span class="classifier">int, optional</span></dt><dd><p>The last frame from to level (non-inclusive).  The default is the
total number of frames.</p>
</dd>
<dt><strong>robust</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, subtract the median value rather than the mean.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>average</strong><span class="classifier">float</span></dt><dd><p>The average signal value that was removed.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal.prepare_frame_temp_fields">
<span class="sig-name descname"><span class="pre">prepare_frame_temp_fields</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/signal/signal.html#Signal.prepare_frame_temp_fields"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal.prepare_frame_temp_fields" title="Link to this definition">¶</a></dt>
<dd><p>Prepare precalculated values for subsequent processing.</p>
<p>The signal values are stored in the temp_* fields of the frame data.
These contain:</p>
<p>temp_c = signal_value
temp_wc = relative_weight * signal_value
temp_wc2 = relative_weight * signal_value^2</p>
<p>Invalid frames have zero values.  Frames flagged as “MODELING” are
set to zero weight.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal.remove_drifts">
<span class="sig-name descname"><span class="pre">remove_drifts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_frames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_reconstructable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">robust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/signal/signal.html#Signal.remove_drifts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal.remove_drifts" title="Link to this definition">¶</a></dt>
<dd><p>Remove drifts from the signal.</p>
<p>A drift is defined as the average signal for a given block of frames
(the length of which is given by <code class="xref py py-obj docutils literal notranslate"><span class="pre">n_frames</span></code>.  For each drift, the
average signal value is calculated and subtracted from all signal
values within that drift block.  If the drifts are marked as
“reconstructable”, they average signal values are stored in the
<code class="xref py py-obj docutils literal notranslate"><span class="pre">drifts</span></code> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>n_frames</strong><span class="classifier">int, optional</span></dt><dd><p>The number of frames in each drift.  The default is the number
of frames in the signal’s integration filter time scale.</p>
</dd>
<dt><strong>is_reconstructable</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, save the drift values for later use.</p>
</dd>
<dt><strong>robust</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, the robust (median) method will be used to determined
the average signal level for each drift.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal.resync_gains">
<span class="sig-name descname"><span class="pre">resync_gains</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/signal/signal.html#Signal.resync_gains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal.resync_gains" title="Link to this definition">¶</a></dt>
<dd><p>Resynchronize gains if any changes have occurred.</p>
<dl class="simple">
<dt>The delta gains are calculated for each channel as:</dt><dd><p>current_gain - last_gain</p>
</dd>
</dl>
<p>For any non-zero delta_gain, frame data (x) for that channel will be
updated by decrementing that value by:</p>
<blockquote>
<div><p>x[frame, channel] -= signal[frame] * delta_gain[channel]</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal.scale">
<span class="sig-name descname"><span class="pre">scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/signal/signal.html#Signal.scale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal.scale" title="Link to this definition">¶</a></dt>
<dd><p>Scale the signal, drifts, and sync_gains by a given factor.</p>
<p>Signal values and drifts are multiplied by the given factor.
Sync gains (previous gain values) are divided by the given factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>factor</strong><span class="classifier">float</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal.set_sync_gains">
<span class="sig-name descname"><span class="pre">set_sync_gains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gains</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/signal/signal.html#Signal.set_sync_gains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal.set_sync_gains" title="Link to this definition">¶</a></dt>
<dd><p>Copy the gains to the sync_gains attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>gains</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>An array of gains to copy to sync_gains.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal.smooth">
<span class="sig-name descname"><span class="pre">smooth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fwhm</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/signal/signal.html#Signal.smooth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal.smooth" title="Link to this definition">¶</a></dt>
<dd><p>Smooth the signal to a given FWHM (given in frames).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>fwhm</strong><span class="classifier">float or int</span></dt><dd><p>The FWHM in given in units of frames.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal.smooth_with_kernel">
<span class="sig-name descname"><span class="pre">smooth_with_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/signal/signal.html#Signal.smooth_with_kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal.smooth_with_kernel" title="Link to this definition">¶</a></dt>
<dd><p>Smooth the signal with a given kernel.</p>
<p>Kernel spacing should be in units of self.resolution
(number of frames).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>kernel</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The kernel to smooth the signal values by.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal.subtract">
<span class="sig-name descname"><span class="pre">subtract</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/signal/signal.html#Signal.subtract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal.subtract" title="Link to this definition">¶</a></dt>
<dd><p>Subtract a DC offset from all signal and drift values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>value</strong><span class="classifier">float</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal.synchronize_gains">
<span class="sig-name descname"><span class="pre">synchronize_gains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sum_wc2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_temp_ready</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/signal/signal.html#Signal.synchronize_gains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal.synchronize_gains" title="Link to this definition">¶</a></dt>
<dd><p>Synchronize gains in the signal.</p>
<p>If the gains have been updated, applies any changes to the data and
updates dependencies.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>sum_wc2</strong><span class="classifier">numpy.ndarray (float), optional</span></dt><dd><p>An array of gain weights of shape (n_channels,).</p>
</dd>
<dt><strong>is_temp_ready</strong><span class="classifier">bool, optional</span></dt><dd><p>Indicates whether the frame temporary values have already been
calculated.  These should contain:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>temp_c = signal_value
temp_wc = relative_weight * signal_value
temp_wc2 = relative_weight * signal_value^2
</pre></div>
</div>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal.value_at">
<span class="sig-name descname"><span class="pre">value_at</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/signal/signal.html#Signal.value_at"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal.value_at" title="Link to this definition">¶</a></dt>
<dd><p>Return the signal value for a given integration frame index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>frame</strong><span class="classifier">int or numpy.ndarray (int)</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>signal_value</strong><span class="classifier">float</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal.weight_at">
<span class="sig-name descname"><span class="pre">weight_at</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/signal/signal.html#Signal.weight_at"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal.weight_at" title="Link to this definition">¶</a></dt>
<dd><p>Return the signal weight for a given integration frame index.</p>
<p>Note that the standard signal object does not have an
associated weight.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>frame</strong><span class="classifier">int or numpy.ndarray (int)</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>signal_weight</strong><span class="classifier">float</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.signal.signal.Signal.write_signal_values">
<span class="sig-name descname"><span class="pre">write_signal_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/signal/signal.html#Signal.write_signal_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.signal.signal.Signal.write_signal_values" title="Link to this definition">¶</a></dt>
<dd><p>Write the signal information to a text file.</p>
<p>Note that in crush this is the “print” method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>out_file</strong><span class="classifier">str</span></dt><dd><p>The name of the file to write to.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Signal</a><ul>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal"><code class="docutils literal notranslate"><span class="pre">Signal</span></code></a><ul>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.configuration"><code class="docutils literal notranslate"><span class="pre">Signal.configuration</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.info"><code class="docutils literal notranslate"><span class="pre">Signal.info</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.referenced_attributes"><code class="docutils literal notranslate"><span class="pre">Signal.referenced_attributes</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.size"><code class="docutils literal notranslate"><span class="pre">Signal.size</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.add"><code class="docutils literal notranslate"><span class="pre">Signal.add()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.add_drifts"><code class="docutils literal notranslate"><span class="pre">Signal.add_drifts()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.copy"><code class="docutils literal notranslate"><span class="pre">Signal.copy()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.differentiate"><code class="docutils literal notranslate"><span class="pre">Signal.differentiate()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.get_covariance"><code class="docutils literal notranslate"><span class="pre">Signal.get_covariance()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.get_differential"><code class="docutils literal notranslate"><span class="pre">Signal.get_differential()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.get_gain_increment"><code class="docutils literal notranslate"><span class="pre">Signal.get_gain_increment()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.get_integral"><code class="docutils literal notranslate"><span class="pre">Signal.get_integral()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.get_mean"><code class="docutils literal notranslate"><span class="pre">Signal.get_mean()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.get_median"><code class="docutils literal notranslate"><span class="pre">Signal.get_median()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.get_ml_gain_increment"><code class="docutils literal notranslate"><span class="pre">Signal.get_ml_gain_increment()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.get_resolution"><code class="docutils literal notranslate"><span class="pre">Signal.get_resolution()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.get_rms"><code class="docutils literal notranslate"><span class="pre">Signal.get_rms()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.get_robust_gain_increment"><code class="docutils literal notranslate"><span class="pre">Signal.get_robust_gain_increment()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.get_variance"><code class="docutils literal notranslate"><span class="pre">Signal.get_variance()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.integrate"><code class="docutils literal notranslate"><span class="pre">Signal.integrate()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.level"><code class="docutils literal notranslate"><span class="pre">Signal.level()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.prepare_frame_temp_fields"><code class="docutils literal notranslate"><span class="pre">Signal.prepare_frame_temp_fields()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.remove_drifts"><code class="docutils literal notranslate"><span class="pre">Signal.remove_drifts()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.resync_gains"><code class="docutils literal notranslate"><span class="pre">Signal.resync_gains()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.scale"><code class="docutils literal notranslate"><span class="pre">Signal.scale()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.set_sync_gains"><code class="docutils literal notranslate"><span class="pre">Signal.set_sync_gains()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.smooth"><code class="docutils literal notranslate"><span class="pre">Signal.smooth()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.smooth_with_kernel"><code class="docutils literal notranslate"><span class="pre">Signal.smooth_with_kernel()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.subtract"><code class="docutils literal notranslate"><span class="pre">Signal.subtract()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.synchronize_gains"><code class="docutils literal notranslate"><span class="pre">Signal.synchronize_gains()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.value_at"><code class="docutils literal notranslate"><span class="pre">Signal.value_at()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.weight_at"><code class="docutils literal notranslate"><span class="pre">Signal.weight_at()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.signal.signal.Signal.write_signal_values"><code class="docutils literal notranslate"><span class="pre">Signal.write_signal_values()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/sofia_redux.scan.signal.signal.Signal.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2024, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.2.6. &nbsp;
    Last built 05 Feb 2024. <br/>
  </p>
</footer>
  </body>
</html>