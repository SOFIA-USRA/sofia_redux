<!DOCTYPE html>

<html lang="en" data-content_root="../../../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>sofia_redux.scan.coordinate_systems.projection.cylindrical_equal_area_projection &#8212; sofia_redux v1.3.4.dev38+g92ea2f4</title>
    <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/plot_directive.css" />
    
    <script src="../../../../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../../../../_static/documentation_options.js?v=6aa39468"></script>
    <script src="../../../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script type="text/javascript" src="../../../../../_static/sidebar.js"></script>
    <script type="text/javascript" src="../../../../../_static/copybutton.js"></script>
    <link rel="icon" href="../../../../../_static/redux.ico"/>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../../../../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://irsa.ipac.caltech.edu/Missions/sofia.html"></a></li>
    <li><a title="General Index" href="../../../../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../../../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li>
	<a href="../../../../../index.html">sofia_redux v1.3.4.dev38+g92ea2f4</a>
	 &#187;
      </li>
      <li><a href="../../../../index.html" accesskey="U">Module code</a> &#187;</li>
      
       
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for sofia_redux.scan.coordinate_systems.projection.cylindrical_equal_area_projection</h1><div class="highlight"><pre>
<span></span># Licensed under a 3-clause BSD style license - see LICENSE.rst

from astropy import units
import numpy as np

from sofia_redux.scan.coordinate_systems.coordinate_2d import Coordinate2D
from sofia_redux.scan.coordinate_systems.spherical_coordinates import \
    SphericalCoordinates
from sofia_redux.scan.coordinate_systems.projection.cylindrical_projection \
    import CylindricalProjection

__all__ = [&#39;CylindricalEqualAreaProjection&#39;]


<div class="viewcode-block" id="CylindricalEqualAreaProjection">
<a class="viewcode-back" href="../../../../../api/sofia_redux.scan.coordinate_systems.projection.cylindrical_equal_area_projection.CylindricalEqualAreaProjection.html#sofia_redux.scan.coordinate_systems.projection.cylindrical_equal_area_projection.CylindricalEqualAreaProjection">[docs]</a>
class CylindricalEqualAreaProjection(CylindricalProjection):

    def __init__(self):
        &quot;&quot;&quot;
        Initialize a cylindrical equal-area projection.

        The cylindrical equal-area projection maps spherical coordinates onto
        a stretched vertical cylinder, with meridians as equally spaced
        vertical lines, and parallels as horizontal lines.  In this model,
        the stretch parameter is applied to the vertical axis, but is typically
        set to 1 (Lambert projection).
        &quot;&quot;&quot;
        super().__init__()
        self.stretch = 1.0

<div class="viewcode-block" id="CylindricalEqualAreaProjection.get_fits_id">
<a class="viewcode-back" href="../../../../../api/sofia_redux.scan.coordinate_systems.projection.cylindrical_equal_area_projection.CylindricalEqualAreaProjection.html#sofia_redux.scan.coordinate_systems.projection.cylindrical_equal_area_projection.CylindricalEqualAreaProjection.get_fits_id">[docs]</a>
    @classmethod
    def get_fits_id(cls):
        &quot;&quot;&quot;
        Return the FITS ID for the projection.

        Returns
        -------
        str
        &quot;&quot;&quot;
        return &quot;CEA&quot;</div>


<div class="viewcode-block" id="CylindricalEqualAreaProjection.get_full_name">
<a class="viewcode-back" href="../../../../../api/sofia_redux.scan.coordinate_systems.projection.cylindrical_equal_area_projection.CylindricalEqualAreaProjection.html#sofia_redux.scan.coordinate_systems.projection.cylindrical_equal_area_projection.CylindricalEqualAreaProjection.get_full_name">[docs]</a>
    @classmethod
    def get_full_name(cls):
        &quot;&quot;&quot;
        Return the full name of the projection.

        Returns
        -------
        str
        &quot;&quot;&quot;
        return &#39;Cylindrical Equal Area&#39;</div>


<div class="viewcode-block" id="CylindricalEqualAreaProjection.get_phi_theta">
<a class="viewcode-back" href="../../../../../api/sofia_redux.scan.coordinate_systems.projection.cylindrical_equal_area_projection.CylindricalEqualAreaProjection.html#sofia_redux.scan.coordinate_systems.projection.cylindrical_equal_area_projection.CylindricalEqualAreaProjection.get_phi_theta">[docs]</a>
    def get_phi_theta(self, offset, phi_theta=None):
        &quot;&quot;&quot;
        Return the phi (longitude) theta (latitude) coordinates.

        The phi and theta coordinates refer to the inverse projection
        (deprojection) of projected offsets about the native pole.  phi is
        the deprojected longitude, and theta is the deprojected latitude of
        the offsets.

        The cylindrical equal-area transform is very simple, of the form:

            phi = x
            theta = arcsin(stretch * y)

        Parameters
        ----------
        offset : Coordinate2D
        phi_theta : SphericalCoordinates, optional
            An optional output coordinate system in which to place the results.

        Returns
        -------
        coordinates : SphericalCoordinates
        &quot;&quot;&quot;
        if phi_theta is None:
            phi_theta = SphericalCoordinates(unit=&#39;degree&#39;)

        phi, y = self.offset_to_xy_radians(offset)
        theta = self.asin(self.stretch * y)
        phi_theta.set_native([phi, theta])
        return phi_theta</div>


<div class="viewcode-block" id="CylindricalEqualAreaProjection.get_offsets">
<a class="viewcode-back" href="../../../../../api/sofia_redux.scan.coordinate_systems.projection.cylindrical_equal_area_projection.CylindricalEqualAreaProjection.html#sofia_redux.scan.coordinate_systems.projection.cylindrical_equal_area_projection.CylindricalEqualAreaProjection.get_offsets">[docs]</a>
    def get_offsets(self, theta, phi, offsets=None):
        &quot;&quot;&quot;
        Get the offsets given theta and phi.

        Takes the theta (latitude) and phi (longitude) coordinates about the
        celestial pole and converts them to offsets from a reference position.
        For the cylindrical equal-area projection, this is given as:

            x = phi
            y = stretch * sin(theta)

        Parameters
        ----------
        theta : units.Quantity
            The theta angle.
        phi : units.Quantity
            The phi angle.
        offsets : Coordinate2D, optional
            An optional coordinate system in which to place the results.

        Returns
        -------
        offsets : Coordinate2D
        &quot;&quot;&quot;
        if offsets is None:
            offsets = Coordinate2D(unit=&#39;degree&#39;)

        phi, theta = self.phi_theta_to_radians(phi, theta)
        x = phi
        y = (np.sin(theta) / self.stretch) * units.Unit(&#39;radian&#39;)
        offsets.set([x, y])
        return offsets</div>


<div class="viewcode-block" id="CylindricalEqualAreaProjection.parse_header">
<a class="viewcode-back" href="../../../../../api/sofia_redux.scan.coordinate_systems.projection.cylindrical_equal_area_projection.CylindricalEqualAreaProjection.html#sofia_redux.scan.coordinate_systems.projection.cylindrical_equal_area_projection.CylindricalEqualAreaProjection.parse_header">[docs]</a>
    def parse_header(self, header, alt=&#39;&#39;):
        &quot;&quot;&quot;
        Parse and apply a FITS header to the projection.

        Parameters
        ----------
        header : fits.Header
            The FITS header to parse.
        alt : str, optional
            The alternate FITS system.

        Returns
        -------
        None
        &quot;&quot;&quot;
        super().parse_header(header, alt=alt)
        stretch_key = f&quot;{self.get_latitude_parameter_prefix()}1{alt}&quot;
        if stretch_key in header:
            self.stretch = float(header.get(stretch_key))</div>


<div class="viewcode-block" id="CylindricalEqualAreaProjection.edit_header">
<a class="viewcode-back" href="../../../../../api/sofia_redux.scan.coordinate_systems.projection.cylindrical_equal_area_projection.CylindricalEqualAreaProjection.html#sofia_redux.scan.coordinate_systems.projection.cylindrical_equal_area_projection.CylindricalEqualAreaProjection.edit_header">[docs]</a>
    def edit_header(self, header, alt=&#39;&#39;):
        &quot;&quot;&quot;
        Edit a FITS header with the projection information.

        Parameters
        ----------
        header : fits.Header
            The FITS header to edit.
        alt : str, optional
            The alternate FITS system.

        Returns
        -------
        None
        &quot;&quot;&quot;
        super().edit_header(header, alt=alt)
        lat_prefix = self.get_latitude_parameter_prefix()
        header[f&quot;{lat_prefix}1{alt}&quot;] = (
            self.stretch,
            &#39;lambda parameter for cylindrical equal area projection.&#39;)</div>
</div>

</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right"> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2024, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.2.6. &nbsp;
    Last built 05 Feb 2024. <br/>
  </p>
</footer>
  </body>
</html>