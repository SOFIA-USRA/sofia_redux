<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>FitsData &#8212; sofia_redux v1.3.4.dev38+g92ea2f4</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=6aa39468"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="icon" href="../_static/redux.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Image" href="sofia_redux.scan.source_models.maps.image.Image.html" />
    <link rel="prev" title="ExposureMap" href="sofia_redux.scan.source_models.maps.exposure_map.ExposureMap.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://irsa.ipac.caltech.edu/Missions/sofia.html"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="sofia_redux.scan.source_models.maps.image.Image.html" title="Image">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="sofia_redux.scan.source_models.maps.exposure_map.ExposureMap.html" title="ExposureMap">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">sofia_redux v1.3.4.dev38+g92ea2f4</a>
	 &#187;
      </li>
      <li><a href="../sofia_redux/index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../sofia_redux/scan/index.html" accesskey="U">sofia_redux.scan: Scan Mode Algorithms for SOFIA Pipelines</a> &#187;</li>
      
      <li>FitsData</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="fitsdata">
<h1>FitsData<a class="headerlink" href="#fitsdata" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sofia_redux.scan.source_models.maps.fits_data.</span></span><span class="sig-name descname"><span class="pre">FitsData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blanking_value=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'float'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="sofia_redux.scan.flags.flagged_array.FlaggedArray.html#sofia_redux.scan.flags.flagged_array.FlaggedArray" title="sofia_redux.scan.flags.flagged_array.FlaggedArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlaggedArray</span></code></a></p>
<p>Creates a FitsData instance.</p>
<p>The FitsData class is an extension of <code class="xref py py-obj docutils literal notranslate"><span class="pre">FlaggedArray</span></code> that allows
additional functionality for FITS data.  This includes specifying
data units (astropy.units), history messages and FITS handling.</p>
<p>Notably, the dimensional ordering will now be in FITS (x, y) order
rather than the <code class="xref py py-obj docutils literal notranslate"><span class="pre">FlaggedArray</span></code> Numpy (y, x) ordering for the various
methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data</strong><span class="classifier">numpy.ndarray, optional</span></dt><dd><p>Data to initialize the flagged array with.  If supplied, sets the
shape of the array.  Note that the data type will be set to that
defined by the <code class="xref py py-obj docutils literal notranslate"><span class="pre">dtype</span></code> parameter.</p>
</dd>
<dt><strong>blanking_value</strong><span class="classifier">int or float, optional</span></dt><dd><p>The blanking value defines invalid values in the data array.  This
is the equivalent of defining a NaN value.</p>
</dd>
<dt><strong>dtype</strong><span class="classifier">type, optional</span></dt><dd><p>The data type of the data array.</p>
</dd>
<dt><strong>shape</strong><span class="classifier">tuple (int), optional</span></dt><dd><p>The shape of the data array.  This will only be relevant if
<code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code> is not defined.</p>
</dd>
<dt><strong>unit</strong><span class="classifier">str or units.Unit or units.Quantity, optional</span></dt><dd><p>The data unit.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Attributes Summary</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.DEFAULT_UNIT" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.DEFAULT_UNIT"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DEFAULT_UNIT</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.referenced_attributes" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.referenced_attributes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">referenced_attributes</span></code></a></p></td>
<td><p>Return attribute names that should be referenced during a copy.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.unit" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.unit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unit</span></code></a></p></td>
<td><p>Return the current data unit.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods Summary</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.add" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.add"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add</span></code></a>(value[, indices, factor])</p></td>
<td><p>Add a value or FlaggedData to the data array.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.add_alternate_unit_names" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.add_alternate_unit_names"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_alternate_unit_names</span></code></a>(unit_name, ...)</p></td>
<td><p>Add alternative names for a unit.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.add_history" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.add_history"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_history</span></code></a>(message)</p></td>
<td><p>Add a history message.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.add_history_to_header" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.add_history_to_header"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_history_to_header</span></code></a>(header)</p></td>
<td><p>Add history messages to a FITS header.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.add_local_unit" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.add_local_unit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_local_unit</span></code></a>(unit[, alternate_names])</p></td>
<td><p>Add a unit to the dictionary of local units.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.clear" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.clear"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear</span></code></a>([indices])</p></td>
<td><p>Clear flags and set data to zero.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.clear_history" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.clear_history"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear_history</span></code></a>()</p></td>
<td><p>Clear the history messages.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.copy" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a>()</p></td>
<td><p>Return a copy of the FITS data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.create_fits" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.create_fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_fits</span></code></a>()</p></td>
<td><p>Create and return a FITS HDU list from data content.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.create_hdu" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.create_hdu"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_hdu</span></code></a>()</p></td>
<td><p>Create a FITS HDU from map data content.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.crop" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.crop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">crop</span></code></a>(ranges)</p></td>
<td><p>Crop the array to the required dimensions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.delete_indices" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.delete_indices"><code class="xref py py-obj docutils literal notranslate"><span class="pre">delete_indices</span></code></a>(indices_or_mask)</p></td>
<td><p>Completely deletes data elements.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.despike" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.despike"><code class="xref py py-obj docutils literal notranslate"><span class="pre">despike</span></code></a>(threshold[, noise_weight])</p></td>
<td><p>Discard spikes whose significance is above a given threshold.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.destroy" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.destroy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">destroy</span></code></a>()</p></td>
<td><p>Destroy the image data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.edit_header" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.edit_header"><code class="xref py py-obj docutils literal notranslate"><span class="pre">edit_header</span></code></a>(header)</p></td>
<td><p>Edit a FITS header using information in the current map.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.fast_smooth" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.fast_smooth"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fast_smooth</span></code></a>(beam_map, steps[, ...])</p></td>
<td><p>Smooth using the fast method.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.fill" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.fill"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fill</span></code></a>(value[, indices])</p></td>
<td><p>Fill the data array with a given value.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.fits_to_numpy" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.fits_to_numpy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fits_to_numpy</span></code></a>(coordinates)</p></td>
<td><p>Convert FITS based (x, y) coordinates/indices to numpy (y, x).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.get_fast_smoothed" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.get_fast_smoothed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_fast_smoothed</span></code></a>(beam_map, steps[, ...])</p></td>
<td><p>Return smoothed values using the fast method.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.get_fits_data" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.get_fits_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_fits_data</span></code></a>()</p></td>
<td><p>Return the FITS data array.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.get_hdus" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.get_hdus"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_hdus</span></code></a>()</p></td>
<td><p>Create and return a list if FITS HDUs.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.get_index_range" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.get_index_range"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_index_range</span></code></a>()</p></td>
<td><p>Return the index ranges of valid points.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.get_indices" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.get_indices"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_indices</span></code></a>(indices)</p></td>
<td><p>Return selected data for given indices.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.get_refined_peak_index" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.get_refined_peak_index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_refined_peak_index</span></code></a>(peak_index)</p></td>
<td><p>Get the peak index given a local peak.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.get_size_string" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.get_size_string"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_size_string</span></code></a>()</p></td>
<td><p>Return the shape of the data array as a string.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.get_smoothed" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.get_smoothed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_smoothed</span></code></a>(beam_map[, reference_index, ...])</p></td>
<td><p>Return smoothed data and weights.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.get_unit" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.get_unit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_unit</span></code></a>(unit)</p></td>
<td><p>Return the unit quantity for a given unit.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.index_of_max" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.index_of_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">index_of_max</span></code></a>([sign, data])</p></td>
<td><p>Return the maximum value and index of maximum value.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.insert_blanks" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.insert_blanks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">insert_blanks</span></code></a>(insert_indices)</p></td>
<td><p>Inserts blank frame data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.merge" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.merge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">merge</span></code></a>(data)</p></td>
<td><p>Add additional data onto the end of this data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.numpy_to_fits" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.numpy_to_fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy_to_fits</span></code></a>(coordinates)</p></td>
<td><p>Convert numpy based (x, y) coordinates/indices to FITS coordinates.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.parse_header" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.parse_header"><code class="xref py py-obj docutils literal notranslate"><span class="pre">parse_header</span></code></a>(header)</p></td>
<td><p>Parse and apply information from a FITS header.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.parse_history" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.parse_history"><code class="xref py py-obj docutils literal notranslate"><span class="pre">parse_history</span></code></a>(header)</p></td>
<td><p>Set the history from a FITS header.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.paste" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.paste"><code class="xref py py-obj docutils literal notranslate"><span class="pre">paste</span></code></a>(source[, report])</p></td>
<td><p>Paste data from another MapData onto the data array.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.record_new_data" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.record_new_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">record_new_data</span></code></a>([detail])</p></td>
<td><p>Start recording new data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.resample_from" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.resample_from"><code class="xref py py-obj docutils literal notranslate"><span class="pre">resample_from</span></code></a>(image, to_indices[, kernel, ...])</p></td>
<td><p>Resample an image onto given indices of this map.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.scale" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.scale"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scale</span></code></a>(factor[, indices])</p></td>
<td><p>Scale the data by a given factor.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.set_data" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.set_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_data</span></code></a>(data[, change_type])</p></td>
<td><p>Set the data of the flagged array.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.set_data_shape" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.set_data_shape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_data_shape</span></code></a>(shape)</p></td>
<td><p>Set the shape of the data image array.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.set_default_unit" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.set_default_unit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_default_unit</span></code></a>()</p></td>
<td><p>Set the default unit for the map data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.set_executor" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.set_executor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_executor</span></code></a>(executor)</p></td>
<td><p>Set the executor?</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.set_history" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.set_history"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_history</span></code></a>(messages)</p></td>
<td><p>Set the history to a given list of history messages.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.set_parallel" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.set_parallel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_parallel</span></code></a>(threads)</p></td>
<td><p>Set the number of parallel threads.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.set_unit" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.set_unit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_unit</span></code></a>(unit)</p></td>
<td><p>Set the map data unit.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.smooth" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.smooth"><code class="xref py py-obj docutils literal notranslate"><span class="pre">smooth</span></code></a>(beam_map[, reference_index, weights])</p></td>
<td><p>Smooth the map with a beam map kernel.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.unit_to_quantity" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.unit_to_quantity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unit_to_quantity</span></code></a>(unit)</p></td>
<td><p>Return an astropy Quantity from a given unit.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.validate" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.validate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">validate</span></code></a>([validator])</p></td>
<td><p>Discard all invalid data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.value_at" title="sofia_redux.scan.source_models.maps.fits_data.FitsData.value_at"><code class="xref py py-obj docutils literal notranslate"><span class="pre">value_at</span></code></a>(index[, degree, reduce_degrees])</p></td>
<td><p>Return the data value at a given index.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes Documentation</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.DEFAULT_UNIT">
<span class="sig-name descname"><span class="pre">DEFAULT_UNIT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Quantity</span> <span class="pre">1.&gt;</span></em><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.DEFAULT_UNIT" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.referenced_attributes">
<span class="sig-name descname"><span class="pre">referenced_attributes</span></span><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.referenced_attributes" title="Link to this definition">¶</a></dt>
<dd><p>Return attribute names that should be referenced during a copy.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>set (str)</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.unit">
<span class="sig-name descname"><span class="pre">unit</span></span><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.unit" title="Link to this definition">¶</a></dt>
<dd><p>Return the current data unit.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>astropy.units.Quantity</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<p class="rubric">Methods Documentation</p>
<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.add"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.add" title="Link to this definition">¶</a></dt>
<dd><p>Add a value or FlaggedData to the data array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>value</strong><span class="classifier">int or float or FlaggedArray</span></dt><dd><p>The value to add.</p>
</dd>
<dt><strong>indices</strong><span class="classifier">tuple (numpy.ndarray (int)) or numpy.ndarray (bool), optional</span></dt><dd><p>The indices to discard.  Either supplied as a boolean mask of
shape (self.data.shape).</p>
</dd>
<dt><strong>factor</strong><span class="classifier">int or float, optional</span></dt><dd><p>An optional factor to scale the data by.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.add_alternate_unit_names">
<span class="sig-name descname"><span class="pre">add_alternate_unit_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unit_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alternate_names</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.add_alternate_unit_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.add_alternate_unit_names" title="Link to this definition">¶</a></dt>
<dd><p>Add alternative names for a unit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>unit_name</strong><span class="classifier">str</span></dt><dd><p>The name of the unit.</p>
</dd>
<dt><strong>alternate_names</strong><span class="classifier">str or list (str)</span></dt><dd><p>Alternate names for the unit.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.add_history">
<span class="sig-name descname"><span class="pre">add_history</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.add_history"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.add_history" title="Link to this definition">¶</a></dt>
<dd><p>Add a history message.</p>
<p>Will also result in a log message if verbose is True.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>message</strong><span class="classifier">str or list(str)</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.add_history_to_header">
<span class="sig-name descname"><span class="pre">add_history_to_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.add_history_to_header"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.add_history_to_header" title="Link to this definition">¶</a></dt>
<dd><p>Add history messages to a FITS header.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>header</strong><span class="classifier">astropy.io.fits.header.Header</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.add_local_unit">
<span class="sig-name descname"><span class="pre">add_local_unit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alternate_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.add_local_unit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.add_local_unit" title="Link to this definition">¶</a></dt>
<dd><p>Add a unit to the dictionary of local units.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>unit</strong><span class="classifier">astropy.units.Quantity or units.Unit or str</span></dt><dd><p>The unit to add to the unit dictionary.  Should be a quantity
with both value and unit type.  If a simple unit is supplied, the
value is assumed to be 1.0.</p>
</dd>
<dt><strong>alternate_names</strong><span class="classifier">list, optional</span></dt><dd><p>A list of alternate names for the unit.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.clear">
<span class="sig-name descname"><span class="pre">clear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.clear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.clear" title="Link to this definition">¶</a></dt>
<dd><p>Clear flags and set data to zero.  Clear history.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>indices</strong><span class="classifier">tuple (numpy.ndarray (int)) or numpy.ndarray (bool), optional</span></dt><dd><p>The indices to discard.  Either supplied as a boolean mask of
shape (self.data.shape).  Note that if an integer array or tuple
of integer arrays are supplied, they should be in (x, y) FITS
order.  Boolean masks should be of the same shape as the data.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.clear_history">
<span class="sig-name descname"><span class="pre">clear_history</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.clear_history"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.clear_history" title="Link to this definition">¶</a></dt>
<dd><p>Clear the history messages.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.copy" title="Link to this definition">¶</a></dt>
<dd><p>Return a copy of the FITS data.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>FitsData</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.create_fits">
<span class="sig-name descname"><span class="pre">create_fits</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.create_fits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.create_fits" title="Link to this definition">¶</a></dt>
<dd><p>Create and return a FITS HDU list from data content.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>astropy.io.fits.HDUList</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.create_hdu">
<span class="sig-name descname"><span class="pre">create_hdu</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.create_hdu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.create_hdu" title="Link to this definition">¶</a></dt>
<dd><p>Create a FITS HDU from map data content.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>astropy.io.fits.ImageHDU</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.crop">
<span class="sig-name descname"><span class="pre">crop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ranges</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.crop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.crop" title="Link to this definition">¶</a></dt>
<dd><p>Crop the array to the required dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ranges</strong><span class="classifier">numpy.ndarray (int,)</span></dt><dd><p>The ranges to set crop the data to.  Should be of shape
(n_dimensions, 2) where ranges[0, 0] would give the minimum crop
limit for the first dimension and ranges[0, 1] would give the
maximum crop limit for the first dimension.  In this case, the
‘first’ dimension is in FITS format.  i.e., (x, y) for a 2-D array.
Also note that the upper crop limit is inclusive so a range
of (0, 3) includes indices [0, 1, 2, 3].</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.delete_indices">
<span class="sig-name descname"><span class="pre">delete_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices_or_mask</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.delete_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.delete_indices" title="Link to this definition">¶</a></dt>
<dd><p>Completely deletes data elements.</p>
<p>Actual indices should be passed in.  To delete based on fixed index
values, please convert first using <code class="xref py py-obj docutils literal notranslate"><span class="pre">find_fixed_indices</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>indices_or_mask</strong><span class="classifier">int or list or numpy.ndarray of (bool or int)</span></dt><dd><p>The indices to delete, or a boolean mask where <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> marks an
element for deletion.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>NotImplementedError</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.despike">
<span class="sig-name descname"><span class="pre">despike</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.despike"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.despike" title="Link to this definition">¶</a></dt>
<dd><p>Discard spikes whose significance is above a given threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>threshold</strong><span class="classifier">float</span></dt><dd></dd>
<dt><strong>noise_weight</strong><span class="classifier">numpy.ndarray (float), optional</span></dt><dd><p>Optional noise weights.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.destroy">
<span class="sig-name descname"><span class="pre">destroy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.destroy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.destroy" title="Link to this definition">¶</a></dt>
<dd><p>Destroy the image data.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.edit_header">
<span class="sig-name descname"><span class="pre">edit_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.edit_header"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.edit_header" title="Link to this definition">¶</a></dt>
<dd><p>Edit a FITS header using information in the current map.</p>
<p>The information keywords added to the header are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>- DATAMIN: The lowest value in the data (float)
- DATAMAX: The highesst value in the data (float)
- BZERO: Zeroing level of the data (float)
- BSCALE: Scaling of the data (float)
- BUNIT: The data unit (str)
</pre></div>
</div>
<p>Note that BUNIT will default to ‘count’ if no unit has been set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>header</strong><span class="classifier">astropy.io.fits.header.Header</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.fast_smooth">
<span class="sig-name descname"><span class="pre">fast_smooth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beam_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.fast_smooth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.fast_smooth" title="Link to this definition">¶</a></dt>
<dd><p>Smooth using the fast method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>beam_map</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The beam map image kernel with which to smooth the map of shape
(ky, kx).</p>
</dd>
<dt><strong>steps</strong><span class="classifier">Index2D</span></dt><dd><p>The fast step skips in (x, y) FITS dimensional order.</p>
</dd>
<dt><strong>reference_index</strong><span class="classifier">Coordinate2D, optional</span></dt><dd><p>The reference pixel index of the kernel in (x, y) FITS
dimensional order.  The default is the beam map center at
(kx-1)/2, (ky-1)/2.</p>
</dd>
<dt><strong>weights</strong><span class="classifier">numpy.ndarray (float), optional</span></dt><dd><p>The map weights of shape (ny, nx).  The default is no weighting.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.fill">
<span class="sig-name descname"><span class="pre">fill</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.fill"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.fill" title="Link to this definition">¶</a></dt>
<dd><p>Fill the data array with a given value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>value</strong><span class="classifier">int or float</span></dt><dd><p>The value to fill.</p>
</dd>
<dt><strong>indices</strong><span class="classifier">tuple (numpy.ndarray (int)) or numpy.ndarray (bool), optional</span></dt><dd><p>The indices to discard.  Either supplied as a boolean mask of
shape (self.data.shape).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.fits_to_numpy">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fits_to_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coordinates</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.fits_to_numpy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.fits_to_numpy" title="Link to this definition">¶</a></dt>
<dd><p>Convert FITS based (x, y) coordinates/indices to numpy (y, x).</p>
<p>Reverses the dimensional ordering so that (x, y) coordinates are
returned as (y, x) coordinates.  Note that boolean arrays remain
unaltered, since these usually indicate masking arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>coordinates</strong><span class="classifier">numpy.ndarray or Coordinate or iterable</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>numpy_coordinates</strong><span class="classifier">numpy.ndarray (int or float)</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.get_fast_smoothed">
<span class="sig-name descname"><span class="pre">get_fast_smoothed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beam_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.get_fast_smoothed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.get_fast_smoothed" title="Link to this definition">¶</a></dt>
<dd><p>Return smoothed values using the fast method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>beam_map</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The kernel to convolve with.</p>
</dd>
<dt><strong>steps</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The size of the steps in each dimension.</p>
</dd>
<dt><strong>reference_index</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The reference index of the beam map center.  The default is
(beam_map.shape - 1) / 2.0.</p>
</dd>
<dt><strong>weights</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>Weights the same shape as beam map.</p>
</dd>
<dt><strong>get_weights</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, calculate the smoothed weights in addition to the
smoothed data.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>smoothed_data, [smoothed_weights]</strong><span class="classifier">numpy.ndarray, [numpy.ndarray]</span></dt><dd><p>The smoothed data and weights.  Will only return smoothed data if
<code class="xref py py-obj docutils literal notranslate"><span class="pre">get_weights</span></code> is <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.get_fits_data">
<span class="sig-name descname"><span class="pre">get_fits_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.get_fits_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.get_fits_data" title="Link to this definition">¶</a></dt>
<dd><p>Return the FITS data array.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>array</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.get_hdus">
<span class="sig-name descname"><span class="pre">get_hdus</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.get_hdus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.get_hdus" title="Link to this definition">¶</a></dt>
<dd><p>Create and return a list if FITS HDUs.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>hdus: list (astropy.io.fits.hdu.base.ExtensionHDU)</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.get_index_range">
<span class="sig-name descname"><span class="pre">get_index_range</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.get_index_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.get_index_range" title="Link to this definition">¶</a></dt>
<dd><p>Return the index ranges of valid points.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ranges</strong><span class="classifier">numpy.ndarray (int) or Coordinate</span></dt><dd><p>A range for each dimension or shape (n_dimensions, 2) giving the
minimum and maximum range in each dimension.  Note that this is
FITS dimension ordering (x-range = ranges[0], y-range = ranges[1]).
Also note that the upper range is returned such that the real
upper index is included in any slice operation. i.e., max = real
max index + 1.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.get_indices">
<span class="sig-name descname"><span class="pre">get_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.get_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.get_indices" title="Link to this definition">¶</a></dt>
<dd><p>Return selected data for given indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>indices</strong><span class="classifier">list or int or numpy.ndarray (bool or int)</span></dt><dd><p>The indices to extract.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>NotImplementedError</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.get_refined_peak_index">
<span class="sig-name descname"><span class="pre">get_refined_peak_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">peak_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.get_refined_peak_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.get_refined_peak_index" title="Link to this definition">¶</a></dt>
<dd><p>Get the peak index given a local peak.</p>
<p>Basically performs a quadratic fit on local neighborhood to determine
the maximum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>peak_index</strong><span class="classifier">tuple (int)</span></dt><dd><p>The peak index of the data array in (y, x) numpy format.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>refined_peak_index</strong><span class="classifier">numpy.ndarray or Coordinate</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.get_size_string">
<span class="sig-name descname"><span class="pre">get_size_string</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.get_size_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.get_size_string" title="Link to this definition">¶</a></dt>
<dd><p>Return the shape of the data array as a string.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>str</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.get_smoothed">
<span class="sig-name descname"><span class="pre">get_smoothed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beam_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.get_smoothed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.get_smoothed" title="Link to this definition">¶</a></dt>
<dd><p>Return smoothed data and weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>beam_map</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The kernel with which to smooth the map.  Should be of shape
(ny, nx).</p>
</dd>
<dt><strong>reference_index</strong><span class="classifier">numpy.ndarray (float or int) or Coordinate, optional</span></dt><dd><p>The reference index specifying the center pixel of the beam map.
The default is the center pixel position, eg., (ny - 1) / 2.</p>
</dd>
<dt><strong>weights</strong><span class="classifier">numpy.ndarray (float), optional</span></dt><dd><p>The weights to apply during smoothing.  Should be the same shape
as the primary map image.  The default is no weighting.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>smoothed_data, smoothed_weights</strong><span class="classifier">numpy.ndarray, numpy.ndarray</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.get_unit">
<span class="sig-name descname"><span class="pre">get_unit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unit</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.get_unit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.get_unit" title="Link to this definition">¶</a></dt>
<dd><p>Return the unit quantity for a given unit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>unit</strong><span class="classifier">str or units.Unit or units.Quantity</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>units.Quantity</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.index_of_max">
<span class="sig-name descname"><span class="pre">index_of_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.index_of_max"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.index_of_max" title="Link to this definition">¶</a></dt>
<dd><p>Return the maximum value and index of maximum value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>sign</strong><span class="classifier">int or float, optional</span></dt><dd><p>If positive, find the maximum value in the array.  If negative,
find the minimum value in the array.  If zero, find the maximum
magnitude in the array.</p>
</dd>
<dt><strong>data</strong><span class="classifier">numpy.ndarray (float), optional</span></dt><dd><p>The data array to examine.  Default is self.data.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>maximum_value, maximum_index</strong><span class="classifier">float, numpy.ndarray or Coordinate</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.insert_blanks">
<span class="sig-name descname"><span class="pre">insert_blanks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">insert_indices</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.insert_blanks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.insert_blanks" title="Link to this definition">¶</a></dt>
<dd><p>Inserts blank frame data.</p>
<p>Actual indices should be passed in.  To delete based on fixed index
values, please convert first using <code class="xref py py-obj docutils literal notranslate"><span class="pre">find_fixed_indices</span></code>.</p>
<p>Blank data are set to 0 in whatever unit is applicable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>insert_indices</strong><span class="classifier">int or list or numpy.ndarray of (bool or int)</span></dt><dd><p>The index locations to insert.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>NotImplementedError</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.merge">
<span class="sig-name descname"><span class="pre">merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.merge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.merge" title="Link to this definition">¶</a></dt>
<dd><p>Add additional data onto the end of this data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data</strong><span class="classifier">FlaggedData</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>NotImplementedError</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.numpy_to_fits">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">numpy_to_fits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coordinates</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.numpy_to_fits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.numpy_to_fits" title="Link to this definition">¶</a></dt>
<dd><p>Convert numpy based (x, y) coordinates/indices to FITS coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>coordinates</strong><span class="classifier">numpy.ndarray or Coordinate or iterable</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>numpy.ndarray</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.parse_header">
<span class="sig-name descname"><span class="pre">parse_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.parse_header"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.parse_header" title="Link to this definition">¶</a></dt>
<dd><p>Parse and apply information from a FITS header.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>header</strong><span class="classifier">astropy.io.fits.header.Header</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.parse_history">
<span class="sig-name descname"><span class="pre">parse_history</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.parse_history"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.parse_history" title="Link to this definition">¶</a></dt>
<dd><p>Set the history from a FITS header.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>header</strong><span class="classifier">astropy.io.fits.header.Header</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.paste">
<span class="sig-name descname"><span class="pre">paste</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.paste"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.paste" title="Link to this definition">¶</a></dt>
<dd><p>Paste data from another MapData onto the data array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>source</strong><span class="classifier">FitsData</span></dt><dd></dd>
<dt><strong>report</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, add a history message.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.record_new_data">
<span class="sig-name descname"><span class="pre">record_new_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">detail</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.record_new_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.record_new_data" title="Link to this definition">¶</a></dt>
<dd><p>Start recording new data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>detail</strong><span class="classifier">str, optional</span></dt><dd><p>An optional message to append to the start of the new data log.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.resample_from">
<span class="sig-name descname"><span class="pre">resample_from</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_reference_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.resample_from"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.resample_from" title="Link to this definition">¶</a></dt>
<dd><p>Resample an image onto given indices of this map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>image</strong><span class="classifier">FlaggedArray or numpy.ndarray (float)</span></dt><dd><p>The image to resample of shape (shape,) and have n_dimensions.</p>
</dd>
<dt><strong>to_indices</strong><span class="classifier">numpy.ndarray (float or int)</span></dt><dd><p>An array of shape (n_dimensions, self.shape or self.size)
specifying which image pixels belong to the resampled map.
Dimensions should be ordered using the FITS (x, y) convention.
For example, if pixel i is at (x, y) = (2, 3) then
<code class="xref py py-obj docutils literal notranslate"><span class="pre">to_indices[:,</span> <span class="pre">i]</span> <span class="pre">=</span> <span class="pre">[2,</span> <span class="pre">3]</span></code>.</p>
</dd>
<dt><strong>kernel</strong><span class="classifier">numpy.ndarray (float), optional</span></dt><dd><p>The kernel used to perform the resampling.  If supplied, the result
will be smoothed accordingly.</p>
</dd>
<dt><strong>kernel_reference_index</strong><span class="classifier">numpy.ndarray (int), optional</span></dt><dd><p>If a kernel is supplied, specifies the center pixel of the kernel
to be used during kernel convolution.  The default is
(kernel.shape - 1) / 2.  Should be an array of shape
(n_dimensions,) using FITS dimensional ordering (x, y).</p>
</dd>
<dt><strong>weights</strong><span class="classifier">numpy.ndarray (int or float), optional</span></dt><dd><p>An optional weighting array used for kernel convolution.  Should
be an array of shape (shape,).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.scale">
<span class="sig-name descname"><span class="pre">scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.scale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.scale" title="Link to this definition">¶</a></dt>
<dd><p>Scale the data by a given factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>factor</strong><span class="classifier">int or float</span></dt><dd><p>The factor to scale by.</p>
</dd>
<dt><strong>indices</strong><span class="classifier">tuple (np.ndarray) or np.ndarray (int or bool), optional</span></dt><dd><p>The indices to discard.  Either supplied as a boolean mask of
shape (self.data.shape).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.set_data">
<span class="sig-name descname"><span class="pre">set_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">change_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.set_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.set_data" title="Link to this definition">¶</a></dt>
<dd><p>Set the data of the flagged array.</p>
<p>All flags are set to zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data</strong><span class="classifier">numpy.ndarray or FlaggedArray</span></dt><dd></dd>
<dt><strong>change_type</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, change the data type to that of the data.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.set_data_shape">
<span class="sig-name descname"><span class="pre">set_data_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.set_data_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.set_data_shape" title="Link to this definition">¶</a></dt>
<dd><p>Set the shape of the data image array.</p>
<p>Note that array shapes should still be provided in Numpy (y, x) format.
In addition to settings the data shape, adds a new history message
indicating that this has been done.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>shape</strong><span class="classifier">tuple (int)</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.set_default_unit">
<span class="sig-name descname"><span class="pre">set_default_unit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.set_default_unit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.set_default_unit" title="Link to this definition">¶</a></dt>
<dd><p>Set the default unit for the map data.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.set_executor">
<span class="sig-name descname"><span class="pre">set_executor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">executor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.set_executor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.set_executor" title="Link to this definition">¶</a></dt>
<dd><p>Set the executor?</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>executor</strong><span class="classifier">Executor</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.set_history">
<span class="sig-name descname"><span class="pre">set_history</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">messages</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.set_history"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.set_history" title="Link to this definition">¶</a></dt>
<dd><p>Set the history to a given list of history messages.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>messages</strong><span class="classifier">str or list (str)</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.set_parallel">
<span class="sig-name descname"><span class="pre">set_parallel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threads</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.set_parallel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.set_parallel" title="Link to this definition">¶</a></dt>
<dd><p>Set the number of parallel threads.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>threads</strong><span class="classifier">int</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.set_unit">
<span class="sig-name descname"><span class="pre">set_unit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unit</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.set_unit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.set_unit" title="Link to this definition">¶</a></dt>
<dd><p>Set the map data unit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>unit</strong><span class="classifier">astropy.units.Quantity or str or astropy.units.Unit</span></dt><dd><p>The unit to set as the map data unit.  Should be a quantity
(value and unit type).  If a string or Unit is supplied, the
map data unit will be set to the value located in the local_units
dictionary.  If no such value exists, a KeyError will be raised.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.smooth">
<span class="sig-name descname"><span class="pre">smooth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beam_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.smooth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.smooth" title="Link to this definition">¶</a></dt>
<dd><p>Smooth the map with a beam map kernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>beam_map</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The beam map with which to smooth the map of shape (ny, nx, …).</p>
</dd>
<dt><strong>reference_index</strong><span class="classifier">numpy.ndarray (int) or Coordinate, optional</span></dt><dd><p>The index specifying the center pixel of the kernel.  Should be
provided in (x, y) ordering.  The default is the center of the
kernel.</p>
</dd>
<dt><strong>weights</strong><span class="classifier">numpy.ndarray (float), optional</span></dt><dd><p>The map weights to apply.  Should be the same shape as the primary
map image.  The default is to apply no weighting.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.unit_to_quantity">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">unit_to_quantity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unit</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.unit_to_quantity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.unit_to_quantity" title="Link to this definition">¶</a></dt>
<dd><p>Return an astropy Quantity from a given unit.</p>
<p>If a string or astropy.units.Unit is supplied, the resultant output
will be a quantity with value 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>unit</strong><span class="classifier">astropy.units.Quantity or astropy.units.Unit or str</span></dt><dd><p>The unit to convert to a quantity.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>astropy.units.Quantity</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">validator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.validate" title="Link to this definition">¶</a></dt>
<dd><p>Discard all invalid data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>validator</strong><span class="classifier">Validator, optional</span></dt><dd><p>An optional object or function that can take FitsData as an
argument and perform the validation.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.maps.fits_data.FitsData.value_at">
<span class="sig-name descname"><span class="pre">value_at</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_degrees</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/maps/fits_data.html#FitsData.value_at"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.value_at" title="Link to this definition">¶</a></dt>
<dd><p>Return the data value at a given index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>index</strong><span class="classifier">numpy.ndarray (int or float)</span></dt><dd><p>An array of shape (n_dimensions,).  Should be supplied in (x, y)
order (FITS).</p>
</dd>
<dt><strong>degree</strong><span class="classifier">int, optional</span></dt><dd><p>The degree of spline to fit.</p>
</dd>
<dt><strong>reduce_degrees</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, allow the spline fit to reduce the number of degrees
in cases where there are not enough points available to perform
the spline fit of <code class="xref py py-obj docutils literal notranslate"><span class="pre">degree</span></code>.  If <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, a ValueError will be
raised if such a fit fails.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>float</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">FitsData</a><ul>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData"><code class="docutils literal notranslate"><span class="pre">FitsData</span></code></a><ul>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.DEFAULT_UNIT"><code class="docutils literal notranslate"><span class="pre">FitsData.DEFAULT_UNIT</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.referenced_attributes"><code class="docutils literal notranslate"><span class="pre">FitsData.referenced_attributes</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.unit"><code class="docutils literal notranslate"><span class="pre">FitsData.unit</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.add"><code class="docutils literal notranslate"><span class="pre">FitsData.add()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.add_alternate_unit_names"><code class="docutils literal notranslate"><span class="pre">FitsData.add_alternate_unit_names()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.add_history"><code class="docutils literal notranslate"><span class="pre">FitsData.add_history()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.add_history_to_header"><code class="docutils literal notranslate"><span class="pre">FitsData.add_history_to_header()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.add_local_unit"><code class="docutils literal notranslate"><span class="pre">FitsData.add_local_unit()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.clear"><code class="docutils literal notranslate"><span class="pre">FitsData.clear()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.clear_history"><code class="docutils literal notranslate"><span class="pre">FitsData.clear_history()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.copy"><code class="docutils literal notranslate"><span class="pre">FitsData.copy()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.create_fits"><code class="docutils literal notranslate"><span class="pre">FitsData.create_fits()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.create_hdu"><code class="docutils literal notranslate"><span class="pre">FitsData.create_hdu()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.crop"><code class="docutils literal notranslate"><span class="pre">FitsData.crop()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.delete_indices"><code class="docutils literal notranslate"><span class="pre">FitsData.delete_indices()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.despike"><code class="docutils literal notranslate"><span class="pre">FitsData.despike()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.destroy"><code class="docutils literal notranslate"><span class="pre">FitsData.destroy()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.edit_header"><code class="docutils literal notranslate"><span class="pre">FitsData.edit_header()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.fast_smooth"><code class="docutils literal notranslate"><span class="pre">FitsData.fast_smooth()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.fill"><code class="docutils literal notranslate"><span class="pre">FitsData.fill()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.fits_to_numpy"><code class="docutils literal notranslate"><span class="pre">FitsData.fits_to_numpy()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.get_fast_smoothed"><code class="docutils literal notranslate"><span class="pre">FitsData.get_fast_smoothed()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.get_fits_data"><code class="docutils literal notranslate"><span class="pre">FitsData.get_fits_data()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.get_hdus"><code class="docutils literal notranslate"><span class="pre">FitsData.get_hdus()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.get_index_range"><code class="docutils literal notranslate"><span class="pre">FitsData.get_index_range()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.get_indices"><code class="docutils literal notranslate"><span class="pre">FitsData.get_indices()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.get_refined_peak_index"><code class="docutils literal notranslate"><span class="pre">FitsData.get_refined_peak_index()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.get_size_string"><code class="docutils literal notranslate"><span class="pre">FitsData.get_size_string()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.get_smoothed"><code class="docutils literal notranslate"><span class="pre">FitsData.get_smoothed()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.get_unit"><code class="docutils literal notranslate"><span class="pre">FitsData.get_unit()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.index_of_max"><code class="docutils literal notranslate"><span class="pre">FitsData.index_of_max()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.insert_blanks"><code class="docutils literal notranslate"><span class="pre">FitsData.insert_blanks()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.merge"><code class="docutils literal notranslate"><span class="pre">FitsData.merge()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.numpy_to_fits"><code class="docutils literal notranslate"><span class="pre">FitsData.numpy_to_fits()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.parse_header"><code class="docutils literal notranslate"><span class="pre">FitsData.parse_header()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.parse_history"><code class="docutils literal notranslate"><span class="pre">FitsData.parse_history()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.paste"><code class="docutils literal notranslate"><span class="pre">FitsData.paste()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.record_new_data"><code class="docutils literal notranslate"><span class="pre">FitsData.record_new_data()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.resample_from"><code class="docutils literal notranslate"><span class="pre">FitsData.resample_from()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.scale"><code class="docutils literal notranslate"><span class="pre">FitsData.scale()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.set_data"><code class="docutils literal notranslate"><span class="pre">FitsData.set_data()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.set_data_shape"><code class="docutils literal notranslate"><span class="pre">FitsData.set_data_shape()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.set_default_unit"><code class="docutils literal notranslate"><span class="pre">FitsData.set_default_unit()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.set_executor"><code class="docutils literal notranslate"><span class="pre">FitsData.set_executor()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.set_history"><code class="docutils literal notranslate"><span class="pre">FitsData.set_history()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.set_parallel"><code class="docutils literal notranslate"><span class="pre">FitsData.set_parallel()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.set_unit"><code class="docutils literal notranslate"><span class="pre">FitsData.set_unit()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.smooth"><code class="docutils literal notranslate"><span class="pre">FitsData.smooth()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.unit_to_quantity"><code class="docutils literal notranslate"><span class="pre">FitsData.unit_to_quantity()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.validate"><code class="docutils literal notranslate"><span class="pre">FitsData.validate()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.maps.fits_data.FitsData.value_at"><code class="docutils literal notranslate"><span class="pre">FitsData.value_at()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/sofia_redux.scan.source_models.maps.fits_data.FitsData.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2024, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.2.6. &nbsp;
    Last built 05 Feb 2024. <br/>
  </p>
</footer>
  </body>
</html>