<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>get_source_signal &#8212; sofia_redux v1.3.4.dev38+g92ea2f4</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=6aa39468"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="icon" href="../_static/redux.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="AstroData2D" href="sofia_redux.scan.source_models.astro_data_2d.AstroData2D.html" />
    <link rel="prev" title="add_skydip_frames" href="sofia_redux.scan.source_models.source_numba_functions.add_skydip_frames.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://irsa.ipac.caltech.edu/Missions/sofia.html"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="sofia_redux.scan.source_models.astro_data_2d.AstroData2D.html" title="AstroData2D">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="sofia_redux.scan.source_models.source_numba_functions.add_skydip_frames.html" title="add_skydip_frames">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">sofia_redux v1.3.4.dev38+g92ea2f4</a>
	 &#187;
      </li>
      <li><a href="../sofia_redux/index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../sofia_redux/scan/index.html" accesskey="U">sofia_redux.scan: Scan Mode Algorithms for SOFIA Pipelines</a> &#187;</li>
      
      <li>get_source_signal</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="get-source-signal">
<h1>get_source_signal<a class="headerlink" href="#get-source-signal" title="Link to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.source_numba_functions.get_source_signal">
<span class="sig-prename descclassname"><span class="pre">sofia_redux.scan.source_models.source_numba_functions.</span></span><span class="sig-name descname"><span class="pre">get_source_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_valid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_gains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_flags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_valid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sync_gains</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/source_numba_functions.html#get_source_signal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.source_numba_functions.get_source_signal" title="Link to this definition">¶</a></dt>
<dd><p>Remove map source gains from frame data and flag samples.</p>
<p>For a given sample at frame i and channel j, frame data d_{i,j} will be
decremented by dg where:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>dg = fg * ( (gain(source) * map[index]) - (gain(sync) * base[index]) )
</pre></div>
</div>
<p>Here, fg is the frame gain and index is the index on the map of sample
(i,j).</p>
<p>Any masked map value will result in matching samples being flagged.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>frame_data</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The frame data of shape (n_frames, all_channels).  Data will be updated
in-place.</p>
</dd>
<dt><strong>frame_valid</strong><span class="classifier">numpy.ndarray (bool)</span></dt><dd><p>A boolean mask of shape (n_frames,) where <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a> excludes a frame from
all processing.</p>
</dd>
<dt><strong>frame_gains</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>An array of frame gains of shape (n_frames,).</p>
</dd>
<dt><strong>frame_weights</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The frame weights of shape (n_frames,).</p>
</dd>
<dt><strong>channel_flags</strong><span class="classifier">numpy.ndarray (int)</span></dt><dd><p>The channel flags of shape (n_channels,).  Any nonzero value will</p>
</dd>
<dt><strong>channel_variance</strong><span class="classifier">numpy.ndarray (int)</span></dt><dd><p>The channel variance of shape (n_channels,).</p>
</dd>
<dt><strong>map_values</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The current map supplied as a regular grid of arbitrary shape and
dimensions (image_shape,).</p>
</dd>
<dt><strong>map_valid</strong><span class="classifier">numpy.ndarray (bool)</span></dt><dd><p>A boolean mask of shape (image_shape,) where <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a> excludes a map
element from synchronization.</p>
</dd>
<dt><strong>map_indices</strong><span class="classifier">numpy.ndarray (int)</span></dt><dd><p>The sample map indices of shape (n_dimensions, n_frames, all_channels)
where dimensions are ordered in (x,y) FITS format.  These contain map
(pixel) indices for each sample.  For pixel maps, all pixels will
have zero position values, so the array should be of shape
(n_dimensions, n_frames, 1) in this case.</p>
</dd>
<dt><strong>sync_gains</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The prior channel source gains of shape (all_channels,).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>source_signal, source_error</strong><span class="classifier">numpy.ndarray, numpy.ndarray</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">get_source_signal</a><ul>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.source_numba_functions.get_source_signal"><code class="docutils literal notranslate"><span class="pre">get_source_signal()</span></code></a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/sofia_redux.scan.source_models.source_numba_functions.get_source_signal.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2024, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.2.6. &nbsp;
    Last built 05 Feb 2024. <br/>
  </p>
</footer>
  </body>
</html>