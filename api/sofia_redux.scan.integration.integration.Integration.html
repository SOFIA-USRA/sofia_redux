<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Integration &#8212; sofia_redux v1.3.4.dev38+g92ea2f4</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=6aa39468"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="icon" href="../_static/redux.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Dependents" href="sofia_redux.scan.integration.dependents.dependents.Dependents.html" />
    <link rel="prev" title="Info" href="sofia_redux.scan.info.info.Info.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://irsa.ipac.caltech.edu/Missions/sofia.html"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="sofia_redux.scan.integration.dependents.dependents.Dependents.html" title="Dependents">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="sofia_redux.scan.info.info.Info.html" title="Info">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">sofia_redux v1.3.4.dev38+g92ea2f4</a>
	 &#187;
      </li>
      <li><a href="../sofia_redux/index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../manuals/hawc/developers/developers.html" accesskey="U">HAWC+ DRP Developer’s Manual</a> &#187;</li>
      
      <li>Integration</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="integration">
<h1>Integration<a class="headerlink" href="#integration" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sofia_redux.scan.integration.integration.</span></span><span class="sig-name descname"><span class="pre">Integration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<p>Initialize a scan integration.</p>
<p>An integration is used to represent a chunk of timestream data from
a given scan (frames).  A valid scan must contain one or more
integrations.  The integration class provides methods to operate on the
frame data for various reduction tasks, and also provides a link
between the timestream data, and the instrument channels.  Each
frame/channel combination is referred to as a sample.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>scan</strong><span class="classifier">sofia_scan.scan.scan.scan.Scan</span></dt><dd><p>The scan to which the integration belongs.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Attributes Summary</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.channel_flagspace" title="sofia_redux.scan.integration.integration.Integration.channel_flagspace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">channel_flagspace</span></code></a></p></td>
<td><p>Return the channel flagspace.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.configuration" title="sofia_redux.scan.integration.integration.Integration.configuration"><code class="xref py py-obj docutils literal notranslate"><span class="pre">configuration</span></code></a></p></td>
<td><p>Return the integration configuration (from channel configuration).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.flagspace" title="sofia_redux.scan.integration.integration.Integration.flagspace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">flagspace</span></code></a></p></td>
<td><p>Return the frame flagspace.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.info" title="sofia_redux.scan.integration.integration.Integration.info"><code class="xref py py-obj docutils literal notranslate"><span class="pre">info</span></code></a></p></td>
<td><p>Return the Info object for the integration.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.instrument_name" title="sofia_redux.scan.integration.integration.Integration.instrument_name"><code class="xref py py-obj docutils literal notranslate"><span class="pre">instrument_name</span></code></a></p></td>
<td><p>Return the instrument name.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.motion_flagspace" title="sofia_redux.scan.integration.integration.Integration.motion_flagspace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">motion_flagspace</span></code></a></p></td>
<td><p>Return the motion flagspace.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.n_channels" title="sofia_redux.scan.integration.integration.Integration.n_channels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_channels</span></code></a></p></td>
<td><p>Return the number of channels in the integration.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.reference_attributes" title="sofia_redux.scan.integration.integration.Integration.reference_attributes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reference_attributes</span></code></a></p></td>
<td><p>Return attributes that should be referenced rather than copied.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.scan_astrometry" title="sofia_redux.scan.integration.integration.Integration.scan_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scan_astrometry</span></code></a></p></td>
<td><p>Return the scan astrometry.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.size" title="sofia_redux.scan.integration.integration.Integration.size"><code class="xref py py-obj docutils literal notranslate"><span class="pre">size</span></code></a></p></td>
<td><p>Return the number of frames in the integration.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods Summary</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.acceleration_clip" title="sofia_redux.scan.integration.integration.Integration.acceleration_clip"><code class="xref py py-obj docutils literal notranslate"><span class="pre">acceleration_clip</span></code></a>([max_acceleration])</p></td>
<td><p>Invalidate frames with excessive acceleration.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.acceleration_cut" title="sofia_redux.scan.integration.integration.Integration.acceleration_cut"><code class="xref py py-obj docutils literal notranslate"><span class="pre">acceleration_cut</span></code></a>(max_acceleration)</p></td>
<td><p>Invalidate frames with excessive acceleration.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.add_dependents" title="sofia_redux.scan.integration.integration.Integration.add_dependents"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_dependents</span></code></a>(dependents)</p></td>
<td><p>Add dependents to the integration.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.add_details" title="sofia_redux.scan.integration.integration.Integration.add_details"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_details</span></code></a>([table])</p></td>
<td><p>Add integration details to an astropy table.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.add_signal" title="sofia_redux.scan.integration.integration.Integration.add_signal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_signal</span></code></a>(signal)</p></td>
<td><p>Add a signal to the integration signals.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.apply_configuration" title="sofia_redux.scan.integration.integration.Integration.apply_configuration"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_configuration</span></code></a>()</p></td>
<td><p>Apply configuration options to an integration.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.apply_notch_filter" title="sofia_redux.scan.integration.integration.Integration.apply_notch_filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_notch_filter</span></code></a>(frequencies, width)</p></td>
<td><p>Apply notch filtering to frame data for given frequencies and width.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.bootstrap_weights" title="sofia_redux.scan.integration.integration.Integration.bootstrap_weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bootstrap_weights</span></code></a>()</p></td>
<td><p>Calculates channel weights from frame data if required.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.calculate_scan_speed_stats" title="sofia_redux.scan.integration.integration.Integration.calculate_scan_speed_stats"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_scan_speed_stats</span></code></a>()</p></td>
<td><p>Calculates and reports statistics on the scanning speed.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.calculate_source_nefd" title="sofia_redux.scan.integration.integration.Integration.calculate_source_nefd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_source_nefd</span></code></a>()</p></td>
<td><p>Set the source Noise-Equivalent-Flux-Density (NEFD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.check_consistency" title="sofia_redux.scan.integration.integration.Integration.check_consistency"><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_consistency</span></code></a>(channels, frame_dependents)</p></td>
<td><p>Check consistency of frame dependents and channels.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.check_range" title="sofia_redux.scan.integration.integration.Integration.check_range"><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_range</span></code></a>()</p></td>
<td><p>Checks the range of frame data values, flagging as necessary.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.clone" title="sofia_redux.scan.integration.integration.Integration.clone"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clone</span></code></a>()</p></td>
<td><p>Return a copy of the integration without frame type data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.condense_covariance" title="sofia_redux.scan.integration.integration.Integration.condense_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">condense_covariance</span></code></a>(covariance)</p></td>
<td><p>Strips a covariance matrix of all zero and NaN column/row pairs.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.copy" title="sofia_redux.scan.integration.integration.Integration.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a>()</p></td>
<td><p>Return a new copy of the integration.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.decorrelate" title="sofia_redux.scan.integration.integration.Integration.decorrelate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">decorrelate</span></code></a>(modality_name[, robust])</p></td>
<td><p>Decorrelate a modality.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.decorrelate_signals" title="sofia_redux.scan.integration.integration.Integration.decorrelate_signals"><code class="xref py py-obj docutils literal notranslate"><span class="pre">decorrelate_signals</span></code></a>(modality_name[, robust])</p></td>
<td><p>Decorrelate a modality signal.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.dejump_frames" title="sofia_redux.scan.integration.integration.Integration.dejump_frames"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dejump_frames</span></code></a>()</p></td>
<td><p>Remove jumps in the frame data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.despike" title="sofia_redux.scan.integration.integration.Integration.despike"><code class="xref py py-obj docutils literal notranslate"><span class="pre">despike</span></code></a>([level])</p></td>
<td><p>Despike frame data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.despike_absolute" title="sofia_redux.scan.integration.integration.Integration.despike_absolute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">despike_absolute</span></code></a>(level)</p></td>
<td><p>Identifies and flags spikes in frame data using absolute method.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.despike_gradual" title="sofia_redux.scan.integration.integration.Integration.despike_gradual"><code class="xref py py-obj docutils literal notranslate"><span class="pre">despike_gradual</span></code></a>(level[, depth])</p></td>
<td><p>Identifies and flags spikes in frame data using gradual method.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.despike_multi_resolution" title="sofia_redux.scan.integration.integration.Integration.despike_multi_resolution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">despike_multi_resolution</span></code></a>(level)</p></td>
<td><p>Identifies and flag spikes in frame data using multi-resolution.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.despike_neighbouring" title="sofia_redux.scan.integration.integration.Integration.despike_neighbouring"><code class="xref py py-obj docutils literal notranslate"><span class="pre">despike_neighbouring</span></code></a>(level, delta)</p></td>
<td><p>Identifies and flags spikes in frame data using neighbours method.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.detector_stage" title="sofia_redux.scan.integration.integration.Integration.detector_stage"><code class="xref py py-obj docutils literal notranslate"><span class="pre">detector_stage</span></code></a>()</p></td>
<td><p>Divide the frame data by the channel hardware gains.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.downsample" title="sofia_redux.scan.integration.integration.Integration.downsample"><code class="xref py py-obj docutils literal notranslate"><span class="pre">downsample</span></code></a>([factor])</p></td>
<td><p>Downsample frame data by a given, or derived factor.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.downsampling_window" title="sofia_redux.scan.integration.integration.Integration.downsampling_window"><code class="xref py py-obj docutils literal notranslate"><span class="pre">downsampling_window</span></code></a>(factor)</p></td>
<td><p>Create a normalized Hann window and the new indices.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.fill_gaps" title="sofia_redux.scan.integration.integration.Integration.fill_gaps"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fill_gaps</span></code></a>()</p></td>
<td><p>Add invalid frames in cases where there are timestream gaps.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.filter_frames_for" title="sofia_redux.scan.integration.integration.Integration.filter_frames_for"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_frames_for</span></code></a>([spec, default_time])</p></td>
<td><p>Return the number of filtering frames for a given specification.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.flag_spiky_blocks" title="sofia_redux.scan.integration.integration.Integration.flag_spiky_blocks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">flag_spiky_blocks</span></code></a>()</p></td>
<td><p>Flag all frames in a block if one or more frames is flagged as spiky.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.flag_spiky_channels" title="sofia_redux.scan.integration.integration.Integration.flag_spiky_channels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">flag_spiky_channels</span></code></a>([flag_fraction, flag_count])</p></td>
<td><p>Flag channels with excessive spiky frames as SPIKY.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.flag_spiky_frames" title="sofia_redux.scan.integration.integration.Integration.flag_spiky_frames"><code class="xref py py-obj docutils literal notranslate"><span class="pre">flag_spiky_frames</span></code></a>([frame_spikes])</p></td>
<td><p>Flag frames with excessive spiky channels as FLAG_SPIKY.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.flag_weights" title="sofia_redux.scan.integration.integration.Integration.flag_weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">flag_weights</span></code></a>()</p></td>
<td><p>Check if channel weights should be flagged and update source NEFD.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.frames_for" title="sofia_redux.scan.integration.integration.Integration.frames_for"><code class="xref py py-obj docutils literal notranslate"><span class="pre">frames_for</span></code></a>([time])</p></td>
<td><p>Return the number of frames for a given time interval.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_acceleration_signal" title="sofia_redux.scan.integration.integration.Integration.get_acceleration_signal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_acceleration_signal</span></code></a>(direction[, mode])</p></td>
<td><p>Return an acceleration signal.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_accelerations" title="sofia_redux.scan.integration.integration.Integration.get_accelerations"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_accelerations</span></code></a>()</p></td>
<td><p>Return the telescope accelerations.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_ascii_header" title="sofia_redux.scan.integration.integration.Integration.get_ascii_header"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_ascii_header</span></code></a>()</p></td>
<td><p>Return a string header for output text files.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_channel_weights" title="sofia_redux.scan.integration.integration.Integration.get_channel_weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_channel_weights</span></code></a>([method])</p></td>
<td><p>Derive and set channel weights.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_correlated_signal_class" title="sofia_redux.scan.integration.integration.Integration.get_correlated_signal_class"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_correlated_signal_class</span></code></a>()</p></td>
<td><p>Return the correlated signal class.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_coupling_gains" title="sofia_redux.scan.integration.integration.Integration.get_coupling_gains"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_coupling_gains</span></code></a>(signal)</p></td>
<td><p>Return the coupling gains for a given channel.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_covariance" title="sofia_redux.scan.integration.integration.Integration.get_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_covariance</span></code></a>()</p></td>
<td><p>Return the channel covariance.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_crossing_time" title="sofia_redux.scan.integration.integration.Integration.get_crossing_time"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_crossing_time</span></code></a>([source_size])</p></td>
<td><p>Return the crossing time for a given source size.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_default_scaling_factor" title="sofia_redux.scan.integration.integration.Integration.get_default_scaling_factor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_default_scaling_factor</span></code></a>()</p></td>
<td><p>Return the default scaling factor from the configuration.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_dependents" title="sofia_redux.scan.integration.integration.Integration.get_dependents"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_dependents</span></code></a>(name)</p></td>
<td><p>Return or create and return dependents of the given name.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_differential_channel_weights" title="sofia_redux.scan.integration.integration.Integration.get_differential_channel_weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_differential_channel_weights</span></code></a>()</p></td>
<td><p>Derive and set differentially derived weights for live channels.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_display_id" title="sofia_redux.scan.integration.integration.Integration.get_display_id"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_display_id</span></code></a>()</p></td>
<td><p>Get the display integration ID.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_downsample_factor" title="sofia_redux.scan.integration.integration.Integration.get_downsample_factor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_downsample_factor</span></code></a>()</p></td>
<td><p>Return the factor by which to downsample frames.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_duration" title="sofia_redux.scan.integration.integration.Integration.get_duration"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_duration</span></code></a>()</p></td>
<td><p>Return the total integration duration.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_exposure_time" title="sofia_redux.scan.integration.integration.Integration.get_exposure_time"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_exposure_time</span></code></a>()</p></td>
<td><p>Return the total exposure time.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_file_id" title="sofia_redux.scan.integration.integration.Integration.get_file_id"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_file_id</span></code></a>()</p></td>
<td><p>Get the file integration ID.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_filter" title="sofia_redux.scan.integration.integration.Integration.get_filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_filter</span></code></a>(filter_name)</p></td>
<td><p>Return a filter of the given name.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_first_frame" title="sofia_redux.scan.integration.integration.Integration.get_first_frame"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_first_frame</span></code></a>([reference])</p></td>
<td><p>Return the first valid frame.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_first_frame_index" title="sofia_redux.scan.integration.integration.Integration.get_first_frame_index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_first_frame_index</span></code></a>([reference])</p></td>
<td><p>Return the first valid frame index of the integration.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_fits_data" title="sofia_redux.scan.integration.integration.Integration.get_fits_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_fits_data</span></code></a>()</p></td>
<td><p>Return integration data as an astropy table.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_floats" title="sofia_redux.scan.integration.integration.Integration.get_floats"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_floats</span></code></a>()</p></td>
<td><p>Return a float array suitable for FFT.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_frame_count" title="sofia_redux.scan.integration.integration.Integration.get_frame_count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_frame_count</span></code></a>([keep_flag, discard_flag, ...])</p></td>
<td><p>Return the number of frames in an integration.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_frame_gaps" title="sofia_redux.scan.integration.integration.Integration.get_frame_gaps"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_frame_gaps</span></code></a>()</p></td>
<td><p>Return the gaps between frames.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_full_covariance" title="sofia_redux.scan.integration.integration.Integration.get_full_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_full_covariance</span></code></a>(covariance)</p></td>
<td><p>Return the full covariance array for all initial channels.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_full_id" title="sofia_redux.scan.integration.integration.Integration.get_full_id"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_full_id</span></code></a>([separator])</p></td>
<td><p>Return the full integration ID.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_group_covariance" title="sofia_redux.scan.integration.integration.Integration.get_group_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_group_covariance</span></code></a>(division, covariance)</p></td>
<td><p>Return the covariance for all groups in a channel division.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_id" title="sofia_redux.scan.integration.integration.Integration.get_id"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_id</span></code></a>()</p></td>
<td><p>Return the simple integration ID.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_integration_class" title="sofia_redux.scan.integration.integration.Integration.get_integration_class"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_integration_class</span></code></a>(name)</p></td>
<td><p>Return an Integration instance given an instrument name.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_last_frame" title="sofia_redux.scan.integration.integration.Integration.get_last_frame"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_last_frame</span></code></a>([reference])</p></td>
<td><p>Return the first valid frame.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_last_frame_index" title="sofia_redux.scan.integration.integration.Integration.get_last_frame_index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_last_frame_index</span></code></a>([reference])</p></td>
<td><p>Return the last valid frame index of the integration.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_mean_level" title="sofia_redux.scan.integration.integration.Integration.get_mean_level"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_mean_level</span></code></a>([channels, start, end, robust])</p></td>
<td><p>Return the median data values and associated weights for channels.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_mjd" title="sofia_redux.scan.integration.integration.Integration.get_mjd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_mjd</span></code></a>()</p></td>
<td><p>Return the midpoint MJD of the integration.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_modulation_frequency" title="sofia_redux.scan.integration.integration.Integration.get_modulation_frequency"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_modulation_frequency</span></code></a>(signal_flag)</p></td>
<td><p>Return the modulation frequency.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_pa" title="sofia_redux.scan.integration.integration.Integration.get_pa"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_pa</span></code></a>()</p></td>
<td><p>Return the position angle of the integration.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_point_crossing_time" title="sofia_redux.scan.integration.integration.Integration.get_point_crossing_time"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_point_crossing_time</span></code></a>()</p></td>
<td><p>Return the time required to cross the point size of the scan.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_position_signal" title="sofia_redux.scan.integration.integration.Integration.get_position_signal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_position_signal</span></code></a>(motion_flag, direction)</p></td>
<td><p>Return a position signal.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_positions" title="sofia_redux.scan.integration.integration.Integration.get_positions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_positions</span></code></a>(motion_flag)</p></td>
<td><p>Return positions based on a type of motion.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_rms_channel_weights" title="sofia_redux.scan.integration.integration.Integration.get_rms_channel_weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_rms_channel_weights</span></code></a>()</p></td>
<td><p>Derive and set channel weights for live channels based on data values.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_robust_channel_weights" title="sofia_redux.scan.integration.integration.Integration.get_robust_channel_weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_robust_channel_weights</span></code></a>()</p></td>
<td><p>Derive and set robustly derived channel weights for live channels.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_scanning_velocities" title="sofia_redux.scan.integration.integration.Integration.get_scanning_velocities"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_scanning_velocities</span></code></a>([return_position])</p></td>
<td><p>Return the scanning velocity (including chopping motion).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_signal" title="sofia_redux.scan.integration.integration.Integration.get_signal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_signal</span></code></a>(mode)</p></td>
<td><p>Return the signal for a given mode.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_smooth_positions" title="sofia_redux.scan.integration.integration.Integration.get_smooth_positions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_smooth_positions</span></code></a>(motion_flag)</p></td>
<td><p>Return the positions, smoothed according to the configuration.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_spectra" title="sofia_redux.scan.integration.integration.Integration.get_spectra"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_spectra</span></code></a>([window_function, window_size])</p></td>
<td><p>Return the power spectrum of the data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_speed_clip_range" title="sofia_redux.scan.integration.integration.Integration.get_speed_clip_range"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_speed_clip_range</span></code></a>()</p></td>
<td><p>Determine the range of permissible scanning speeds.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_standard_id" title="sofia_redux.scan.integration.integration.Integration.get_standard_id"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_standard_id</span></code></a>([separator])</p></td>
<td><p>Get the standard integration ID.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_table_entry" title="sofia_redux.scan.integration.integration.Integration.get_table_entry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_table_entry</span></code></a>(name)</p></td>
<td><p>Return a parameter value for the given name.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_tau" title="sofia_redux.scan.integration.integration.Integration.get_tau"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_tau</span></code></a>(spec[, value])</p></td>
<td><p>Get the tau value based on configuration settings.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_tau_coefficients" title="sofia_redux.scan.integration.integration.Integration.get_tau_coefficients"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_tau_coefficients</span></code></a>(spec)</p></td>
<td><p>Return the tau coefficients for the tau specification.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_thread_count" title="sofia_redux.scan.integration.integration.Integration.get_thread_count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_thread_count</span></code></a>()</p></td>
<td><p>Return the number of parallel tasks for the integration.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_time_stream" title="sofia_redux.scan.integration.integration.Integration.get_time_stream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_time_stream</span></code></a>([channels, weighted])</p></td>
<td><p>Return the time stream data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_time_weights" title="sofia_redux.scan.integration.integration.Integration.get_time_weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_time_weights</span></code></a>([channels, block_size, flag])</p></td>
<td><p>Derive and set frame weights.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_typical_scanning_speed" title="sofia_redux.scan.integration.integration.Integration.get_typical_scanning_speed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_typical_scanning_speed</span></code></a>()</p></td>
<td><p>Get the mean (robust) scanning speed and weight (inverse variance).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_velocities" title="sofia_redux.scan.integration.integration.Integration.get_velocities"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_velocities</span></code></a>(motion_flag[, return_position])</p></td>
<td><p>Return the scanning velocity (including chopping motion).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.has_gaps" title="sofia_redux.scan.integration.integration.Integration.has_gaps"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_gaps</span></code></a>([tolerance])</p></td>
<td><p>Check if there are gaps in the time stream data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.has_option" title="sofia_redux.scan.integration.integration.Integration.has_option"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_option</span></code></a>(option)</p></td>
<td><p>Return whether the configuration option is configured.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.jackknife" title="sofia_redux.scan.integration.integration.Integration.jackknife"><code class="xref py py-obj docutils literal notranslate"><span class="pre">jackknife</span></code></a>()</p></td>
<td><p>Randomly invert integration and channel gains.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.level" title="sofia_redux.scan.integration.integration.Integration.level"><code class="xref py py-obj docutils literal notranslate"><span class="pre">level</span></code></a>([channel_means, channel_weights, ...])</p></td>
<td><p>Remove the mean frame data from each channel and update dependents.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.local_level" title="sofia_redux.scan.integration.integration.Integration.local_level"><code class="xref py py-obj docutils literal notranslate"><span class="pre">local_level</span></code></a>(parms[, start, end, robust])</p></td>
<td><p>Level frame data between in a certain frame range.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.merge" title="sofia_redux.scan.integration.integration.Integration.merge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">merge</span></code></a>(integration)</p></td>
<td><p>Merge frames from another integration onto this integration.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.next_iteration" title="sofia_redux.scan.integration.integration.Integration.next_iteration"><code class="xref py py-obj docutils literal notranslate"><span class="pre">next_iteration</span></code></a>()</p></td>
<td><p>Perform certain steps prior to an iteration.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.next_weight_transit" title="sofia_redux.scan.integration.integration.Integration.next_weight_transit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">next_weight_transit</span></code></a>(level[, start, above])</p></td>
<td><p>Find the next frame index with relative weight above or below a level.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.notch_filter" title="sofia_redux.scan.integration.integration.Integration.notch_filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">notch_filter</span></code></a>()</p></td>
<td><p>Apply notch filtering based on configuration options.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.offset" title="sofia_redux.scan.integration.integration.Integration.offset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">offset</span></code></a>(value)</p></td>
<td><p>Add an offset value to frame data for all unflagged channels.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.perform" title="sofia_redux.scan.integration.integration.Integration.perform"><code class="xref py py-obj docutils literal notranslate"><span class="pre">perform</span></code></a>(task)</p></td>
<td><p>Perform a reduction task on the integration.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.pointing_at" title="sofia_redux.scan.integration.integration.Integration.pointing_at"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pointing_at</span></code></a>(offset[, indices])</p></td>
<td><p>Applies pointing correction to coordinates via subtraction.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.power2_frames_for" title="sofia_redux.scan.integration.integration.Integration.power2_frames_for"><code class="xref py py-obj docutils literal notranslate"><span class="pre">power2_frames_for</span></code></a>([time])</p></td>
<td><p>Return the number of frames for a given time interval using pow2ceil.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.process_notch_filter_block" title="sofia_redux.scan.integration.integration.Integration.process_notch_filter_block"><code class="xref py py-obj docutils literal notranslate"><span class="pre">process_notch_filter_block</span></code></a>(start, end, ...)</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.readout_stage" title="sofia_redux.scan.integration.integration.Integration.readout_stage"><code class="xref py py-obj docutils literal notranslate"><span class="pre">readout_stage</span></code></a>()</p></td>
<td><p>Multiply the frame data by the channel hardware gains.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.reindex" title="sofia_redux.scan.integration.integration.Integration.reindex"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reindex</span></code></a>()</p></td>
<td><p>Reset the frame fixed indices to range sequentially from 0 -&gt; size.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.reindex_channels" title="sofia_redux.scan.integration.integration.Integration.reindex_channels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reindex_channels</span></code></a>()</p></td>
<td><p>Reindex the channels such that all data are self-consistent.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.reindex_frames" title="sofia_redux.scan.integration.integration.Integration.reindex_frames"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reindex_frames</span></code></a>()</p></td>
<td><p>Reindex the time dependent data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.remove_channel_drifts" title="sofia_redux.scan.integration.integration.Integration.remove_channel_drifts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove_channel_drifts</span></code></a>(channel_group, parms, ...)</p></td>
<td><p>Remove drifts from channels.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.remove_dc_offsets" title="sofia_redux.scan.integration.integration.Integration.remove_dc_offsets"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove_dc_offsets</span></code></a>()</p></td>
<td><p>Remove the DC offsets, either if explicitly requested or to allow bootstrapping pixel weights when pixeldata is not defined.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.remove_drifts" title="sofia_redux.scan.integration.integration.Integration.remove_drifts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove_drifts</span></code></a>([target_frame_resolution, robust])</p></td>
<td><p>Remove drifts in frame data given a target frame resolution.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.remove_offsets" title="sofia_redux.scan.integration.integration.Integration.remove_offsets"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove_offsets</span></code></a>([robust])</p></td>
<td><p>Remove the DC offsets from the frame data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.scale" title="sofia_redux.scan.integration.integration.Integration.scale"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scale</span></code></a>(factor)</p></td>
<td><p>Scale all data (in <code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code>) by <code class="xref py py-obj docutils literal notranslate"><span class="pre">factor</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.search_corners" title="sofia_redux.scan.integration.integration.Integration.search_corners"><code class="xref py py-obj docutils literal notranslate"><span class="pre">search_corners</span></code></a>(perimeter_pixels, projection)</p></td>
<td><p>Find the corners of the mapping range of the integration.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.select_frames" title="sofia_redux.scan.integration.integration.Integration.select_frames"><code class="xref py py-obj docutils literal notranslate"><span class="pre">select_frames</span></code></a>()</p></td>
<td><p>Delete frames not inside the frame range defined in the configuration.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.set_iteration" title="sofia_redux.scan.integration.integration.Integration.set_iteration"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_iteration</span></code></a>(iteration[, rounds])</p></td>
<td><p>Set the configuration for a given iteration</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.set_scaling" title="sofia_redux.scan.integration.integration.Integration.set_scaling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_scaling</span></code></a>([factor])</p></td>
<td><p>Set the gain scaling for the integration.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.set_scan" title="sofia_redux.scan.integration.integration.Integration.set_scan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_scan</span></code></a>(scan)</p></td>
<td><p>Set the parent scan of the integration.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.set_tau" title="sofia_redux.scan.integration.integration.Integration.set_tau"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_tau</span></code></a>([spec, value])</p></td>
<td><p>Set the tau values for the integration.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.set_tau_value" title="sofia_redux.scan.integration.integration.Integration.set_tau_value"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_tau_value</span></code></a>(value)</p></td>
<td><p>Set the zenith tau if ground based, or the transmission.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.set_temp_despike_levels" title="sofia_redux.scan.integration.integration.Integration.set_temp_despike_levels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_temp_despike_levels</span></code></a>(channel_data, level)</p></td>
<td><p>Set a temporary despiking level reference in the channel data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.set_thread_count" title="sofia_redux.scan.integration.integration.Integration.set_thread_count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_thread_count</span></code></a>(threads)</p></td>
<td><p>Set the number of parallel tasks for the integration.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.set_weights_from_var_stats" title="sofia_redux.scan.integration.integration.Integration.set_weights_from_var_stats"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_weights_from_var_stats</span></code></a>(channel_group, ...)</p></td>
<td><p>Set channel weights from the calculated variance.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.set_zenith_tau" title="sofia_redux.scan.integration.integration.Integration.set_zenith_tau"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_zenith_tau</span></code></a>(tau_value)</p></td>
<td><p>Set the zenith tau value.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.setup_filters" title="sofia_redux.scan.integration.integration.Integration.setup_filters"><code class="xref py py-obj docutils literal notranslate"><span class="pre">setup_filters</span></code></a>()</p></td>
<td><p>Set up the FFT frame data filters.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.shift_frames" title="sofia_redux.scan.integration.integration.Integration.shift_frames"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shift_frames</span></code></a>(time_or_frames)</p></td>
<td><p>Shift the frame data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.slim" title="sofia_redux.scan.integration.integration.Integration.slim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">slim</span></code></a>()</p></td>
<td><p>Slim frame/channel type data to those channels still present.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.trim" title="sofia_redux.scan.integration.integration.Integration.trim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trim</span></code></a>([start, end])</p></td>
<td><p>Remove invalid frames from the start and end of the integration.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.update_gains" title="sofia_redux.scan.integration.integration.Integration.update_gains"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_gains</span></code></a>(modality_name[, robust])</p></td>
<td><p>Update gains in a modality following decorrelation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.update_inconsistencies" title="sofia_redux.scan.integration.integration.Integration.update_inconsistencies"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_inconsistencies</span></code></a>(channels, ...)</p></td>
<td><p>Check consistency of frame dependents and channels.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.validate" title="sofia_redux.scan.integration.integration.Integration.validate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">validate</span></code></a>()</p></td>
<td><p>Validate an integration following the initial read.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.velocity_clip" title="sofia_redux.scan.integration.integration.Integration.velocity_clip"><code class="xref py py-obj docutils literal notranslate"><span class="pre">velocity_clip</span></code></a>([speed_range, strict, sigma_clip])</p></td>
<td><p>Clip frames that are outside of the permissible scanning speed range.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.write_ascii_time_stream" title="sofia_redux.scan.integration.integration.Integration.write_ascii_time_stream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_ascii_time_stream</span></code></a>([filename])</p></td>
<td><p>Write the frame data to a text file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.write_coupling_gains" title="sofia_redux.scan.integration.integration.Integration.write_coupling_gains"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_coupling_gains</span></code></a>(signal_names)</p></td>
<td><p>Write the coupling gains to file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.write_covariance_to_file" title="sofia_redux.scan.integration.integration.Integration.write_covariance_to_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_covariance_to_file</span></code></a>(filename, covariance)</p></td>
<td><p>Write a covariance matrix to file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.write_covariances" title="sofia_redux.scan.integration.integration.Integration.write_covariances"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_covariances</span></code></a>()</p></td>
<td><p>Write the covariances to file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.write_products" title="sofia_redux.scan.integration.integration.Integration.write_products"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_products</span></code></a>()</p></td>
<td><p>Write the integration products to an output file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.write_scan_pattern" title="sofia_redux.scan.integration.integration.Integration.write_scan_pattern"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_scan_pattern</span></code></a>([filename])</p></td>
<td><p>Write the scan pattern to file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.write_spectra" title="sofia_redux.scan.integration.integration.Integration.write_spectra"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_spectra</span></code></a>([window_name, window_size])</p></td>
<td><p>Write the spectra to file.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes Documentation</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.channel_flagspace">
<span class="sig-name descname"><span class="pre">channel_flagspace</span></span><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.channel_flagspace" title="Link to this definition">¶</a></dt>
<dd><p>Return the channel flagspace.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ChannelFlags</strong><span class="classifier">class</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.configuration">
<span class="sig-name descname"><span class="pre">configuration</span></span><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.configuration" title="Link to this definition">¶</a></dt>
<dd><p>Return the integration configuration (from channel configuration).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Configuration</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.flagspace">
<span class="sig-name descname"><span class="pre">flagspace</span></span><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.flagspace" title="Link to this definition">¶</a></dt>
<dd><p>Return the frame flagspace.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>FrameFlags</strong><span class="classifier">class</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.info">
<span class="sig-name descname"><span class="pre">info</span></span><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.info" title="Link to this definition">¶</a></dt>
<dd><p>Return the Info object for the integration.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Info</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.instrument_name">
<span class="sig-name descname"><span class="pre">instrument_name</span></span><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.instrument_name" title="Link to this definition">¶</a></dt>
<dd><p>Return the instrument name.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>str</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.motion_flagspace">
<span class="sig-name descname"><span class="pre">motion_flagspace</span></span><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.motion_flagspace" title="Link to this definition">¶</a></dt>
<dd><p>Return the motion flagspace.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>MotionFlags</strong><span class="classifier">class</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.n_channels">
<span class="sig-name descname"><span class="pre">n_channels</span></span><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.n_channels" title="Link to this definition">¶</a></dt>
<dd><p>Return the number of channels in the integration.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>int</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.reference_attributes">
<span class="sig-name descname"><span class="pre">reference_attributes</span></span><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.reference_attributes" title="Link to this definition">¶</a></dt>
<dd><p>Return attributes that should be referenced rather than copied.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>set</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.scan_astrometry">
<span class="sig-name descname"><span class="pre">scan_astrometry</span></span><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.scan_astrometry" title="Link to this definition">¶</a></dt>
<dd><p>Return the scan astrometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>AstrometryInfo</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.size">
<span class="sig-name descname"><span class="pre">size</span></span><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.size" title="Link to this definition">¶</a></dt>
<dd><p>Return the number of frames in the integration.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>int</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<p class="rubric">Methods Documentation</p>
<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.acceleration_clip">
<span class="sig-name descname"><span class="pre">acceleration_clip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_acceleration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.acceleration_clip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.acceleration_clip" title="Link to this definition">¶</a></dt>
<dd><p>Invalidate frames with excessive acceleration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>max_acceleration</strong><span class="classifier">astropy.units.Quantity</span></dt><dd><p>The maximum allowable acceleration.  Should be in size/time/time
units.  If not supplied, is read from the ‘aclip’ configuration
option in units of arcseconds/second/second.  If neither value is
available, no acceleration clipping will occur.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.acceleration_cut">
<span class="sig-name descname"><span class="pre">acceleration_cut</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_acceleration</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.acceleration_cut"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.acceleration_cut" title="Link to this definition">¶</a></dt>
<dd><p>Invalidate frames with excessive acceleration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>max_acceleration</strong><span class="classifier">astropy.units.Quantity</span></dt><dd><p>The maximum allowable acceleration.  Should be in size/time/time
units.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.add_dependents">
<span class="sig-name descname"><span class="pre">add_dependents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dependents</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.add_dependents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.add_dependents" title="Link to this definition">¶</a></dt>
<dd><p>Add dependents to the integration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>dependents</strong><span class="classifier">Dependents</span></dt><dd><p>The dependents to add.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.add_details">
<span class="sig-name descname"><span class="pre">add_details</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.add_details"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.add_details" title="Link to this definition">¶</a></dt>
<dd><p>Add integration details to an astropy table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>table</strong><span class="classifier">astropy.table.Table, optional</span></dt><dd><p>If supplied, new columns will be added.  Otherwise, a new table
will be created.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Table</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.add_signal">
<span class="sig-name descname"><span class="pre">add_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.add_signal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.add_signal" title="Link to this definition">¶</a></dt>
<dd><p>Add a signal to the integration signals.</p>
<p>The integration signals is a dictionary of the form {mode: signal).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>signal</strong><span class="classifier">Signal</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.apply_configuration">
<span class="sig-name descname"><span class="pre">apply_configuration</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.apply_configuration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.apply_configuration" title="Link to this definition">¶</a></dt>
<dd><p>Apply configuration options to an integration.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.apply_notch_filter">
<span class="sig-name descname"><span class="pre">apply_notch_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frequencies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.apply_notch_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.apply_notch_filter" title="Link to this definition">¶</a></dt>
<dd><p>Apply notch filtering to frame data for given frequencies and width.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>frequencies</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The frequencies to filter.</p>
</dd>
<dt><strong>width</strong><span class="classifier">float</span></dt><dd><p>The width of the filter.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.bootstrap_weights">
<span class="sig-name descname"><span class="pre">bootstrap_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.bootstrap_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.bootstrap_weights" title="Link to this definition">¶</a></dt>
<dd><p>Calculates channel weights from frame data if required.</p>
<p>If weighting is required but were not extracted from the <code class="xref py py-obj docutils literal notranslate"><span class="pre">pixeldata</span></code>
configuration option, or set to ‘uniform’, will derive values using
the <a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_differential_channel_weights" title="sofia_redux.scan.integration.integration.Integration.get_differential_channel_weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_differential_channel_weights</span></code></a> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.calculate_scan_speed_stats">
<span class="sig-name descname"><span class="pre">calculate_scan_speed_stats</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.calculate_scan_speed_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.calculate_scan_speed_stats" title="Link to this definition">¶</a></dt>
<dd><p>Calculates and reports statistics on the scanning speed.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This should be run before and frame clipping/invalidation, since
smoothing positions (which is used prior to velocity calculations)
results in identical position values for frames near the edge of
a block of invalid frames.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.calculate_source_nefd">
<span class="sig-name descname"><span class="pre">calculate_source_nefd</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.calculate_source_nefd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.calculate_source_nefd" title="Link to this definition">¶</a></dt>
<dd><p>Set the source Noise-Equivalent-Flux-Density (NEFD).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.check_consistency">
<span class="sig-name descname"><span class="pre">check_consistency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_dependents</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.check_consistency"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.check_consistency" title="Link to this definition">¶</a></dt>
<dd><p>Check consistency of frame dependents and channels.</p>
<p>This is intended to be overridden for specific instruments
as needed.  The generic implementation just returns True.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>frame_dependents</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd></dd>
<dt><strong>channels</strong><span class="classifier">ChannelGroup</span></dt><dd></dd>
<dt><strong>start_frame</strong><span class="classifier">int, optional</span></dt><dd><p>The starting frame (inclusive).  Defaults to the first (0) frame.</p>
</dd>
<dt><strong>stop_frame</strong><span class="classifier">int, optional</span></dt><dd><p>The end frame (exclusive).  Defaults to the last (self.size) frame.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>consistent</strong><span class="classifier">numpy.ndarray (bool)</span></dt><dd><p>An array of size self.size where <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> indicates a consistent
frame.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.check_range">
<span class="sig-name descname"><span class="pre">check_range</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.check_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.check_range" title="Link to this definition">¶</a></dt>
<dd><p>Checks the range of frame data values, flagging as necessary.</p>
<p>In addition to flagging frames, channels may also be flagged as having
bad DAC ranges and dead if a certain fraction of frames for a given
channel is above a threshold.</p>
<p>The configuration must contain a “range” branch for range checking to
occur.  If a range value is assigned to “range”, it is explicitly used
to set the range of valid DAC values.  If not, only NaN values will
be flagged as out-of-range.  The “range.flagfraction” configuration
option is used to specify what fraction of frames flagged as
out-of-range for a channel is required to flag that channel as
bad.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.clone" title="Link to this definition">¶</a></dt>
<dd><p>Return a copy of the integration without frame type data.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Integration</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.condense_covariance">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">condense_covariance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">covariance</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.condense_covariance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.condense_covariance" title="Link to this definition">¶</a></dt>
<dd><p>Strips a covariance matrix of all zero and NaN column/row pairs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>covariance</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The covariance matrix of shape (n_channels, n_channels).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>condensed_covariance</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The condensed covariance matrix without zero or NaN values of shape
(n_valid, n_valid).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.copy" title="Link to this definition">¶</a></dt>
<dd><p>Return a new copy of the integration.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"></dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.decorrelate">
<span class="sig-name descname"><span class="pre">decorrelate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modality_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">robust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.decorrelate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.decorrelate" title="Link to this definition">¶</a></dt>
<dd><p>Decorrelate a modality.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>modality_name</strong><span class="classifier">str</span></dt><dd><p>The name of the modality to decorrelate.</p>
</dd>
<dt><strong>robust</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, use the robust (median) method to derive means.
Otherwise, use a standard mean.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>decorrelated</strong><span class="classifier">bool</span></dt><dd><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> if the modality was decorrelated and gains were updated,
<a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a> otherwise.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.decorrelate_signals">
<span class="sig-name descname"><span class="pre">decorrelate_signals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modality_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">robust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.decorrelate_signals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.decorrelate_signals" title="Link to this definition">¶</a></dt>
<dd><p>Decorrelate a modality signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>modality_name</strong><span class="classifier">str</span></dt><dd><p>The name of the modality to decorrelate.</p>
</dd>
<dt><strong>robust</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, use the robust (median) method to derive means.
Otherwise, use a standard mean.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>decorrelated</strong><span class="classifier">bool</span></dt><dd><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> if the modality was decorrelated.  <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a> otherwise.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.dejump_frames">
<span class="sig-name descname"><span class="pre">dejump_frames</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.dejump_frames"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.dejump_frames" title="Link to this definition">¶</a></dt>
<dd><p>Remove jumps in the frame data.</p>
<p>This will also calculate frame relative weights if necessary.</p>
<p>“Jumps” are determined from the noise (weights) of the frame data.
At every transition between high and low weights (determined by
the ‘dejump.level’ configuration option), the average channel level
data is subtracted, and dependencies are updated.  Integration signals
will also be updated.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.despike">
<span class="sig-name descname"><span class="pre">despike</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.despike"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.despike" title="Link to this definition">¶</a></dt>
<dd><p>Despike frame data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>level</strong><span class="classifier">float, optional</span></dt><dd><p>The despiking level.  If not supplied, will be extracted from the
configuration ‘despike.level’ setting.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.despike_absolute">
<span class="sig-name descname"><span class="pre">despike_absolute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.despike_absolute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.despike_absolute" title="Link to this definition">¶</a></dt>
<dd><p>Identifies and flags spikes in frame data using absolute method.</p>
<p>Identify spikes in the data using the relation:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>|x| &gt; threshold
</pre></div>
</div>
<p>where:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>threshold = level * channel_noise / sqrt(w)
</pre></div>
</div>
<p>level is supplied by the user, x is the frame data, and w is the
relative weight of a given frame.</p>
<p>Samples that obey the above inequality are flagged with the
SAMPLE_SPIKE flag while all others will be unflagged.  Note that
this is only applicable to the “live channels”, and those frames
that are not flagged with the SAMPLE_SKIP or SAMPLE_SOURCE_BLANK
frame flags. Invalid frames are also ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>level</strong><span class="classifier">float</span></dt><dd><p>The sigma level used to identify spikes.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.despike_gradual">
<span class="sig-name descname"><span class="pre">despike_gradual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.despike_gradual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.despike_gradual" title="Link to this definition">¶</a></dt>
<dd><p>Identifies and flags spikes in frame data using gradual method.</p>
<p>Identify spikes in the data using the relation:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>|x| &gt; threshold
</pre></div>
</div>
<p>where:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>threshold = max(level * channel_noise / sqrt(w),
                gain * depth * max(x/gain &lt;for all channels&gt;)).
</pre></div>
</div>
<p>level and depth are supplied by the user, x is the frame data, and
w is the relative weight of a given frame.</p>
<p>Samples that obey the above inequality are flagged with the
SAMPLE_SPIKE flag while all others will be unflagged.  Note that
this is only applicable to the “live channels”, and those frames
that are not flagged with the SAMPLE_SKIP or SAMPLE_SOURCE_BLANK
frame flags. Invalid frames are also ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>level</strong><span class="classifier">float</span></dt><dd><p>The sigma level used to identify spikes.</p>
</dd>
<dt><strong>depth</strong><span class="classifier">float, optional</span></dt><dd><p>The maximum allowable data value as a factor of the maximum channel
data value.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.despike_multi_resolution">
<span class="sig-name descname"><span class="pre">despike_multi_resolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.despike_multi_resolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.despike_multi_resolution" title="Link to this definition">¶</a></dt>
<dd><p>Identifies and flag spikes in frame data using multi-resolution.</p>
<p>Flags are identified in the frame data at a series of decreasing
resolutions (power of 2).  The first resolution (1) determines the
significance as:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>s = |d[i] - d[i-1]| * sqrt(w_sum)
</pre></div>
</div>
<p>where:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>w_sum = (w[i] * w[i-1]) / (w[i] + w[i-1])
</pre></div>
</div>
<p>and flagged frame i as a spike if s &gt; level where d is the
timestream data (frame_data * frame_relative_weight) and w is the
frame_relative_weight.</p>
<p>Timestream data is then set to half the resolution by setting</p>
<p>d[i] -&gt; d[i] + d[i-1]
w[i] = w_sum</p>
<p>The process is repeated at decreasing resolution up to a maximum block
size defined as half the number of frames in the filter time scale.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>level</strong><span class="classifier">float</span></dt><dd><p>The significance above which data are flagged as spikes.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.despike_neighbouring">
<span class="sig-name descname"><span class="pre">despike_neighbouring</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.despike_neighbouring"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.despike_neighbouring" title="Link to this definition">¶</a></dt>
<dd><p>Identifies and flags spikes in frame data using neighbours method.</p>
<p>Identify spikes in the data using the relation:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>|x[i + delta] - x[i]| &gt; threshold
</pre></div>
</div>
<p>where:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>threshold = level * channel_noise * sqrt(1/w[i] + 1/w[i + delta])
</pre></div>
</div>
<p>level and delta are supplied by the user, x is the frame data, and
w is the relative weight of a given frame.</p>
<p>Samples that obey the above inequality are flagged with the
SAMPLE_SPIKE flag while all others will be unflagged.  Note that this
is only applicable to the “live channels”, and those frames that
are not flagged with the SAMPLE_SKIP or SAMPLE_SOURCE_BLANK frame
flags. Invalid frames are also ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>level</strong><span class="classifier">float</span></dt><dd><p>The sigma level used to identify spikes.</p>
</dd>
<dt><strong>delta</strong><span class="classifier">int</span></dt><dd><p>The frame difference between two “neighbours” used for the
spike comparison.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.detector_stage">
<span class="sig-name descname"><span class="pre">detector_stage</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.detector_stage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.detector_stage" title="Link to this definition">¶</a></dt>
<dd><p>Divide the frame data by the channel hardware gains.</p>
<p>Will not be performed if this operation has already been completed.
i.e. the detector is already staged, and the readout is not staged.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.downsample">
<span class="sig-name descname"><span class="pre">downsample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.downsample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.downsample" title="Link to this definition">¶</a></dt>
<dd><p>Downsample frame data by a given, or derived factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>factor</strong><span class="classifier">int, optional</span></dt><dd><p>The factor by which to downsample frames.  If not supplied, will
be determined using the <a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_downsample_factor" title="sofia_redux.scan.integration.integration.Integration.get_downsample_factor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_downsample_factor</span></code></a> method.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"></dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.downsampling_window">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">downsampling_window</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.downsampling_window"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.downsampling_window" title="Link to this definition">¶</a></dt>
<dd><p>Create a normalized Hann window and the new indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>factor</strong><span class="classifier">int</span></dt><dd><p>The downsampling factor.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>window, indices</strong><span class="classifier">numpy.ndarray (float), numpy.ndarray (int)</span></dt><dd><p>The Hann kernel, and the indices over which the center of the
kernel should be placed to generate the downsampled data.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.fill_gaps">
<span class="sig-name descname"><span class="pre">fill_gaps</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.fill_gaps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.fill_gaps" title="Link to this definition">¶</a></dt>
<dd><p>Add invalid frames in cases where there are timestream gaps.</p>
<p>The MJD of the invalid frames are set to NaN.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.filter_frames_for">
<span class="sig-name descname"><span class="pre">filter_frames_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.filter_frames_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.filter_frames_for" title="Link to this definition">¶</a></dt>
<dd><p>Return the number of filtering frames for a given specification.</p>
<p>The available specifications are ‘auto’, ‘max’, or a float value in
seconds.  ‘auto’ derives the time from the crossing time, <a class="reference external" href="https://docs.python.org/3/library/functions.html#max" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">max</span></code></a>
returns the maximum number of frames in the integration.</p>
<p>Note that the return value will be rounded up to the nearest power of
2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spec</strong><span class="classifier">float or str, optional</span></dt><dd><p>The specification.  May take values of ‘auto’, ‘max’, or a float
value (in seconds).</p>
</dd>
<dt><strong>default_time</strong><span class="classifier">astropy.units.Quantity</span></dt><dd><p>If a specification is not supplied or cannot be parsed, use this
default time instead.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>frames</strong><span class="classifier">int</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If no spec or default value is provided.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.flag_spiky_blocks">
<span class="sig-name descname"><span class="pre">flag_spiky_blocks</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.flag_spiky_blocks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.flag_spiky_blocks" title="Link to this definition">¶</a></dt>
<dd><p>Flag all frames in a block if one or more frames is flagged as spiky.</p>
<p>The number of frames in a “block” is defined as the number of frames
within the filter time scale.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.flag_spiky_channels">
<span class="sig-name descname"><span class="pre">flag_spiky_channels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flag_fraction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.flag_spiky_channels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.flag_spiky_channels" title="Link to this definition">¶</a></dt>
<dd><p>Flag channels with excessive spiky frames as SPIKY.</p>
<p>The number of frames required to flag a channel as spiky is given as
max(<code class="xref py py-obj docutils literal notranslate"><span class="pre">flag_fraction</span></code> * n_frames, flag_count).  This procedure also
set the channel data spikes attribute and performs a census of all
channels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>flag_fraction</strong><span class="classifier">float, optional</span></dt><dd><p>The minimum fraction of frames flagged as spiky required to flag
a channel as spiky.</p>
</dd>
<dt><strong>flag_count</strong><span class="classifier">int or float, optional</span></dt><dd><p>The number of frames flagged as spiky required to flag a channel
as spiky.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.flag_spiky_frames">
<span class="sig-name descname"><span class="pre">flag_spiky_frames</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame_spikes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.flag_spiky_frames"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.flag_spiky_frames" title="Link to this definition">¶</a></dt>
<dd><p>Flag frames with excessive spiky channels as FLAG_SPIKY.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>frame_spikes</strong><span class="classifier">int, optional</span></dt><dd><p>Frames with a number of spiky channels above this limit will be
flagged.  The default is all channels.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.flag_weights">
<span class="sig-name descname"><span class="pre">flag_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.flag_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.flag_weights" title="Link to this definition">¶</a></dt>
<dd><p>Check if channel weights should be flagged and update source NEFD.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.frames_for">
<span class="sig-name descname"><span class="pre">frames_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.frames_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.frames_for" title="Link to this definition">¶</a></dt>
<dd><p>Return the number of frames for a given time interval.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>time</strong><span class="classifier">astropy.units.Quantity, optional</span></dt><dd><p>The time interval.  If not supplied, defaults to the sampling
interval.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>n_frames</strong><span class="classifier">int</span></dt><dd><p>The number of frames in the time interval.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_acceleration_signal">
<span class="sig-name descname"><span class="pre">get_acceleration_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">direction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_acceleration_signal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_acceleration_signal" title="Link to this definition">¶</a></dt>
<dd><p>Return an acceleration signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>direction</strong><span class="classifier">str or MotionFlag</span></dt><dd><p>The direction of motion.</p>
</dd>
<dt><strong>mode</strong><span class="classifier">Mode, optional</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Signal</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_accelerations">
<span class="sig-name descname"><span class="pre">get_accelerations</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_accelerations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_accelerations" title="Link to this definition">¶</a></dt>
<dd><p>Return the telescope accelerations.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>astropy.units.Quantity (numpy.ndarray)</dt><dd><p>An array of accelerations of shape (N, 2) containing the (az, alt)
telescope accelerations in the default size units/second/second.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_ascii_header">
<span class="sig-name descname"><span class="pre">get_ascii_header</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_ascii_header"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_ascii_header" title="Link to this definition">¶</a></dt>
<dd><p>Return a string header for output text files.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>header</strong><span class="classifier">str</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_channel_weights">
<span class="sig-name descname"><span class="pre">get_channel_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_channel_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_channel_weights" title="Link to this definition">¶</a></dt>
<dd><p>Derive and set channel weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>method</strong><span class="classifier">str</span></dt><dd><p>The method to derive channel weights.  Must be one of {robust,
differential, rms}.  If not supplied, will be determined from the
configuration.  Defaults to ‘rms’ if no valid method can be found.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_correlated_signal_class">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_correlated_signal_class</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_correlated_signal_class"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_correlated_signal_class" title="Link to this definition">¶</a></dt>
<dd><p>Return the correlated signal class.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>CorrelatedSignal</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_coupling_gains">
<span class="sig-name descname"><span class="pre">get_coupling_gains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_coupling_gains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_coupling_gains" title="Link to this definition">¶</a></dt>
<dd><p>Return the coupling gains for a given channel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>signal</strong><span class="classifier">Signal</span></dt><dd><p>The signal for which to extract channel gains.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>coupling_gains</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The coupling gains as an array of shape (self.channels.size).
Values for channels not included in the signal will be set to zero.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_covariance">
<span class="sig-name descname"><span class="pre">get_covariance</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_covariance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_covariance" title="Link to this definition">¶</a></dt>
<dd><p>Return the channel covariance.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>covariance</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The covariance matrix of shape (n_channels, n_channels).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_crossing_time">
<span class="sig-name descname"><span class="pre">get_crossing_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_crossing_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_crossing_time" title="Link to this definition">¶</a></dt>
<dd><p>Return the crossing time for a given source size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>source_size</strong><span class="classifier">astropy.units.Quantity, optional</span></dt><dd><p>The size of the source.  If not supplied, defaults to (in order
of priority) the source size in the scan model, or the instrument
source size.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>time</strong><span class="classifier">astropy.units.Quantity</span></dt><dd><p>The crossing time in time units.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_default_scaling_factor">
<span class="sig-name descname"><span class="pre">get_default_scaling_factor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_default_scaling_factor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_default_scaling_factor" title="Link to this definition">¶</a></dt>
<dd><p>Return the default scaling factor from the configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>scale</strong><span class="classifier">float</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_dependents">
<span class="sig-name descname"><span class="pre">get_dependents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_dependents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_dependents" title="Link to this definition">¶</a></dt>
<dd><p>Return or create and return dependents of the given name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name</strong><span class="classifier">str</span></dt><dd><p>The name of the dependents.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Dependents</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_differential_channel_weights">
<span class="sig-name descname"><span class="pre">get_differential_channel_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_differential_channel_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_differential_channel_weights" title="Link to this definition">¶</a></dt>
<dd><p>Derive and set differentially derived weights for live channels.</p>
<p>The variance and variance weight for a channel <code class="xref py py-obj docutils literal notranslate"><span class="pre">i</span></code> is given as:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>var = sum(w * (data[:, i] - data[:, i+delta])^2)
weight = sum(w)
</pre></div>
</div>
<p>taken over all valid frames for the channel <code class="xref py py-obj docutils literal notranslate"><span class="pre">i</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">i+delta</span></code>, and zero
flagged samples for the channel <code class="xref py py-obj docutils literal notranslate"><span class="pre">i</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">i+delta</span></code>.  These values are
then passed to <a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.set_weights_from_var_stats" title="sofia_redux.scan.integration.integration.Integration.set_weights_from_var_stats"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_weights_from_var_stats</span></code></a> to set the channel
degrees of freedom, weights, and variances for channels.</p>
<p>In this case delta is defined as 10 times the number of frames
required to cross the point response of the instrument (based on
scanning speed).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_display_id">
<span class="sig-name descname"><span class="pre">get_display_id</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_display_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_display_id" title="Link to this definition">¶</a></dt>
<dd><p>Get the display integration ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>str</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_downsample_factor">
<span class="sig-name descname"><span class="pre">get_downsample_factor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_downsample_factor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_downsample_factor" title="Link to this definition">¶</a></dt>
<dd><p>Return the factor by which to downsample frames.</p>
<p>The downsampling factor is retrieved from the configuration
‘downsample’ option which may either be valued as ‘auto’, or an
integer value. Any value derived at this stage may be corrected by the
‘downsample.autofactor’ configuration setting valued as an integer or
float. i.e, final factor = downsample * autofactor.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>factor</strong><span class="classifier">int</span></dt><dd><p>A factor greater than 1 indicates downsampling should occur.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_duration">
<span class="sig-name descname"><span class="pre">get_duration</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_duration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_duration" title="Link to this definition">¶</a></dt>
<dd><p>Return the total integration duration.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>time</strong><span class="classifier">astropy.units.Quantity</span></dt><dd><p>The integration duration in time units.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_exposure_time">
<span class="sig-name descname"><span class="pre">get_exposure_time</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_exposure_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_exposure_time" title="Link to this definition">¶</a></dt>
<dd><p>Return the total exposure time.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>time</strong><span class="classifier">astropy.units.Quantity</span></dt><dd><p>The exposure time in time units.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_file_id">
<span class="sig-name descname"><span class="pre">get_file_id</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_file_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_file_id" title="Link to this definition">¶</a></dt>
<dd><p>Get the file integration ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>str</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_filter">
<span class="sig-name descname"><span class="pre">get_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_filter" title="Link to this definition">¶</a></dt>
<dd><p>Return a filter of the given name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filter_name</strong><span class="classifier">str</span></dt><dd><p>The name of the filter.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Filter</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_first_frame">
<span class="sig-name descname"><span class="pre">get_first_frame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reference</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_first_frame"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_first_frame" title="Link to this definition">¶</a></dt>
<dd><p>Return the first valid frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>reference</strong><span class="classifier">int, optional</span></dt><dd><p>The first actual frame index after which to return the first valid
frame.  The default is the first (0).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Frames</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_first_frame_index">
<span class="sig-name descname"><span class="pre">get_first_frame_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reference</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_first_frame_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_first_frame_index" title="Link to this definition">¶</a></dt>
<dd><p>Return the first valid frame index of the integration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>reference</strong><span class="classifier">int, optional</span></dt><dd><p>If supplied, finds the first frame from <code class="xref py py-obj docutils literal notranslate"><span class="pre">reference</span></code>, rather than
the first index (0).  May take negative values to indicate an
index relative to the last.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>first_frame</strong><span class="classifier">int</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_fits_data">
<span class="sig-name descname"><span class="pre">get_fits_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_fits_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_fits_data" title="Link to this definition">¶</a></dt>
<dd><p>Return integration data as an astropy table.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>astropy.table.Table</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_floats">
<span class="sig-name descname"><span class="pre">get_floats</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_floats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_floats" title="Link to this definition">¶</a></dt>
<dd><p>Return a float array suitable for FFT.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>numpy.ndarray (float)</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_frame_count">
<span class="sig-name descname"><span class="pre">get_frame_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keep_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discard_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_frame_count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_frame_count" title="Link to this definition">¶</a></dt>
<dd><p>Return the number of frames in an integration.</p>
<p>A number of flags may also be supplied to return the number of a
certain type of frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>keep_flag</strong><span class="classifier">int or ChannelFlagTypes, optional</span></dt><dd><p>Flag values to keep in the calculation.</p>
</dd>
<dt><strong>discard_flag</strong><span class="classifier">int or ChannelFlagTypes, optional</span></dt><dd><p>Flag values to discard_flag from the calculation.</p>
</dd>
<dt><strong>match_flag</strong><span class="classifier">int or ChannelFlagTypes, optional</span></dt><dd><p>Only matching flag values will be used in the calculation.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>n_frames</strong><span class="classifier">int</span></dt><dd><p>The number of matching frames in the integration.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_frame_gaps">
<span class="sig-name descname"><span class="pre">get_frame_gaps</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_frame_gaps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_frame_gaps" title="Link to this definition">¶</a></dt>
<dd><p>Return the gaps between frames.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>frame_gaps, time_gaps</strong><span class="classifier">numpy.ndarray (int), units.Quantity</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_full_covariance">
<span class="sig-name descname"><span class="pre">get_full_covariance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">covariance</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_full_covariance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_full_covariance" title="Link to this definition">¶</a></dt>
<dd><p>Return the full covariance array for all initial channels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>covariance</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The covariance array for all channels (not including the initial
channels removed).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>full_covariance</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The full covariance array of shape (store_channels,
store_channels).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_full_id">
<span class="sig-name descname"><span class="pre">get_full_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">separator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'|'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_full_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_full_id" title="Link to this definition">¶</a></dt>
<dd><p>Return the full integration ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>separator</strong><span class="classifier">str, optional</span></dt><dd><p>The separator character/phase between the scan and integration ID.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>str</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_group_covariance">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_group_covariance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">division</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covariance</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_group_covariance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_group_covariance" title="Link to this definition">¶</a></dt>
<dd><p>Return the covariance for all groups in a channel division.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>division</strong><span class="classifier">ChannelDivision</span></dt><dd><p>The channel division for which to extract covariances.</p>
</dd>
<dt><strong>covariance</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The covariance matrix of shape (all_channels, all_channels) for
all available channels.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>group_covariance</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The covariance for channels in the division.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_id">
<span class="sig-name descname"><span class="pre">get_id</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_id" title="Link to this definition">¶</a></dt>
<dd><p>Return the simple integration ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>str</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_integration_class">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_integration_class</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_integration_class"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_integration_class" title="Link to this definition">¶</a></dt>
<dd><p>Return an Integration instance given an instrument name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name</strong><span class="classifier">str</span></dt><dd><p>The name of the instrument.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>Integration</strong><span class="classifier">class</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_last_frame">
<span class="sig-name descname"><span class="pre">get_last_frame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reference</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_last_frame"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_last_frame" title="Link to this definition">¶</a></dt>
<dd><p>Return the first valid frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>reference</strong><span class="classifier">int, optional</span></dt><dd><p>The last actual frame index before which to return the last valid
frame.  The default is the last.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Frames</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_last_frame_index">
<span class="sig-name descname"><span class="pre">get_last_frame_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reference</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_last_frame_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_last_frame_index" title="Link to this definition">¶</a></dt>
<dd><p>Return the last valid frame index of the integration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>reference</strong><span class="classifier">int, optional</span></dt><dd><p>If supplied, finds the last frame before <code class="xref py py-obj docutils literal notranslate"><span class="pre">reference</span></code>, rather than
the last index (self.size).  May take negative values to indicate
an index relative to the last index.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>last_frame</strong><span class="classifier">int</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_mean_level">
<span class="sig-name descname"><span class="pre">get_mean_level</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">robust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_mean_level"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_mean_level" title="Link to this definition">¶</a></dt>
<dd><p>Return the median data values and associated weights for channels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>channels</strong><span class="classifier">Channels or ChannelData, optional</span></dt><dd><p>The channels for which to calculate median levels.</p>
</dd>
<dt><strong>start</strong><span class="classifier">int, optional</span></dt><dd><p>Calculate the median after (and including) this starting frame.</p>
</dd>
<dt><strong>end</strong><span class="classifier">int, optional</span></dt><dd><p>Calculate the median from before (not including) this end frame.</p>
</dd>
<dt><strong>robust</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, use <code class="xref py py-func docutils literal notranslate"><span class="pre">smart_median()</span></code> to determine the mean values.
Otherwise, use a simple mean.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>values, weights</strong><span class="classifier">numpy.ndarray (float), numpy.ndarray (float)</span></dt><dd><p>The median channel values and associated weight of the calculation,
both if shape (channels.size,).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_mjd">
<span class="sig-name descname"><span class="pre">get_mjd</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_mjd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_mjd" title="Link to this definition">¶</a></dt>
<dd><p>Return the midpoint MJD of the integration.</p>
<p>The midpoint MJD is defined as the average of the first and last
valid frame MJD values.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>mjd</strong><span class="classifier">float</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_modulation_frequency">
<span class="sig-name descname"><span class="pre">get_modulation_frequency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal_flag</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_modulation_frequency"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_modulation_frequency" title="Link to this definition">¶</a></dt>
<dd><p>Return the modulation frequency.</p>
<p>The modulation frequency is taken from the chopper frequency if
available, or set to 0 Hz otherwise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>signal_flag</strong><span class="classifier">FrameFlagTypes or str or int</span></dt><dd><p>The signal flag (not relevant for this implementation).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>frequency</strong><span class="classifier">astropy.units.Quantity.</span></dt><dd><p>The modulation frequency in Hz.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_pa">
<span class="sig-name descname"><span class="pre">get_pa</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_pa"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_pa" title="Link to this definition">¶</a></dt>
<dd><p>Return the position angle of the integration.</p>
<p>The position angle is derived from the average position angles of the
first and last valid frames.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>position_angle</strong><span class="classifier">astropy.units.Quantity</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_point_crossing_time">
<span class="sig-name descname"><span class="pre">get_point_crossing_time</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_point_crossing_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_point_crossing_time" title="Link to this definition">¶</a></dt>
<dd><p>Return the time required to cross the point size of the scan.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>time</strong><span class="classifier">astropy.units.Quantity</span></dt><dd><p>The point crossing time in time units.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_position_signal">
<span class="sig-name descname"><span class="pre">get_position_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">motion_flag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_position_signal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_position_signal" title="Link to this definition">¶</a></dt>
<dd><p>Return a position signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>motion_flag</strong><span class="classifier">MotionFlagTypes or str or int</span></dt><dd><p>The motion type for which to extract positions.</p>
</dd>
<dt><strong>direction</strong><span class="classifier">str or MotionFlag</span></dt><dd><p>The direction of motion.</p>
</dd>
<dt><strong>mode</strong><span class="classifier">Mode, optional</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Signal</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_positions">
<span class="sig-name descname"><span class="pre">get_positions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">motion_flag</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_positions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_positions" title="Link to this definition">¶</a></dt>
<dd><p>Return positions based on a type of motion.</p>
<p>Available motion types are TELESCOPE, SCANNING, or CHOPPING.
Combinations of TELESCOPE|CHOPPING|PROJECT_GLS and SCANNING|CHOPPING
are also permitted.  i.e., TELESCOPE and CHOPPING should be supplied
with or without CHOPPING, and PROJECT_GLS is available for the
TELESCOPE flag.  If these flags are not present, an array containing
zero values will be returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>motion_flag</strong><span class="classifier">MotionFlagTypes or str or int</span></dt><dd><p>The motion type for which to extract positions.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>position</strong><span class="classifier">astropy.units.Quantity (numpy.ndarray)</span></dt><dd><p>An array of shape (N, 2) containing the (x, y) positions.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_rms_channel_weights">
<span class="sig-name descname"><span class="pre">get_rms_channel_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_rms_channel_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_rms_channel_weights" title="Link to this definition">¶</a></dt>
<dd><p>Derive and set channel weights for live channels based on data values.</p>
<p>The variance and variance weight for a channel <code class="xref py py-obj docutils literal notranslate"><span class="pre">i</span></code> is given as:</p>
<blockquote>
<div><p>var = sum(w * data^2)
weight = sum(w)</p>
</div></blockquote>
<p>taken over all valid frames for the channel <code class="xref py py-obj docutils literal notranslate"><span class="pre">i</span></code>, and zero flagged
samples for the channel <code class="xref py py-obj docutils literal notranslate"><span class="pre">i</span></code>.  These values are then passed to
<a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.set_weights_from_var_stats" title="sofia_redux.scan.integration.integration.Integration.set_weights_from_var_stats"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_weights_from_var_stats</span></code></a> to set the channel degrees of
freedom, weights, and variances for channels.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_robust_channel_weights">
<span class="sig-name descname"><span class="pre">get_robust_channel_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_robust_channel_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_robust_channel_weights" title="Link to this definition">¶</a></dt>
<dd><p>Derive and set robustly derived channel weights for live channels.</p>
<p>The variance and variance weight for a channel <code class="xref py py-obj docutils literal notranslate"><span class="pre">i</span></code> is given as:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>var = median(relative_weight * frame_data[:, i] ** 2)
weight = sum(relative_weight)
</pre></div>
</div>
<p>taken over all valid frames for the channel <code class="xref py py-obj docutils literal notranslate"><span class="pre">i</span></code> and zero flagged
samples for the channel <code class="xref py py-obj docutils literal notranslate"><span class="pre">i</span></code>.  These values are then passed to
<a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.set_weights_from_var_stats" title="sofia_redux.scan.integration.integration.Integration.set_weights_from_var_stats"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_weights_from_var_stats</span></code></a> to set the channel degrees of
freedom, weights, and variances for channels.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_scanning_velocities">
<span class="sig-name descname"><span class="pre">get_scanning_velocities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">return_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_scanning_velocities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_scanning_velocities" title="Link to this definition">¶</a></dt>
<dd><p>Return the scanning velocity (including chopping motion).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>return_position</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, return the position in addition to velocity.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>velocity, [position]</strong><span class="classifier">Coordinate2D, [Quantity]</span></dt><dd><p>The position will be returned in addition to velocity if
<code class="xref py py-obj docutils literal notranslate"><span class="pre">return_position</span></code> is <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>.   Both contain (x, y) coordinates.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_signal">
<span class="sig-name descname"><span class="pre">get_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_signal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_signal" title="Link to this definition">¶</a></dt>
<dd><p>Return the signal for a given mode.</p>
<p>If the signal exists in the current integration signals dictionary, it
will be returned as is.  Otherwise, if a response mode is supplied,
a new signal will be created, added to the dictionary, and returned.
If the signal does not exist, and the mode is not a response mode, no
signal will be returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>mode</strong><span class="classifier">Mode</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>signal</strong><span class="classifier">Signal or None</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_smooth_positions">
<span class="sig-name descname"><span class="pre">get_smooth_positions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">motion_flag</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_smooth_positions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_smooth_positions" title="Link to this definition">¶</a></dt>
<dd><p>Return the positions, smoothed according to the configuration.</p>
<p>The frames are smoothed using a box kernel with width specified in time
(seconds), and should be set using “positions.smooth”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>motion_flag</strong><span class="classifier">MotionFlagTypes or str or int</span></dt><dd><p>The motion type for which to extract positions.  See
<a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_positions" title="sofia_redux.scan.integration.integration.Integration.get_positions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_positions</span></code></a> for details on motion flag types.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>position</strong><span class="classifier">astropy.units.Quantity (numpy.ndarray)</span></dt><dd><p>An array of shape (N, 2) containing the (x, y) positions.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_spectra">
<span class="sig-name descname"><span class="pre">get_spectra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hamming'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_spectra"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_spectra" title="Link to this definition">¶</a></dt>
<dd><p>Return the power spectrum of the data.</p>
<p>The returned power spectrum is computed using Welch’s method
of dividing the data into periodograms and averaging the result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>window_function</strong><span class="classifier">str or function, optional</span></dt><dd><p>The window filter name.  The default is “hamming”.  Must be an
available function in <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/signal.windows.html#module-scipy.signal.windows" title="(in SciPy v1.12.0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.signal.windows</span></code></a>.</p>
</dd>
<dt><strong>window_size</strong><span class="classifier">int, optional</span></dt><dd><p>The size of the filter in frames.  The default is twice the number
of frames in the filtering time scale.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>frequency, spectrum</strong><span class="classifier">Quantity, Quantity</span></dt><dd><p>The frequency spectrum is of shape (nf2,) in units of Hertz.  The
spectrum is of shape (nf2, n_channels) in units of Janskys.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_speed_clip_range">
<span class="sig-name descname"><span class="pre">get_speed_clip_range</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_speed_clip_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_speed_clip_range" title="Link to this definition">¶</a></dt>
<dd><p>Determine the range of permissible scanning speeds.</p>
<p>The permissible scanning speeds are determined from the configuration
‘vclip’ (velocity clipping) branch.  If vclip = ‘auto’, the minimum
speed is 5 FWHMs over the stability timescale, and the maximum speed
is 1/2.5 beams per sample to avoid smearing.  Otherwise, the ‘vclip’
configuration value should be a range in units of arcseconds per
second.</p>
<p>If the ‘chopped’ configuration option is set, the minimum speed is set
to zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>speed_range</strong><span class="classifier">Range</span></dt><dd><p>The minimum and maximum speeds are astropy.unit.Quantity values
in units of the default size unit per second.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_standard_id">
<span class="sig-name descname"><span class="pre">get_standard_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">separator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'|'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_standard_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_standard_id" title="Link to this definition">¶</a></dt>
<dd><p>Get the standard integration ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>separator</strong><span class="classifier">str, optional</span></dt><dd><p>The separator character/phase between the scan and integration ID.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>str</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_table_entry">
<span class="sig-name descname"><span class="pre">get_table_entry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_table_entry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_table_entry" title="Link to this definition">¶</a></dt>
<dd><p>Return a parameter value for the given name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name</strong><span class="classifier">str</span></dt><dd><p>The name of the parameter to retrieve.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>value</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_tau">
<span class="sig-name descname"><span class="pre">get_tau</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_tau"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_tau" title="Link to this definition">¶</a></dt>
<dd><p>Get the tau value based on configuration settings.</p>
<p>The returned value is given as:</p>
<p>t_b + t_a * (value - band_b) / band_a</p>
<p>where band_a/b are retrieved from the configuration as tau.&lt;spec&gt;.a/b,
and t_a/b are retrieved from the configuration as tau.&lt;instrument&gt;.a/b.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spec</strong><span class="classifier">str</span></dt><dd><p>The name of the tau specification.</p>
</dd>
<dt><strong>value</strong><span class="classifier">float, optional</span></dt><dd><p>If not provided, defaults to the zenith tau.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>float</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_tau_coefficients">
<span class="sig-name descname"><span class="pre">get_tau_coefficients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_tau_coefficients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_tau_coefficients" title="Link to this definition">¶</a></dt>
<dd><p>Return the tau coefficients for the tau specification.</p>
<p>The tau a and b coefficients are retrieved from the configuration as
tau.&lt;spec&gt;.a and tau.&lt;spec&gt;.b.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spec</strong><span class="classifier">str</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>t_a, t_b</strong><span class="classifier">float, float</span></dt><dd><p>The tau a and b coefficients.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_thread_count">
<span class="sig-name descname"><span class="pre">get_thread_count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_thread_count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_thread_count" title="Link to this definition">¶</a></dt>
<dd><p>Return the number of parallel tasks for the integration.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>threads</strong><span class="classifier">int</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_time_stream">
<span class="sig-name descname"><span class="pre">get_time_stream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_time_stream"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_time_stream" title="Link to this definition">¶</a></dt>
<dd><p>Return the time stream data.</p>
<p>Returns the frame time stream data for a given set of channels (default
is the integration channels).   Samples flagged as MODELING flags, have
nonzero sample flags, or marked as invalid are returned as NaN if
unweighted or zero otherwise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>channels</strong><span class="classifier">Channels or ChannelData</span></dt><dd><p>The channels for which to extract time streams.  If not supplied,
defaults to the integration channels.</p>
</dd>
<dt><strong>weighted</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> return the frame data multiplied by relative weight.
In addition, return the weights.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>data, [weight]</strong><span class="classifier">numpy.ndarray (float), [numpy.ndarray (float)]</span></dt><dd><p>An array of shape (n_frames, n_channels).  Invalid values are
returned as NaN values if unweighted, or zero otherwise.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_time_weights">
<span class="sig-name descname"><span class="pre">get_time_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_time_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_time_weights" title="Link to this definition">¶</a></dt>
<dd><p>Derive and set frame weights.</p>
<p>Relative weight values are derived for chunks of frames in turn.
The <code class="xref py py-obj docutils literal notranslate"><span class="pre">block_size</span></code> parameter determines how many frames are to be
included in each chunk.  If not supplied it is either retrieved
from the ‘weighting.frames.resolution` option (in seconds), or
defaults to the number of frames in 10 seconds.</p>
<p>This process sets the both the frame relative weights, the frame
degrees of freedom, flags frames that do not have sufficient degrees
of freedom, and optionally flags frames that do not have weights
(noise values) within the acceptable range (determined by the
‘weighting.frames.noiserange` configuration option).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>channels</strong><span class="classifier">Channels or ChannelData or ChannelGroup, optional</span></dt><dd><p>The channels from which to derive weights.</p>
</dd>
<dt><strong>block_size</strong><span class="classifier">int, optional</span></dt><dd><p>Processing occurs serially in blocks, and values are derived for
each block independently.  The block size determines the number of
frames in each block.</p>
</dd>
<dt><strong>flag</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, flag frames that are outside of the weight range
determined by the ‘weighting.frames.noiserange’ configuration
option.  Such flags will be marked with the FLAG_WEIGHT flag.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_typical_scanning_speed">
<span class="sig-name descname"><span class="pre">get_typical_scanning_speed</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_typical_scanning_speed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_typical_scanning_speed" title="Link to this definition">¶</a></dt>
<dd><p>Get the mean (robust) scanning speed and weight (inverse variance).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>speed, weight</strong><span class="classifier">Quantity, Quantity</span></dt><dd><p>The speed in distance/time units, and weight in time^2/distance^2
units.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.get_velocities">
<span class="sig-name descname"><span class="pre">get_velocities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">motion_flag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.get_velocities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.get_velocities" title="Link to this definition">¶</a></dt>
<dd><p>Return the scanning velocity (including chopping motion).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>motion_flag</strong><span class="classifier">MotionFlagTypes or str or int</span></dt><dd><p>The motion type for which to extract positions.  See
<a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_positions" title="sofia_redux.scan.integration.integration.Integration.get_positions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_positions</span></code></a> for details on motion flag types.</p>
</dd>
<dt><strong>return_position</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, return the position in addition to velocity.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>velocity, [position]</strong><span class="classifier">Coordinate2D, [Coordinate2D]</span></dt><dd><p>The position will be returned in addition to velocity if
<code class="xref py py-obj docutils literal notranslate"><span class="pre">return_position</span></code> is <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>.  Both have (x, y) coordinates.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.has_gaps">
<span class="sig-name descname"><span class="pre">has_gaps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.has_gaps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.has_gaps" title="Link to this definition">¶</a></dt>
<dd><p>Check if there are gaps in the time stream data.</p>
<p>This assumes a uniform sampling interval between frame measurements
and calculates gaps based on deviation from the expected MJD of a
frame vs. it’s recorded value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>tolerance</strong><span class="classifier">int or float</span></dt><dd><p>The maximum number of frame missing in a gap.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>bool</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.has_option">
<span class="sig-name descname"><span class="pre">has_option</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">option</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.has_option"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.has_option" title="Link to this definition">¶</a></dt>
<dd><p>Return whether the configuration option is configured.</p>
<p>In order to be considered “configured”, the option must exist
and also have a value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>option</strong><span class="classifier">str</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>configured</strong><span class="classifier">bool</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.jackknife">
<span class="sig-name descname"><span class="pre">jackknife</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.jackknife"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.jackknife" title="Link to this definition">¶</a></dt>
<dd><p>Randomly invert integration and channel gains.</p>
<p>The integration gain will be inverted if the configuration contains
a ‘jackknife’ option.  The frame signs will be inverted if the
configuration contains a ‘jackknife.frames’ options.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.level">
<span class="sig-name descname"><span class="pre">level</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channel_means</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_dependents</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">robust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.level"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.level" title="Link to this definition">¶</a></dt>
<dd><p>Remove the mean frame data from each channel and update dependents.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>channel_means</strong><span class="classifier">numpy.ndarray (float), optional</span></dt><dd><p>The mean for each channel.  Will be calculated if necessary.  An
array of shape (n_channels,).</p>
</dd>
<dt><strong>channel_weights</strong><span class="classifier">numpy.ndarray (float), optional</span></dt><dd><p>The weight derived for each channel during the mean operation of
shape (n_channels,)</p>
</dd>
<dt><strong>channels</strong><span class="classifier">Channels, optional</span></dt><dd><p>The channels on which to perform the levelling.</p>
</dd>
<dt><strong>start</strong><span class="classifier">int, optional</span></dt><dd><p>The starting frame from which to derive means and consistencies.</p>
</dd>
<dt><strong>end</strong><span class="classifier">int, optional</span></dt><dd><p>The ending frame from which to derive means and consistencies.</p>
</dd>
<dt><strong>frame_dependents</strong><span class="classifier">numpy.ndarray (float), optional</span></dt><dd><p>The frame dependents to update of shape (n_frames,).  If not
supplied, defaults to an array of zeros.</p>
</dd>
<dt><strong>robust</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, use the robust method (median) to determine the channel
means.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>consistent</strong><span class="classifier">numpy.ndarray (bool)</span></dt><dd><p>An array of shape (n_frames,) where <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> indicates a consistent
frame.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.local_level">
<span class="sig-name descname"><span class="pre">local_level</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">robust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.local_level"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.local_level" title="Link to this definition">¶</a></dt>
<dd><p>Level frame data between in a certain frame range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>parms</strong><span class="classifier">Dependents</span></dt><dd></dd>
<dt><strong>start</strong><span class="classifier">int, optional</span></dt><dd><p>The starting frame (inclusive).  The default is the
first (0) frame.</p>
</dd>
<dt><strong>end</strong><span class="classifier">int, optional</span></dt><dd><p>The end frame (exclusive).  The default is the last frame
(self.size).</p>
</dd>
<dt><strong>robust</strong><span class="classifier">bool, optional</span></dt><dd><p>Level using a robust mean determination (median).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.merge">
<span class="sig-name descname"><span class="pre">merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">integration</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.merge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.merge" title="Link to this definition">¶</a></dt>
<dd><p>Merge frames from another integration onto this integration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>integration</strong><span class="classifier">Integration</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.next_iteration">
<span class="sig-name descname"><span class="pre">next_iteration</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.next_iteration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.next_iteration" title="Link to this definition">¶</a></dt>
<dd><p>Perform certain steps prior to an iteration.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.next_weight_transit">
<span class="sig-name descname"><span class="pre">next_weight_transit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">above</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.next_weight_transit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.next_weight_transit" title="Link to this definition">¶</a></dt>
<dd><p>Find the next frame index with relative weight above or below a level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>level</strong><span class="classifier">float</span></dt><dd><p>The weight threshold reference value.</p>
</dd>
<dt><strong>start</strong><span class="classifier">int, optional</span></dt><dd><p>The starting frame.  The default is the first (0).</p>
</dd>
<dt><strong>above</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, return the first frame above level.  Otherwise, return
the first frame below level.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>frame_index</strong><span class="classifier">int</span></dt><dd><p>The first frame index above or below the given level threshold.
If no frame is found, returns -1.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.notch_filter">
<span class="sig-name descname"><span class="pre">notch_filter</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.notch_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.notch_filter" title="Link to this definition">¶</a></dt>
<dd><p>Apply notch filtering based on configuration options.</p>
<p>The frequencies to filter are taken from the configuration
‘frequencies’ option, in the notch section.  Other options of
interest are ‘width’ (width of the filter), ‘harmonics’ (number
of harmonics to include), and <code class="xref py py-obj docutils literal notranslate"><span class="pre">bands</span></code>.  If “bands”
is available, extra frequencies ranging from min(band):max(band) are
added with separation of ‘width’.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.offset">
<span class="sig-name descname"><span class="pre">offset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.offset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.offset" title="Link to this definition">¶</a></dt>
<dd><p>Add an offset value to frame data for all unflagged channels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>value</strong><span class="classifier">float</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.perform">
<span class="sig-name descname"><span class="pre">perform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.perform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.perform" title="Link to this definition">¶</a></dt>
<dd><p>Perform a reduction task on the integration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>task</strong><span class="classifier">str</span></dt><dd><p>The name of the task to perform.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>performed</strong><span class="classifier">bool</span></dt><dd><p>Indicates whether the task was performed.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.pointing_at">
<span class="sig-name descname"><span class="pre">pointing_at</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.pointing_at"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.pointing_at" title="Link to this definition">¶</a></dt>
<dd><p>Applies pointing correction to coordinates via subtraction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>offset</strong><span class="classifier">astropy.units.Quantity (numpy.ndarray)</span></dt><dd><p>An array of</p>
</dd>
<dt><strong>indices</strong><span class="classifier">numpy.ndarray (int), optional</span></dt><dd><p>The frame indices that apply.  The default is all indices.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.power2_frames_for">
<span class="sig-name descname"><span class="pre">power2_frames_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.power2_frames_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.power2_frames_for" title="Link to this definition">¶</a></dt>
<dd><p>Return the number of frames for a given time interval using pow2ceil.</p>
<p>pow2ceil raises the number of frames to the nearest power of 2.  E.g.,
5 -&gt; 8, 12 -&gt; 16 etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>time</strong><span class="classifier">astropy.units.Quantity, optional</span></dt><dd><p>The time interval.  If not supplied, defaults to the sampling
interval.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>n_frames</strong><span class="classifier">int</span></dt><dd><p>The number of frames in the time interval.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.process_notch_filter_block">
<span class="sig-name descname"><span class="pre">process_notch_filter_block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_phase</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.process_notch_filter_block"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.process_notch_filter_block" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.readout_stage">
<span class="sig-name descname"><span class="pre">readout_stage</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.readout_stage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.readout_stage" title="Link to this definition">¶</a></dt>
<dd><p>Multiply the frame data by the channel hardware gains.</p>
<p>Will not be performed the detector is not staged (i.e. the readout
is staged, and the detector is not staged)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.reindex">
<span class="sig-name descname"><span class="pre">reindex</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.reindex"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.reindex" title="Link to this definition">¶</a></dt>
<dd><p>Reset the frame fixed indices to range sequentially from 0 -&gt; size.</p>
<p>Channels are also reset to ensure everything is self-consistent.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.reindex_channels">
<span class="sig-name descname"><span class="pre">reindex_channels</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.reindex_channels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.reindex_channels" title="Link to this definition">¶</a></dt>
<dd><p>Reindex the channels such that all data are self-consistent.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.reindex_frames">
<span class="sig-name descname"><span class="pre">reindex_frames</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.reindex_frames"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.reindex_frames" title="Link to this definition">¶</a></dt>
<dd><p>Reindex the time dependent data.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.remove_channel_drifts">
<span class="sig-name descname"><span class="pre">remove_channel_drifts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channel_group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drift_n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">robust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.remove_channel_drifts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.remove_channel_drifts" title="Link to this definition">¶</a></dt>
<dd><p>Remove drifts from channels.</p>
<p>Removes the average values from frames in blocks of <code class="xref py py-obj docutils literal notranslate"><span class="pre">drift_n</span></code> frames.
Dependents are updated as necessary.  If there is more than one
block, then channel filtering time scales and source filtering are
updated to account for the new length of the drift.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>channel_group</strong><span class="classifier">ChannelGroup</span></dt><dd><p>The channels from which to remove drifts.</p>
</dd>
<dt><strong>parms</strong><span class="classifier">Dependents</span></dt><dd><p>The dependents to update.</p>
</dd>
<dt><strong>drift_n</strong><span class="classifier">int</span></dt><dd><p>The number of frames in a “drift” (resolution).</p>
</dd>
<dt><strong>robust</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, use the robust (median) method to calculate means.
Otherwise, use a simple mean.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.remove_dc_offsets">
<span class="sig-name descname"><span class="pre">remove_dc_offsets</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.remove_dc_offsets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.remove_dc_offsets" title="Link to this definition">¶</a></dt>
<dd><p>Remove the DC offsets, either if explicitly requested or to allow
bootstrapping pixel weights when pixeldata is not defined.  This
must be done before direct tau estimates</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.remove_drifts">
<span class="sig-name descname"><span class="pre">remove_drifts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_frame_resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">robust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.remove_drifts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.remove_drifts" title="Link to this definition">¶</a></dt>
<dd><p>Remove drifts in frame data given a target frame resolution.</p>
<p>Will also set the filter time scale based on the target frame
resolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>target_frame_resolution</strong><span class="classifier">int, optional</span></dt><dd><p>The number of frames for the target resolution.  If not supplied,
extracted from the configuration ‘drifts’ option in seconds and
then converted to frames.</p>
</dd>
<dt><strong>robust</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> use the robust (median) method to determine means.  If
not supplied determined from the ‘estimator’ configuration option
(robust=median).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.remove_offsets">
<span class="sig-name descname"><span class="pre">remove_offsets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">robust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.remove_offsets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.remove_offsets" title="Link to this definition">¶</a></dt>
<dd><p>Remove the DC offsets from the frame data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>robust</strong><span class="classifier">bool</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, use the robust (median) method to determine means.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.scale">
<span class="sig-name descname"><span class="pre">scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.scale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.scale" title="Link to this definition">¶</a></dt>
<dd><p>Scale all data (in <code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code>) by <code class="xref py py-obj docutils literal notranslate"><span class="pre">factor</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>factor</strong><span class="classifier">int or float, optional</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.search_corners">
<span class="sig-name descname"><span class="pre">search_corners</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">perimeter_pixels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">projection</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.search_corners"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.search_corners" title="Link to this definition">¶</a></dt>
<dd><p>Find the corners of the mapping range of the integration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>perimeter_pixels</strong><span class="classifier">ChannelGroup</span></dt><dd><p>A channel group ideally containing pixels near the edge of the
array (Although this is not strictly necessary - just speeds things
up).</p>
</dd>
<dt><strong>projection</strong><span class="classifier">Projection2D</span></dt><dd><p>A grid projection used to convert pixel positions onto a map
grid.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>map_range</strong><span class="classifier">Coordinate2D</span></dt><dd><p>The minimum (x, y) and maximum (x, y) map offsets.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.select_frames">
<span class="sig-name descname"><span class="pre">select_frames</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.select_frames"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.select_frames" title="Link to this definition">¶</a></dt>
<dd><p>Delete frames not inside the frame range defined in the configuration.</p>
<p>The “frames” configuration setting is responsible for defining a valid
frame range.  All fixed frame indices outside of this range will be
removed from the integration.  Note that the “fixed” index of the
frames will be used - the index as initially read from the data file.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.set_iteration">
<span class="sig-name descname"><span class="pre">set_iteration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iteration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.set_iteration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.set_iteration" title="Link to this definition">¶</a></dt>
<dd><p>Set the configuration for a given iteration</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>iteration</strong><span class="classifier">float or int or str</span></dt><dd><p>The iteration to set.  A positive integer defines the exact
iteration number.  A negative integer defines the iteration
relative to the last (e.g. -1 is the last iteration). A float
represents a fraction (0-&gt;1) of the number of rounds, and
a string may be parsed in many ways such as last, first, a float,
integer, or percentage (if suffixed with a %).</p>
</dd>
<dt><strong>rounds</strong><span class="classifier">int, optional</span></dt><dd><p>The maximum number of iterations.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.set_scaling">
<span class="sig-name descname"><span class="pre">set_scaling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.set_scaling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.set_scaling" title="Link to this definition">¶</a></dt>
<dd><p>Set the gain scaling for the integration.</p>
<p>The factor is applied relatively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>factor</strong><span class="classifier">float, optional</span></dt><dd><p>The factor by which to scale the integration gain.  Retrieved from
the configuration ‘scale’ option if not supplied.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.set_scan">
<span class="sig-name descname"><span class="pre">set_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scan</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.set_scan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.set_scan" title="Link to this definition">¶</a></dt>
<dd><p>Set the parent scan of the integration.</p>
<p>The info is copied from the scan, and the configuration is unlinked
(separate copy from the scan configuration).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>scan</strong><span class="classifier">Scan</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.set_tau">
<span class="sig-name descname"><span class="pre">set_tau</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.set_tau"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.set_tau" title="Link to this definition">¶</a></dt>
<dd><p>Set the tau values for the integration.</p>
<p>If a value is explicitly provided without a specification, will be used
to set the zenith tau if ground based, or transmission.  If a
specification and value is provided, will set the zenith tau as:</p>
<p>((band_a / t_a) * (value - t_b)) + band_b</p>
<p>where band_a/b are retrieved from the configuration as tau.&lt;spec&gt;.a/b,
and t_a/b are retrieved from the configuration as tau.&lt;instrument&gt;.a/b.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spec</strong><span class="classifier">str, optional</span></dt><dd><p>The tau specification to read from the configuration.  If not
supplied, will be read from the configuration ‘tau’ setting.</p>
</dd>
<dt><strong>value</strong><span class="classifier">float, optional</span></dt><dd><p>The tau value to set.  If not supplied, will be retrieved from the
configuration as tau.&lt;spec&gt;.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.set_tau_value">
<span class="sig-name descname"><span class="pre">set_tau_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.set_tau_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.set_tau_value" title="Link to this definition">¶</a></dt>
<dd><p>Set the zenith tau if ground based, or the transmission.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>value</strong><span class="classifier">float</span></dt><dd><p>The tau value.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.set_temp_despike_levels">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_temp_despike_levels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channel_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.set_temp_despike_levels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.set_temp_despike_levels" title="Link to this definition">¶</a></dt>
<dd><p>Set a temporary despiking level reference in the channel data.</p>
<p>The despiking reference level is set to sqrt(variance) * level, and
stored in the <code class="xref py py-obj docutils literal notranslate"><span class="pre">temp</span></code> attribute of the channel data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>channel_data</strong><span class="classifier">ChannelData</span></dt><dd><p>The channel data for which to set the despike reference level.</p>
</dd>
<dt><strong>level</strong><span class="classifier">float</span></dt><dd><p>The relative reference level.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.set_thread_count">
<span class="sig-name descname"><span class="pre">set_thread_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threads</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.set_thread_count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.set_thread_count" title="Link to this definition">¶</a></dt>
<dd><p>Set the number of parallel tasks for the integration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>threads</strong><span class="classifier">int</span></dt><dd><p>The number of parallel tasks to perform.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.set_weights_from_var_stats">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_weights_from_var_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channel_group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_sum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_weight</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.set_weights_from_var_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.set_weights_from_var_stats" title="Link to this definition">¶</a></dt>
<dd><p>Set channel weights from the calculated variance.</p>
<p>In addition to channel weights, the degrees of freedom (DOF) and
channel variances are also set for a given channel group where:</p>
<blockquote>
<div><p>DOF = 1 - (dependents / var_weight)
channel_variance = variance
weight = DOF / variance</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>channel_group</strong><span class="classifier">ChannelGroup or ChannelData</span></dt><dd><p>The channel group or data for which to set weights.  Should be of
size n_channels.</p>
</dd>
<dt><strong>var_sum: numpy.ndarray (float)</strong></dt><dd><p>The sum of weight * variance over all valid frames (n_channels,).</p>
</dd>
<dt><strong>var_weight</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The variance weights of shape (n_channels,).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.set_zenith_tau">
<span class="sig-name descname"><span class="pre">set_zenith_tau</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tau_value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.set_zenith_tau"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.set_zenith_tau" title="Link to this definition">¶</a></dt>
<dd><p>Set the zenith tau value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>tau_value</strong><span class="classifier">float</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.setup_filters">
<span class="sig-name descname"><span class="pre">setup_filters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.setup_filters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.setup_filters" title="Link to this definition">¶</a></dt>
<dd><p>Set up the FFT frame data filters.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.shift_frames">
<span class="sig-name descname"><span class="pre">shift_frames</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_or_frames</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.shift_frames"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.shift_frames" title="Link to this definition">¶</a></dt>
<dd><p>Shift the frame data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>time_or_frames</strong><span class="classifier">astropy.units.Quantity or int</span></dt><dd><p>The time or number of frames by which to shift frame data.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.slim">
<span class="sig-name descname"><span class="pre">slim</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.slim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.slim" title="Link to this definition">¶</a></dt>
<dd><p>Slim frame/channel type data to those channels still present.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>slimmed</strong><span class="classifier">bool</span></dt><dd><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> if any channels were removed, <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a> otherwise.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.trim">
<span class="sig-name descname"><span class="pre">trim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.trim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.trim" title="Link to this definition">¶</a></dt>
<dd><p>Remove invalid frames from the start and end of the integration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>start</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> (default), delete all frames before the first valid frame
in the integration.</p>
</dd>
<dt><strong>end</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> (default), delete all frames after the last valid frame.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.update_gains">
<span class="sig-name descname"><span class="pre">update_gains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modality_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">robust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.update_gains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.update_gains" title="Link to this definition">¶</a></dt>
<dd><p>Update gains in a modality following decorrelation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>modality_name</strong><span class="classifier">str</span></dt><dd><p>The name of the modality to update.</p>
</dd>
<dt><strong>robust</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, use the robust (median) method to derive means.
Otherwise, use a standard mean.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>updated</strong><span class="classifier">bool</span></dt><dd><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> if the modality gains were updated.  <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a> otherwise.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.update_inconsistencies">
<span class="sig-name descname"><span class="pre">update_inconsistencies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_dependents</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drift_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.update_inconsistencies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.update_inconsistencies" title="Link to this definition">¶</a></dt>
<dd><p>Check consistency of frame dependents and channels.</p>
<p>Looks for inconsistencies in the channel and frame data post levelling
and updates the <code class="xref py py-obj docutils literal notranslate"><span class="pre">inconsistencies</span></code> attribute of the channel data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>frame_dependents</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd></dd>
<dt><strong>channels</strong><span class="classifier">ChannelGroup</span></dt><dd></dd>
<dt><strong>drift_size</strong><span class="classifier">int</span></dt><dd><p>The size of the drift removal block size in frames.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.validate" title="Link to this definition">¶</a></dt>
<dd><p>Validate an integration following the initial read.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.velocity_clip">
<span class="sig-name descname"><span class="pre">velocity_clip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">speed_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_clip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.velocity_clip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.velocity_clip" title="Link to this definition">¶</a></dt>
<dd><p>Clip frames that are outside of the permissible scanning speed range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>speed_range</strong><span class="classifier">Range, optional</span></dt><dd><p>The minimum and maximum speeds are astropy.unit.Quantity values
in units of the default size unit per second.  If not supplied,
will be determined from the configuration via the
<a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_speed_clip_range" title="sofia_redux.scan.integration.integration.Integration.get_speed_clip_range"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_speed_clip_range</span></code></a> method, and the ‘vclip’ configuration value.</p>
</dd>
<dt><strong>strict</strong><span class="classifier">bool, optional</span></dt><dd><p>Strict (<a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>) velocity clipping completely invalidates all
rejected frames.  The alternative flags rejected frames with the
SKIP_SOURCE_MODELING flag.  The default is taken from the
‘vclip.strict’ configuration setting.</p>
</dd>
<dt><strong>sigma_clip</strong><span class="classifier">float, optional</span></dt><dd><p>Invalidates frame speeds using an iterative sigma clipping to
sequentially remove speeds that are <code class="xref py py-obj docutils literal notranslate"><span class="pre">sigma_clip</span></code> times the
standard deviation away from the median speed value.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.write_ascii_time_stream">
<span class="sig-name descname"><span class="pre">write_ascii_time_stream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.write_ascii_time_stream"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.write_ascii_time_stream" title="Link to this definition">¶</a></dt>
<dd><p>Write the frame data to a text file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename</strong><span class="classifier">str, optional</span></dt><dd><p>The name of the file to output the time stream results.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.write_coupling_gains">
<span class="sig-name descname"><span class="pre">write_coupling_gains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal_names</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.write_coupling_gains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.write_coupling_gains" title="Link to this definition">¶</a></dt>
<dd><p>Write the coupling gains to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>signal_names</strong><span class="classifier">list (str)</span></dt><dd><p>The signals to write.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.write_covariance_to_file">
<span class="sig-name descname"><span class="pre">write_covariance_to_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covariance</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.write_covariance_to_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.write_covariance_to_file" title="Link to this definition">¶</a></dt>
<dd><p>Write a covariance matrix to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename</strong><span class="classifier">str</span></dt><dd><p>The path of the file to write to.</p>
</dd>
<dt><strong>covariance</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The covariance matrix.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.write_covariances">
<span class="sig-name descname"><span class="pre">write_covariances</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.write_covariances"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.write_covariances" title="Link to this definition">¶</a></dt>
<dd><p>Write the covariances to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.write_products">
<span class="sig-name descname"><span class="pre">write_products</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.write_products"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.write_products" title="Link to this definition">¶</a></dt>
<dd><p>Write the integration products to an output file.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.write_scan_pattern">
<span class="sig-name descname"><span class="pre">write_scan_pattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.write_scan_pattern"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.write_scan_pattern" title="Link to this definition">¶</a></dt>
<dd><p>Write the scan pattern to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename</strong><span class="classifier">str, optional</span></dt><dd><p>The path to the output file.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.integration.integration.Integration.write_spectra">
<span class="sig-name descname"><span class="pre">write_spectra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/integration/integration.html#Integration.write_spectra"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.integration.integration.Integration.write_spectra" title="Link to this definition">¶</a></dt>
<dd><p>Write the spectra to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>window_name</strong><span class="classifier">str, optional</span></dt><dd><p>The name of the filtering window.  If not supplied, will be
extracted from the configuration option “write.spectrum” or default
to ‘Hamming’ if not found.</p>
</dd>
<dt><strong>window_size</strong><span class="classifier">int, optional</span></dt><dd><p>The size of the filtering window.  Will be extracted from the
configuration option “write.spectrum.size” if not supplied.  If
not found in the configuration, the default will be 2 times the
number of frames in the filtering time scale.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Integration</a><ul>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration"><code class="docutils literal notranslate"><span class="pre">Integration</span></code></a><ul>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.channel_flagspace"><code class="docutils literal notranslate"><span class="pre">Integration.channel_flagspace</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.configuration"><code class="docutils literal notranslate"><span class="pre">Integration.configuration</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.flagspace"><code class="docutils literal notranslate"><span class="pre">Integration.flagspace</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.info"><code class="docutils literal notranslate"><span class="pre">Integration.info</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.instrument_name"><code class="docutils literal notranslate"><span class="pre">Integration.instrument_name</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.motion_flagspace"><code class="docutils literal notranslate"><span class="pre">Integration.motion_flagspace</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.n_channels"><code class="docutils literal notranslate"><span class="pre">Integration.n_channels</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.reference_attributes"><code class="docutils literal notranslate"><span class="pre">Integration.reference_attributes</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.scan_astrometry"><code class="docutils literal notranslate"><span class="pre">Integration.scan_astrometry</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.size"><code class="docutils literal notranslate"><span class="pre">Integration.size</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.acceleration_clip"><code class="docutils literal notranslate"><span class="pre">Integration.acceleration_clip()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.acceleration_cut"><code class="docutils literal notranslate"><span class="pre">Integration.acceleration_cut()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.add_dependents"><code class="docutils literal notranslate"><span class="pre">Integration.add_dependents()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.add_details"><code class="docutils literal notranslate"><span class="pre">Integration.add_details()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.add_signal"><code class="docutils literal notranslate"><span class="pre">Integration.add_signal()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.apply_configuration"><code class="docutils literal notranslate"><span class="pre">Integration.apply_configuration()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.apply_notch_filter"><code class="docutils literal notranslate"><span class="pre">Integration.apply_notch_filter()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.bootstrap_weights"><code class="docutils literal notranslate"><span class="pre">Integration.bootstrap_weights()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.calculate_scan_speed_stats"><code class="docutils literal notranslate"><span class="pre">Integration.calculate_scan_speed_stats()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.calculate_source_nefd"><code class="docutils literal notranslate"><span class="pre">Integration.calculate_source_nefd()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.check_consistency"><code class="docutils literal notranslate"><span class="pre">Integration.check_consistency()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.check_range"><code class="docutils literal notranslate"><span class="pre">Integration.check_range()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.clone"><code class="docutils literal notranslate"><span class="pre">Integration.clone()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.condense_covariance"><code class="docutils literal notranslate"><span class="pre">Integration.condense_covariance()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.copy"><code class="docutils literal notranslate"><span class="pre">Integration.copy()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.decorrelate"><code class="docutils literal notranslate"><span class="pre">Integration.decorrelate()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.decorrelate_signals"><code class="docutils literal notranslate"><span class="pre">Integration.decorrelate_signals()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.dejump_frames"><code class="docutils literal notranslate"><span class="pre">Integration.dejump_frames()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.despike"><code class="docutils literal notranslate"><span class="pre">Integration.despike()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.despike_absolute"><code class="docutils literal notranslate"><span class="pre">Integration.despike_absolute()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.despike_gradual"><code class="docutils literal notranslate"><span class="pre">Integration.despike_gradual()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.despike_multi_resolution"><code class="docutils literal notranslate"><span class="pre">Integration.despike_multi_resolution()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.despike_neighbouring"><code class="docutils literal notranslate"><span class="pre">Integration.despike_neighbouring()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.detector_stage"><code class="docutils literal notranslate"><span class="pre">Integration.detector_stage()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.downsample"><code class="docutils literal notranslate"><span class="pre">Integration.downsample()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.downsampling_window"><code class="docutils literal notranslate"><span class="pre">Integration.downsampling_window()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.fill_gaps"><code class="docutils literal notranslate"><span class="pre">Integration.fill_gaps()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.filter_frames_for"><code class="docutils literal notranslate"><span class="pre">Integration.filter_frames_for()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.flag_spiky_blocks"><code class="docutils literal notranslate"><span class="pre">Integration.flag_spiky_blocks()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.flag_spiky_channels"><code class="docutils literal notranslate"><span class="pre">Integration.flag_spiky_channels()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.flag_spiky_frames"><code class="docutils literal notranslate"><span class="pre">Integration.flag_spiky_frames()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.flag_weights"><code class="docutils literal notranslate"><span class="pre">Integration.flag_weights()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.frames_for"><code class="docutils literal notranslate"><span class="pre">Integration.frames_for()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_acceleration_signal"><code class="docutils literal notranslate"><span class="pre">Integration.get_acceleration_signal()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_accelerations"><code class="docutils literal notranslate"><span class="pre">Integration.get_accelerations()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_ascii_header"><code class="docutils literal notranslate"><span class="pre">Integration.get_ascii_header()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_channel_weights"><code class="docutils literal notranslate"><span class="pre">Integration.get_channel_weights()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_correlated_signal_class"><code class="docutils literal notranslate"><span class="pre">Integration.get_correlated_signal_class()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_coupling_gains"><code class="docutils literal notranslate"><span class="pre">Integration.get_coupling_gains()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_covariance"><code class="docutils literal notranslate"><span class="pre">Integration.get_covariance()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_crossing_time"><code class="docutils literal notranslate"><span class="pre">Integration.get_crossing_time()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_default_scaling_factor"><code class="docutils literal notranslate"><span class="pre">Integration.get_default_scaling_factor()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_dependents"><code class="docutils literal notranslate"><span class="pre">Integration.get_dependents()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_differential_channel_weights"><code class="docutils literal notranslate"><span class="pre">Integration.get_differential_channel_weights()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_display_id"><code class="docutils literal notranslate"><span class="pre">Integration.get_display_id()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_downsample_factor"><code class="docutils literal notranslate"><span class="pre">Integration.get_downsample_factor()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_duration"><code class="docutils literal notranslate"><span class="pre">Integration.get_duration()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_exposure_time"><code class="docutils literal notranslate"><span class="pre">Integration.get_exposure_time()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_file_id"><code class="docutils literal notranslate"><span class="pre">Integration.get_file_id()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_filter"><code class="docutils literal notranslate"><span class="pre">Integration.get_filter()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_first_frame"><code class="docutils literal notranslate"><span class="pre">Integration.get_first_frame()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_first_frame_index"><code class="docutils literal notranslate"><span class="pre">Integration.get_first_frame_index()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_fits_data"><code class="docutils literal notranslate"><span class="pre">Integration.get_fits_data()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_floats"><code class="docutils literal notranslate"><span class="pre">Integration.get_floats()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_frame_count"><code class="docutils literal notranslate"><span class="pre">Integration.get_frame_count()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_frame_gaps"><code class="docutils literal notranslate"><span class="pre">Integration.get_frame_gaps()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_full_covariance"><code class="docutils literal notranslate"><span class="pre">Integration.get_full_covariance()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_full_id"><code class="docutils literal notranslate"><span class="pre">Integration.get_full_id()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_group_covariance"><code class="docutils literal notranslate"><span class="pre">Integration.get_group_covariance()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_id"><code class="docutils literal notranslate"><span class="pre">Integration.get_id()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_integration_class"><code class="docutils literal notranslate"><span class="pre">Integration.get_integration_class()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_last_frame"><code class="docutils literal notranslate"><span class="pre">Integration.get_last_frame()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_last_frame_index"><code class="docutils literal notranslate"><span class="pre">Integration.get_last_frame_index()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_mean_level"><code class="docutils literal notranslate"><span class="pre">Integration.get_mean_level()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_mjd"><code class="docutils literal notranslate"><span class="pre">Integration.get_mjd()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_modulation_frequency"><code class="docutils literal notranslate"><span class="pre">Integration.get_modulation_frequency()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_pa"><code class="docutils literal notranslate"><span class="pre">Integration.get_pa()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_point_crossing_time"><code class="docutils literal notranslate"><span class="pre">Integration.get_point_crossing_time()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_position_signal"><code class="docutils literal notranslate"><span class="pre">Integration.get_position_signal()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_positions"><code class="docutils literal notranslate"><span class="pre">Integration.get_positions()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_rms_channel_weights"><code class="docutils literal notranslate"><span class="pre">Integration.get_rms_channel_weights()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_robust_channel_weights"><code class="docutils literal notranslate"><span class="pre">Integration.get_robust_channel_weights()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_scanning_velocities"><code class="docutils literal notranslate"><span class="pre">Integration.get_scanning_velocities()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_signal"><code class="docutils literal notranslate"><span class="pre">Integration.get_signal()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_smooth_positions"><code class="docutils literal notranslate"><span class="pre">Integration.get_smooth_positions()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_spectra"><code class="docutils literal notranslate"><span class="pre">Integration.get_spectra()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_speed_clip_range"><code class="docutils literal notranslate"><span class="pre">Integration.get_speed_clip_range()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_standard_id"><code class="docutils literal notranslate"><span class="pre">Integration.get_standard_id()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_table_entry"><code class="docutils literal notranslate"><span class="pre">Integration.get_table_entry()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_tau"><code class="docutils literal notranslate"><span class="pre">Integration.get_tau()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_tau_coefficients"><code class="docutils literal notranslate"><span class="pre">Integration.get_tau_coefficients()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_thread_count"><code class="docutils literal notranslate"><span class="pre">Integration.get_thread_count()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_time_stream"><code class="docutils literal notranslate"><span class="pre">Integration.get_time_stream()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_time_weights"><code class="docutils literal notranslate"><span class="pre">Integration.get_time_weights()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_typical_scanning_speed"><code class="docutils literal notranslate"><span class="pre">Integration.get_typical_scanning_speed()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.get_velocities"><code class="docutils literal notranslate"><span class="pre">Integration.get_velocities()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.has_gaps"><code class="docutils literal notranslate"><span class="pre">Integration.has_gaps()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.has_option"><code class="docutils literal notranslate"><span class="pre">Integration.has_option()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.jackknife"><code class="docutils literal notranslate"><span class="pre">Integration.jackknife()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.level"><code class="docutils literal notranslate"><span class="pre">Integration.level()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.local_level"><code class="docutils literal notranslate"><span class="pre">Integration.local_level()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.merge"><code class="docutils literal notranslate"><span class="pre">Integration.merge()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.next_iteration"><code class="docutils literal notranslate"><span class="pre">Integration.next_iteration()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.next_weight_transit"><code class="docutils literal notranslate"><span class="pre">Integration.next_weight_transit()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.notch_filter"><code class="docutils literal notranslate"><span class="pre">Integration.notch_filter()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.offset"><code class="docutils literal notranslate"><span class="pre">Integration.offset()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.perform"><code class="docutils literal notranslate"><span class="pre">Integration.perform()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.pointing_at"><code class="docutils literal notranslate"><span class="pre">Integration.pointing_at()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.power2_frames_for"><code class="docutils literal notranslate"><span class="pre">Integration.power2_frames_for()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.process_notch_filter_block"><code class="docutils literal notranslate"><span class="pre">Integration.process_notch_filter_block()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.readout_stage"><code class="docutils literal notranslate"><span class="pre">Integration.readout_stage()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.reindex"><code class="docutils literal notranslate"><span class="pre">Integration.reindex()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.reindex_channels"><code class="docutils literal notranslate"><span class="pre">Integration.reindex_channels()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.reindex_frames"><code class="docutils literal notranslate"><span class="pre">Integration.reindex_frames()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.remove_channel_drifts"><code class="docutils literal notranslate"><span class="pre">Integration.remove_channel_drifts()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.remove_dc_offsets"><code class="docutils literal notranslate"><span class="pre">Integration.remove_dc_offsets()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.remove_drifts"><code class="docutils literal notranslate"><span class="pre">Integration.remove_drifts()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.remove_offsets"><code class="docutils literal notranslate"><span class="pre">Integration.remove_offsets()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.scale"><code class="docutils literal notranslate"><span class="pre">Integration.scale()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.search_corners"><code class="docutils literal notranslate"><span class="pre">Integration.search_corners()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.select_frames"><code class="docutils literal notranslate"><span class="pre">Integration.select_frames()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.set_iteration"><code class="docutils literal notranslate"><span class="pre">Integration.set_iteration()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.set_scaling"><code class="docutils literal notranslate"><span class="pre">Integration.set_scaling()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.set_scan"><code class="docutils literal notranslate"><span class="pre">Integration.set_scan()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.set_tau"><code class="docutils literal notranslate"><span class="pre">Integration.set_tau()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.set_tau_value"><code class="docutils literal notranslate"><span class="pre">Integration.set_tau_value()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.set_temp_despike_levels"><code class="docutils literal notranslate"><span class="pre">Integration.set_temp_despike_levels()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.set_thread_count"><code class="docutils literal notranslate"><span class="pre">Integration.set_thread_count()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.set_weights_from_var_stats"><code class="docutils literal notranslate"><span class="pre">Integration.set_weights_from_var_stats()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.set_zenith_tau"><code class="docutils literal notranslate"><span class="pre">Integration.set_zenith_tau()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.setup_filters"><code class="docutils literal notranslate"><span class="pre">Integration.setup_filters()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.shift_frames"><code class="docutils literal notranslate"><span class="pre">Integration.shift_frames()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.slim"><code class="docutils literal notranslate"><span class="pre">Integration.slim()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.trim"><code class="docutils literal notranslate"><span class="pre">Integration.trim()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.update_gains"><code class="docutils literal notranslate"><span class="pre">Integration.update_gains()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.update_inconsistencies"><code class="docutils literal notranslate"><span class="pre">Integration.update_inconsistencies()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.validate"><code class="docutils literal notranslate"><span class="pre">Integration.validate()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.velocity_clip"><code class="docutils literal notranslate"><span class="pre">Integration.velocity_clip()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.write_ascii_time_stream"><code class="docutils literal notranslate"><span class="pre">Integration.write_ascii_time_stream()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.write_coupling_gains"><code class="docutils literal notranslate"><span class="pre">Integration.write_coupling_gains()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.write_covariance_to_file"><code class="docutils literal notranslate"><span class="pre">Integration.write_covariance_to_file()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.write_covariances"><code class="docutils literal notranslate"><span class="pre">Integration.write_covariances()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.write_products"><code class="docutils literal notranslate"><span class="pre">Integration.write_products()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.write_scan_pattern"><code class="docutils literal notranslate"><span class="pre">Integration.write_scan_pattern()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.integration.integration.Integration.write_spectra"><code class="docutils literal notranslate"><span class="pre">Integration.write_spectra()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/sofia_redux.scan.integration.integration.Integration.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2024, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.2.6. &nbsp;
    Last built 05 Feb 2024. <br/>
  </p>
</footer>
  </body>
</html>