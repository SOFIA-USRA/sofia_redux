<!DOCTYPE html>

<html lang="en" data-content_root="../../../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>sofia_redux.scan.simulation.source_models.sky &#8212; sofia_redux v1.3.4.dev38+g92ea2f4</title>
    <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/plot_directive.css" />
    
    <script src="../../../../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../../../../_static/documentation_options.js?v=6aa39468"></script>
    <script src="../../../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script type="text/javascript" src="../../../../../_static/sidebar.js"></script>
    <script type="text/javascript" src="../../../../../_static/copybutton.js"></script>
    <link rel="icon" href="../../../../../_static/redux.ico"/>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../../../../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://irsa.ipac.caltech.edu/Missions/sofia.html"></a></li>
    <li><a title="General Index" href="../../../../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../../../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li>
	<a href="../../../../../index.html">sofia_redux v1.3.4.dev38+g92ea2f4</a>
	 &#187;
      </li>
      <li><a href="../../../../index.html" accesskey="U">Module code</a> &#187;</li>
      
       
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for sofia_redux.scan.simulation.source_models.sky</h1><div class="highlight"><pre>
<span></span># Licensed under a 3-clause BSD style license - see LICENSE.rst

from astropy import units
from copy import deepcopy

from sofia_redux.scan.simulation.source_models.simulated_source import (
    SimulatedSource)
from sofia_redux.scan.source_models.sky_dip_model import SkyDipModel

__all__ = [&#39;Sky&#39;]


<div class="viewcode-block" id="Sky">
<a class="viewcode-back" href="../../../../../api/sofia_redux.scan.simulation.source_models.sky.Sky.html#sofia_redux.scan.simulation.source_models.sky.Sky">[docs]</a>
class Sky(SimulatedSource):

    def __init__(self, **kwargs):
        &quot;&quot;&quot;
        Initialize a simulated sky source.

        The sky source model may only operate on horizontal type coordinate
        systems, since only elevation is of concern.  The sky is modelled
        as::

          data = offset - ((exp(-tau / sin(elevation)) - 1) * tsky * scaling)

        Where offset is a DC temperature offset in Kelvins, tsky is the
        sky temperature in Kelvins, tau is the atmospheric opacity, and scaling
        gives the appropriate temperature scaling for the instrument.  If not
        supplied, the defaults are tau = 0.1, offset = 0K, tsky = 273K, and
        scaling = 1.

        Parameters
        ----------
        kwargs : dict, optional
        &quot;&quot;&quot;
        super().__init__()
        self.name = &#39;sky&#39;
        self.model = SkyDipModel()
        self.tau = 0.1
        self.t_offset = 0.0 * units.Unit(&#39;Kelvin&#39;)
        self.scaling = 1.0
        self.t_sky = 273 * units.Unit(&#39;Kelvin&#39;)
        self.initialize_model(**kwargs)

<div class="viewcode-block" id="Sky.initialize_model">
<a class="viewcode-back" href="../../../../../api/sofia_redux.scan.simulation.source_models.sky.Sky.html#sofia_redux.scan.simulation.source_models.sky.Sky.initialize_model">[docs]</a>
    def initialize_model(self, **kwargs):
        &quot;&quot;&quot;
        Initialize the model with the provided options.

        Parameters
        ----------
        kwargs : dict, optional
            The available keys are &#39;tau&#39;, &#39;scaling&#39;, &#39;tsky&#39;, and &#39;offset&#39;.
            tsky and offset will be converted to Kelvins if not supplied as
            `units.Quantity` values.

        Returns
        -------
        None
        &quot;&quot;&quot;
        options = deepcopy(kwargs)
        self.tau = float(options.get(&#39;tau&#39;, 0.1))
        self.scaling = float(options.get(&#39;scaling&#39;, 1.0))
        self.t_sky = options.get(&#39;tsky&#39;, 273)
        if not isinstance(self.t_sky, units.Quantity):
            self.t_sky = self.t_sky * units.Unit(&#39;Kelvin&#39;)
        self.t_offset = options.get(&#39;offset&#39;, 0.0)
        if not isinstance(self.t_offset, units.Quantity):
            self.t_offset = self.t_offset * units.Unit(&#39;Kelvin&#39;)</div>


<div class="viewcode-block" id="Sky.apply_to_offsets">
<a class="viewcode-back" href="../../../../../api/sofia_redux.scan.simulation.source_models.sky.Sky.html#sofia_redux.scan.simulation.source_models.sky.Sky.apply_to_offsets">[docs]</a>
    def apply_to_offsets(self, offsets):
        &quot;&quot;&quot;
        Apply the source model to a set of 2-D offsets.

        Parameters
        ----------
        offsets : Coordinate2D
            Equatorial native offsets.

        Returns
        -------
        data : numpy.ndarray
            The modelled data of the source given the offsets.
        &quot;&quot;&quot;
        raise NotImplementedError(&quot;Can only determine sky from horizontal &quot;
                                  &quot;coordinates.&quot;)</div>


<div class="viewcode-block" id="Sky.apply_to_horizontal">
<a class="viewcode-back" href="../../../../../api/sofia_redux.scan.simulation.source_models.sky.Sky.html#sofia_redux.scan.simulation.source_models.sky.Sky.apply_to_horizontal">[docs]</a>
    def apply_to_horizontal(self, horizontal):
        &quot;&quot;&quot;
        Apply the source model to a set of 2-D offsets.

        Parameters
        ----------
        horizontal : HorizontalCoordinates
            HorizontalCoordinates.

        Returns
        -------
        data : numpy.ndarray
            The modelled data of the source given the offsets.
        &quot;&quot;&quot;
        elevation = horizontal.el.to(&#39;radian&#39;).value
        tau = self.tau
        offset = self.t_offset.to(&#39;Kelvin&#39;).value
        kelvin = self.scaling
        tsky = self.t_sky.to(&#39;Kelvin&#39;).value
        return self.model.value_at(elevation, tau, offset, kelvin, tsky)</div>
</div>

</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right"> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2024, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.2.6. &nbsp;
    Last built 05 Feb 2024. <br/>
  </p>
</footer>
  </body>
</html>