<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>AstroIntensityMap &#8212; sofia_redux v1.3.4.dev38+g92ea2f4</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=6aa39468"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="icon" href="../_static/redux.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="AstroModel2D" href="sofia_redux.scan.source_models.astro_model_2d.AstroModel2D.html" />
    <link rel="prev" title="AstroData2D" href="sofia_redux.scan.source_models.astro_data_2d.AstroData2D.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://irsa.ipac.caltech.edu/Missions/sofia.html"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="sofia_redux.scan.source_models.astro_model_2d.AstroModel2D.html" title="AstroModel2D">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="sofia_redux.scan.source_models.astro_data_2d.AstroData2D.html" title="AstroData2D">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">sofia_redux v1.3.4.dev38+g92ea2f4</a>
	 &#187;
      </li>
      <li><a href="../sofia_redux/index.html" >SOFIA Redux</a> &#187;</li>
      <li><a href="../sofia_redux/scan/index.html" accesskey="U">sofia_redux.scan: Scan Mode Algorithms for SOFIA Pipelines</a> &#187;</li>
      
      <li>AstroIntensityMap</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="astrointensitymap">
<h1>AstroIntensityMap<a class="headerlink" href="#astrointensitymap" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sofia_redux.scan.source_models.astro_intensity_map.</span></span><span class="sig-name descname"><span class="pre">AstroIntensityMap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="sofia_redux.scan.source_models.astro_data_2d.AstroData2D.html#sofia_redux.scan.source_models.astro_data_2d.AstroData2D" title="sofia_redux.scan.source_models.astro_data_2d.AstroData2D"><code class="xref py py-class docutils literal notranslate"><span class="pre">AstroData2D</span></code></a></p>
<p>Initialize an astronomical intensity map.</p>
<p>The astronomical intensity map represents the source as an
<code class="xref py py-class docutils literal notranslate"><span class="pre">Observation2D</span></code> map containing data, noise, and exposure values.
It also contains a base image containing the results of the previous
reduction iteration in order to calculate gain and coupling increments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>info</strong><span class="classifier">sofia_redux.scan.info.info.Info</span></dt><dd><p>The Info object which should belong to this source model.</p>
</dd>
<dt><strong>reduction</strong><span class="classifier">sofia_redux.scan.reduction.reduction.Reduction, optional</span></dt><dd><p>The reduction for which this source model should be applied.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Attributes Summary</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.flagspace" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.flagspace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">flagspace</span></code></a></p></td>
<td><p>Return the flagspace associated with the underlying map observation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.referenced_attributes" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.referenced_attributes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">referenced_attributes</span></code></a></p></td>
<td><p>Return attributes that should be referenced during a copy.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.shape" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.shape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shape</span></code></a></p></td>
<td><p>Return the shape of the map.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods Summary</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.add_base" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.add_base"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_base</span></code></a>()</p></td>
<td><p>Add the base to the observation map.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.add_frames_from_integration" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.add_frames_from_integration"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_frames_from_integration</span></code></a>(integration, ...)</p></td>
<td><p>Add frames from an integration to the source model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.add_model_data" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.add_model_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_model_data</span></code></a>(source_model[, weight])</p></td>
<td><p>Add an increment source model data onto the current model.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.add_points" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.add_points"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_points</span></code></a>(frames, pixels, frame_gains, ...)</p></td>
<td><p>Add points to the source model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.base_footprint" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.base_footprint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">base_footprint</span></code></a>(pixels)</p></td>
<td><p>Returns the base footprint.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.calculate_coupling" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.calculate_coupling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_coupling</span></code></a>(integration, pixels, ...)</p></td>
<td><p>Calculate the channel source coupling values.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.clear_all_memory" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.clear_all_memory"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear_all_memory</span></code></a>()</p></td>
<td><p>Clear all memory references prior to deletion.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.copy" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a>([with_contents])</p></td>
<td><p>Return a copy of the source model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.covariant_points" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.covariant_points"><code class="xref py py-obj docutils literal notranslate"><span class="pre">covariant_points</span></code></a>()</p></td>
<td><p>Return the number of points in the smoothing beam of the map.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.create_from" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.create_from"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_from</span></code></a>(scans[, assign_scans])</p></td>
<td><p>Initialize model from scans.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.create_map" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.create_map"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_map</span></code></a>()</p></td>
<td><p>Create the source model map.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.filter_beam_correct" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.filter_beam_correct"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_beam_correct</span></code></a>()</p></td>
<td><p>Apply beam filter correction.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.filter_source" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.filter_source"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_source</span></code></a>(filter_fwhm[, ...])</p></td>
<td><p>Apply source filtering.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_clean_local_copy" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_clean_local_copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_clean_local_copy</span></code></a>([full])</p></td>
<td><p>Get an unprocessed copy of the source model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_data" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_data</span></code></a>()</p></td>
<td><p>Return the map data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_jansky_unit" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_jansky_unit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_jansky_unit</span></code></a>()</p></td>
<td><p>Return the Jansky's per unit area.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_map_2d" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_map_2d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_map_2d</span></code></a>()</p></td>
<td><p>Return the 2D map.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_peak_coords" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_peak_coords"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_peak_coords</span></code></a>()</p></td>
<td><p>Return the coordinates of the peak value.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_peak_index" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_peak_index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_peak_index</span></code></a>()</p></td>
<td><p>Return the peak index.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_peak_source" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_peak_source"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_peak_source</span></code></a>([degree, reduce_degrees])</p></td>
<td><p>Return the peak source model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_pixel_footprint" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_pixel_footprint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_pixel_footprint</span></code></a>()</p></td>
<td><p>Returns the Number of bytes per pixel.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_source_name" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_source_name"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_source_name</span></code></a>()</p></td>
<td><p>Return the source name.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_table_entry" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_table_entry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_table_entry</span></code></a>(name)</p></td>
<td><p>Return a parameter value for a given name.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_unit" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_unit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_unit</span></code></a>()</p></td>
<td><p>Return the map data unit.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.is_masked" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.is_masked"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_masked</span></code></a>()</p></td>
<td><p>Return the map mask.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.mask_integration_samples" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.mask_integration_samples"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mask_integration_samples</span></code></a>(integration[, flag])</p></td>
<td><p>Set the sample flag in an integration for masked map elements.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.mask_samples" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.mask_samples"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mask_samples</span></code></a>([flag])</p></td>
<td><p>Propagate masked source samples to integration sample flags.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.mem_correct" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.mem_correct"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mem_correct</span></code></a>(lg_multiplier)</p></td>
<td><p>Apply maximum entropy correction to the map.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.merge_accumulate" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.merge_accumulate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">merge_accumulate</span></code></a>(other)</p></td>
<td><p>Merge another source with this one.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.merge_mask" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.merge_mask"><code class="xref py py-obj docutils literal notranslate"><span class="pre">merge_mask</span></code></a>(other_map)</p></td>
<td><p>Merge the mask from another map onto this one.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.post_process_scan" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.post_process_scan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">post_process_scan</span></code></a>(scan)</p></td>
<td><p>Perform post-processing steps on a scan.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.process_final" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.process_final"><code class="xref py py-obj docutils literal notranslate"><span class="pre">process_final</span></code></a>()</p></td>
<td><p>Perform the final processing steps.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.reset_filtering" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.reset_filtering"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset_filtering</span></code></a>()</p></td>
<td><p>Reset the map filtering.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.reset_processing" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.reset_processing"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset_processing</span></code></a>()</p></td>
<td><p>Reset the source processing.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.set_base" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.set_base"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_base</span></code></a>()</p></td>
<td><p>Set the base to the map (copy of).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.set_data_shape" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.set_data_shape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_data_shape</span></code></a>(shape)</p></td>
<td><p>Set the shape of the map.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.set_filtering" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.set_filtering"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_filtering</span></code></a>(fwhm)</p></td>
<td><p>Set the map filtering FWHM.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.set_info" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.set_info"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_info</span></code></a>(info)</p></td>
<td><p>Set the Info object for the source model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.smooth_to" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.smooth_to"><code class="xref py py-obj docutils literal notranslate"><span class="pre">smooth_to</span></code></a>(fwhm)</p></td>
<td><p>Smooth the map to a given FWHM.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.stand_alone" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.stand_alone"><code class="xref py py-obj docutils literal notranslate"><span class="pre">stand_alone</span></code></a>()</p></td>
<td><p>Create a stand alone base image.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.sync_source_gains" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.sync_source_gains"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sync_source_gains</span></code></a>(frames, pixels, ...)</p></td>
<td><p>Remove the map source from frame data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.update_mask" title="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.update_mask"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_mask</span></code></a>([blanking_level, min_neighbors])</p></td>
<td><p>Update the map mask based on significance levels and valid neighbors.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes Documentation</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.flagspace">
<span class="sig-name descname"><span class="pre">flagspace</span></span><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.flagspace" title="Link to this definition">¶</a></dt>
<dd><p>Return the flagspace associated with the underlying map observation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>sofia_redux.scan.flags.flags.Flag</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.referenced_attributes">
<span class="sig-name descname"><span class="pre">referenced_attributes</span></span><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.referenced_attributes" title="Link to this definition">¶</a></dt>
<dd><p>Return attributes that should be referenced during a copy.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>set (str)</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.shape">
<span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.shape" title="Link to this definition">¶</a></dt>
<dd><p>Return the shape of the map.</p>
<p>Note that this is in numpy (y, x) order.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>tuple of int</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<p class="rubric">Methods Documentation</p>
<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.add_base">
<span class="sig-name descname"><span class="pre">add_base</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.add_base"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.add_base" title="Link to this definition">¶</a></dt>
<dd><p>Add the base to the observation map.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.add_frames_from_integration">
<span class="sig-name descname"><span class="pre">add_frames_from_integration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">integration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_gains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.add_frames_from_integration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.add_frames_from_integration" title="Link to this definition">¶</a></dt>
<dd><p>Add frames from an integration to the source model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>integration</strong><span class="classifier">Integration</span></dt><dd><p>The integration to add.</p>
</dd>
<dt><strong>pixels</strong><span class="classifier">ChannelGroup</span></dt><dd><p>The channels (pixels) to add to the source model.</p>
</dd>
<dt><strong>source_gains</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The source gains for the all channels (pixels).  Should be of
shape (all_channels,).</p>
</dd>
<dt><strong>signal_mode</strong><span class="classifier">FrameFlagTypes, optional</span></dt><dd><p>The signal mode flag, indicating which signal should be used to
extract the frame source gains.  Typically, TOTAL_POWER.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mapping_frames</strong><span class="classifier">int</span></dt><dd><p>The number of frames that contributed towards mapping.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.add_model_data">
<span class="sig-name descname"><span class="pre">add_model_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.add_model_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.add_model_data" title="Link to this definition">¶</a></dt>
<dd><p>Add an increment source model data onto the current model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>source_model</strong><span class="classifier">AstroIntensityMap</span></dt><dd><p>The source model increment.</p>
</dd>
<dt><strong>weight</strong><span class="classifier">float, optional</span></dt><dd><p>The weight of the source model increment.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.add_points">
<span class="sig-name descname"><span class="pre">add_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_gains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_gains</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.add_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.add_points" title="Link to this definition">¶</a></dt>
<dd><p>Add points to the source model.</p>
<p>Accumulates the combined frame and channel data to the source map
for each frame/channel sample.  If a given sample maps to a single map
pixel, that pixel is incremented by:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>i = frame_data * weights * gains
w = weights * gains^2
weights = frame_weight / channel_variance
gains = frame_gain * channel_gain
</pre></div>
</div>
<p>where i is the weighted data increment, and w is the weight increment.
The exposure values are also added to by simply incrementing the time
at any pixel by the sampling interval multiplied by the number of
samples falling within that pixel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>frames</strong><span class="classifier">Frames</span></dt><dd><p>The frames to add to the source model.</p>
</dd>
<dt><strong>pixels</strong><span class="classifier">ChannelGroup</span></dt><dd><p>The channels (pixels) to add to the source model.</p>
</dd>
<dt><strong>frame_gains</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The gain values for all frames of shape (n_frames,).</p>
</dd>
<dt><strong>source_gains</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The channel source gains for all channels of shape (all_channels,).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mapping_frames</strong><span class="classifier">int</span></dt><dd><p>The number of valid mapping frames added for the model.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.base_footprint">
<span class="sig-name descname"><span class="pre">base_footprint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pixels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.base_footprint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.base_footprint" title="Link to this definition">¶</a></dt>
<dd><p>Returns the base footprint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>pixels</strong><span class="classifier">int</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>int</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.calculate_coupling">
<span class="sig-name descname"><span class="pre">calculate_coupling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">integration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_gains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sync_gains</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.calculate_coupling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.calculate_coupling" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the channel source coupling values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>integration</strong><span class="classifier">Integration</span></dt><dd></dd>
<dt><strong>pixels</strong><span class="classifier">Channels or ChannelGroup</span></dt><dd><p>The pixels for which to calculate coupling.</p>
</dd>
<dt><strong>source_gains</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The source gains for all frames in the integration of shape
(n_frames,).</p>
</dd>
<dt><strong>sync_gains</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>The sync gains for all channels in the integration of shape
(all_channels,).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.clear_all_memory">
<span class="sig-name descname"><span class="pre">clear_all_memory</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.clear_all_memory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.clear_all_memory" title="Link to this definition">¶</a></dt>
<dd><p>Clear all memory references prior to deletion.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">with_contents</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.copy" title="Link to this definition">¶</a></dt>
<dd><p>Return a copy of the source model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>with_contents</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, return a true copy of the map.  Otherwise, just return
a map with basic metadata.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>AstroIntensityMap</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.covariant_points">
<span class="sig-name descname"><span class="pre">covariant_points</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.covariant_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.covariant_points" title="Link to this definition">¶</a></dt>
<dd><p>Return the number of points in the smoothing beam of the map.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>float</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.create_from">
<span class="sig-name descname"><span class="pre">create_from</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scans</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assign_scans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.create_from"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.create_from" title="Link to this definition">¶</a></dt>
<dd><p>Initialize model from scans.</p>
<p>Sets the model scans to those provided, and the source model for each
scan as this.  All integration gains are normalized to the first scan.
If the first scan is non-sidereal, the system will be forced to an
equatorial frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>scans</strong><span class="classifier">list (Scan)</span></dt><dd><p>A list of scans from which to create the model.</p>
</dd>
<dt><strong>assign_scans</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, assign the scans to this source model.  Otherwise,
there will be no hard link between the scans and source model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.create_map">
<span class="sig-name descname"><span class="pre">create_map</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.create_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.create_map" title="Link to this definition">¶</a></dt>
<dd><p>Create the source model map.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.filter_beam_correct">
<span class="sig-name descname"><span class="pre">filter_beam_correct</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.filter_beam_correct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.filter_beam_correct" title="Link to this definition">¶</a></dt>
<dd><p>Apply beam filter correction.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.filter_source">
<span class="sig-name descname"><span class="pre">filter_source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter_fwhm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_blanking</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_fft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.filter_source"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.filter_source" title="Link to this definition">¶</a></dt>
<dd><p>Apply source filtering.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filter_fwhm</strong><span class="classifier">astropy.units.Quantity or Coordinate</span></dt><dd><p>The filtering FWHM for the source.</p>
</dd>
<dt><strong>filter_blanking</strong><span class="classifier">float, optional</span></dt><dd><p>Only apply filtering within the optional range -filter_blanking -&gt;
+filter_blanking.</p>
</dd>
<dt><strong>use_fft</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, use FFTs to perform the filtering.  Otherwise, do full
convolutions.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_clean_local_copy">
<span class="sig-name descname"><span class="pre">get_clean_local_copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.get_clean_local_copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_clean_local_copy" title="Link to this definition">¶</a></dt>
<dd><p>Get an unprocessed copy of the source model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>full</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, copy additional parameters for stand-alone reductions
that would otherwise be referenced.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>SourceModel</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.get_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_data" title="Link to this definition">¶</a></dt>
<dd><p>Return the map data.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Observation2D</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_jansky_unit">
<span class="sig-name descname"><span class="pre">get_jansky_unit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.get_jansky_unit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_jansky_unit" title="Link to this definition">¶</a></dt>
<dd><p>Return the Jansky’s per unit area.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>janskys</strong><span class="classifier">units.Quantity</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_map_2d">
<span class="sig-name descname"><span class="pre">get_map_2d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.get_map_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_map_2d" title="Link to this definition">¶</a></dt>
<dd><p>Return the 2D map.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Map2D</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_peak_coords">
<span class="sig-name descname"><span class="pre">get_peak_coords</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.get_peak_coords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_peak_coords" title="Link to this definition">¶</a></dt>
<dd><p>Return the coordinates of the peak value.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>peak_coordinates</strong><span class="classifier">Coordinate2D</span></dt><dd><p>The (x, y) peak coordinate.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_peak_index">
<span class="sig-name descname"><span class="pre">get_peak_index</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.get_peak_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_peak_index" title="Link to this definition">¶</a></dt>
<dd><p>Return the peak index.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>index</strong><span class="classifier">Index2D</span></dt><dd><p>The peak (x, y) coordinate.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_peak_source">
<span class="sig-name descname"><span class="pre">get_peak_source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">degree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_degrees</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.get_peak_source"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_peak_source" title="Link to this definition">¶</a></dt>
<dd><p>Return the peak source model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>degree</strong><span class="classifier">int, optional</span></dt><dd><p>The spline degree used to fit the peak map value.</p>
</dd>
<dt><strong>reduce_degrees</strong><span class="classifier">bool, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, allow the spline fit to reduce the number of degrees
in cases where there are not enough points available to perform
the spline fit of <code class="xref py py-obj docutils literal notranslate"><span class="pre">degree</span></code>.  If <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, a ValueError will be
raised if such a fit fails.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>GaussianSource</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_pixel_footprint">
<span class="sig-name descname"><span class="pre">get_pixel_footprint</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.get_pixel_footprint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_pixel_footprint" title="Link to this definition">¶</a></dt>
<dd><p>Returns the Number of bytes per pixel.</p>
<p>This is probably no longer relevant and just copies CRUSH.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>int</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_source_name">
<span class="sig-name descname"><span class="pre">get_source_name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.get_source_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_source_name" title="Link to this definition">¶</a></dt>
<dd><p>Return the source name.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>str</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_table_entry">
<span class="sig-name descname"><span class="pre">get_table_entry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.get_table_entry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_table_entry" title="Link to this definition">¶</a></dt>
<dd><p>Return a parameter value for a given name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name</strong><span class="classifier">str, optional</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>value</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_unit">
<span class="sig-name descname"><span class="pre">get_unit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.get_unit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_unit" title="Link to this definition">¶</a></dt>
<dd><p>Return the map data unit.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>astropy.units.Quantity</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.is_masked">
<span class="sig-name descname"><span class="pre">is_masked</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.is_masked"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.is_masked" title="Link to this definition">¶</a></dt>
<dd><p>Return the map mask.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>numpy.ndarray (bool)</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.mask_integration_samples">
<span class="sig-name descname"><span class="pre">mask_integration_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">integration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SAMPLE_SKIP'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.mask_integration_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.mask_integration_samples" title="Link to this definition">¶</a></dt>
<dd><p>Set the sample flag in an integration for masked map elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>integration</strong><span class="classifier">Integration</span></dt><dd></dd>
<dt><strong>flag</strong><span class="classifier">str or int or Enum, optional</span></dt><dd><p>The name, integer identifier, or actual flag by which to flag
samples.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.mask_samples">
<span class="sig-name descname"><span class="pre">mask_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SAMPLE_SKIP'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.mask_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.mask_samples" title="Link to this definition">¶</a></dt>
<dd><p>Propagate masked source samples to integration sample flags.</p>
<p>Flags the integration samples using the given flag if they correspond
to a masked source sample.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>flag</strong><span class="classifier">str or int or Enum, optional</span></dt><dd><p>The name, integer identifier, or actual flag by which to mask
samples.  By default, any integration samples that correspond to
masked source samples will be flagged as ‘SAMPLE_SKIP’.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.mem_correct">
<span class="sig-name descname"><span class="pre">mem_correct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lg_multiplier</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.mem_correct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.mem_correct" title="Link to this definition">¶</a></dt>
<dd><p>Apply maximum entropy correction to the map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>lg_multiplier</strong><span class="classifier">float</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.merge_accumulate">
<span class="sig-name descname"><span class="pre">merge_accumulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.merge_accumulate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.merge_accumulate" title="Link to this definition">¶</a></dt>
<dd><p>Merge another source with this one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>other</strong><span class="classifier">AstroIntensityMap</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.merge_mask">
<span class="sig-name descname"><span class="pre">merge_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other_map</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.merge_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.merge_mask" title="Link to this definition">¶</a></dt>
<dd><p>Merge the mask from another map onto this one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>other_map</strong><span class="classifier">FlaggedArray</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.post_process_scan">
<span class="sig-name descname"><span class="pre">post_process_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scan</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.post_process_scan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.post_process_scan" title="Link to this definition">¶</a></dt>
<dd><p>Perform post-processing steps on a scan.</p>
<p>At this stage, the map should have already been added to the main
reduction map and we are left with a throw-away map that can be used
to update settings in other objects.  The intensity map may be used to
update the pointing for a given scan.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>scan</strong><span class="classifier">Scan</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.process_final">
<span class="sig-name descname"><span class="pre">process_final</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.process_final"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.process_final" title="Link to this definition">¶</a></dt>
<dd><p>Perform the final processing steps.</p>
<p>The additional steps performed for the AstroIntensityMap are
map leveling (if not extended or deep) and map re-weighting.
The map may also be resampled if re-griding is enabled.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.reset_filtering">
<span class="sig-name descname"><span class="pre">reset_filtering</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.reset_filtering"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.reset_filtering" title="Link to this definition">¶</a></dt>
<dd><p>Reset the map filtering.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.reset_processing">
<span class="sig-name descname"><span class="pre">reset_processing</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.reset_processing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.reset_processing" title="Link to this definition">¶</a></dt>
<dd><p>Reset the source processing.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.set_base">
<span class="sig-name descname"><span class="pre">set_base</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.set_base"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.set_base" title="Link to this definition">¶</a></dt>
<dd><p>Set the base to the map (copy of).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.set_data_shape">
<span class="sig-name descname"><span class="pre">set_data_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.set_data_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.set_data_shape" title="Link to this definition">¶</a></dt>
<dd><p>Set the shape of the map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>shape</strong><span class="classifier">tuple (int)</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.set_filtering">
<span class="sig-name descname"><span class="pre">set_filtering</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fwhm</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.set_filtering"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.set_filtering" title="Link to this definition">¶</a></dt>
<dd><p>Set the map filtering FWHM.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>fwhm</strong><span class="classifier">astropy.units.Quantity</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.set_info">
<span class="sig-name descname"><span class="pre">set_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">info</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.set_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.set_info" title="Link to this definition">¶</a></dt>
<dd><p>Set the Info object for the source model.</p>
<p>This sets the provided <code class="xref py py-obj docutils literal notranslate"><span class="pre">info</span></code> as the primary Info object containing
the configuration and reduction information for the source model.
The source model will also take ownership of the <code class="xref py py-obj docutils literal notranslate"><span class="pre">info</span></code> and set
various parameters from the contents.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>info</strong><span class="classifier">sofia_redux.info.info.Info</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.smooth_to">
<span class="sig-name descname"><span class="pre">smooth_to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fwhm</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.smooth_to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.smooth_to" title="Link to this definition">¶</a></dt>
<dd><p>Smooth the map to a given FWHM.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>fwhm</strong><span class="classifier">astropy.units.Quantity or Gaussian2D</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.stand_alone">
<span class="sig-name descname"><span class="pre">stand_alone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.stand_alone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.stand_alone" title="Link to this definition">¶</a></dt>
<dd><p>Create a stand alone base image.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.sync_source_gains">
<span class="sig-name descname"><span class="pre">sync_source_gains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_gains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_gains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sync_gains</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.sync_source_gains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.sync_source_gains" title="Link to this definition">¶</a></dt>
<dd><p>Remove the map source from frame data.</p>
<p>In addition to source removal, samples are also flagged if the map
is masked at that location.</p>
<p>For a given sample at frame i and channel j, frame data d_{i,j} will be
decremented by dg where:</p>
<p>dg = fg * ( (gain(source) * map[index]) - (gain(sync) * base[index]) )</p>
<p>Here, fg is the frame gain and index is the index on the map of sample
(i,j).</p>
<p>Any masked map value will result in matching samples being flagged.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>frames</strong><span class="classifier">Frames</span></dt><dd><p>The frames for which to remove the source gains.</p>
</dd>
<dt><strong>pixels</strong><span class="classifier">Channels or ChannelGroup</span></dt><dd><p>The channels for which to remove the source gains.</p>
</dd>
<dt><strong>frame_gains</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>An array of frame gains of shape (n_frames,).</p>
</dd>
<dt><strong>source_gains</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>An array of channel source gains for all channels of shape
(all_channels,).</p>
</dd>
<dt><strong>sync_gains</strong><span class="classifier">numpy.ndarray (float)</span></dt><dd><p>an array of channel sync gains for all channels of shape
(all_channels,).  The sync gains should contain the prior source
gain.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.update_mask">
<span class="sig-name descname"><span class="pre">update_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">blanking_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_neighbors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sofia_redux/scan/source_models/astro_intensity_map.html#AstroIntensityMap.update_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.update_mask" title="Link to this definition">¶</a></dt>
<dd><p>Update the map mask based on significance levels and valid neighbors.</p>
<p>If a blanking level is supplied, significance values above or equal to
the blanking level will be masked.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>blanking_level</strong><span class="classifier">float, optional</span></dt><dd><p>The significance level used to mark the map.  If not supplied,
significance is irrelevant.  See above for more details.</p>
</dd>
<dt><strong>min_neighbors</strong><span class="classifier">int, optional</span></dt><dd><p>The minimum number of neighbors including the pixel itself.
Therefore, the default of 2 excludes single pixels as this would
require a single valid pixel and one valid neighbor.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">AstroIntensityMap</a><ul>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap</span></code></a><ul>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.flagspace"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.flagspace</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.referenced_attributes"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.referenced_attributes</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.shape"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.shape</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.add_base"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.add_base()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.add_frames_from_integration"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.add_frames_from_integration()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.add_model_data"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.add_model_data()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.add_points"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.add_points()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.base_footprint"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.base_footprint()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.calculate_coupling"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.calculate_coupling()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.clear_all_memory"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.clear_all_memory()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.copy"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.copy()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.covariant_points"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.covariant_points()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.create_from"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.create_from()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.create_map"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.create_map()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.filter_beam_correct"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.filter_beam_correct()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.filter_source"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.filter_source()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_clean_local_copy"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.get_clean_local_copy()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_data"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.get_data()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_jansky_unit"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.get_jansky_unit()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_map_2d"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.get_map_2d()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_peak_coords"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.get_peak_coords()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_peak_index"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.get_peak_index()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_peak_source"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.get_peak_source()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_pixel_footprint"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.get_pixel_footprint()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_source_name"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.get_source_name()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_table_entry"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.get_table_entry()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.get_unit"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.get_unit()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.is_masked"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.is_masked()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.mask_integration_samples"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.mask_integration_samples()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.mask_samples"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.mask_samples()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.mem_correct"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.mem_correct()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.merge_accumulate"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.merge_accumulate()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.merge_mask"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.merge_mask()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.post_process_scan"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.post_process_scan()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.process_final"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.process_final()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.reset_filtering"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.reset_filtering()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.reset_processing"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.reset_processing()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.set_base"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.set_base()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.set_data_shape"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.set_data_shape()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.set_filtering"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.set_filtering()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.set_info"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.set_info()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.smooth_to"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.smooth_to()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.stand_alone"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.stand_alone()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.sync_source_gains"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.sync_source_gains()</span></code></a></li>
<li><a class="reference internal" href="#sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.update_mask"><code class="docutils literal notranslate"><span class="pre">AstroIntensityMap.update_mask()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/sofia_redux.scan.source_models.astro_intensity_map.AstroIntensityMap.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2024, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.2.6. &nbsp;
    Last built 05 Feb 2024. <br/>
  </p>
</footer>
  </body>
</html>