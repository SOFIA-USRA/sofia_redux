<!DOCTYPE html>

<html lang="en" data-content_root="../../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>sofia_redux.scan.source_models.sky_dip &#8212; sofia_redux v1.3.4.dev38+g92ea2f4</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/bootstrap-sofia.css?v=3fe2c07e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css" />
    
    <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../../../_static/documentation_options.js?v=6aa39468"></script>
    <script src="../../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script type="text/javascript" src="../../../../_static/sidebar.js"></script>
    <script type="text/javascript" src="../../../../_static/copybutton.js"></script>
    <link rel="icon" href="../../../../_static/redux.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../../../index.html"><span id="logotext1">SOFIA</span><span id="logotext2">Redux</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="SOFIA Homepage" href="https://irsa.ipac.caltech.edu/Missions/sofia.html"></a></li>
    <li><a title="General Index" href="../../../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li>
	<a href="../../../../index.html">sofia_redux v1.3.4.dev38+g92ea2f4</a>
	 &#187;
      </li>
      <li><a href="../../../index.html" accesskey="U">Module code</a> &#187;</li>
      
       
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for sofia_redux.scan.source_models.sky_dip</h1><div class="highlight"><pre>
<span></span># Licensed under a 3-clause BSD style license - see LICENSE.rst

from astropy import log, units
import numpy as np
import os
import warnings

from sofia_redux.scan.source_models.source_model import SourceModel
from sofia_redux.scan.source_models.sky_dip_model import SkyDipModel
from sofia_redux.scan.source_models import source_numba_functions as snf
from sofia_redux.scan.utilities.range import Range
from sofia_redux.scan.utilities.utils import round_values

__all__ = [&#39;SkyDip&#39;]


<div class="viewcode-block" id="SkyDip">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.source_models.sky_dip.SkyDip.html#sofia_redux.scan.source_models.sky_dip.SkyDip">[docs]</a>
class SkyDip(SourceModel):

    def __init__(self, info, reduction=None):
        &quot;&quot;&quot;
        Initialize a skydip model.

        The SkyDip source model is used to measure and store a model of the
        instrument response and atmospheric parameters with respect to the
        elevation of an observation.

        Parameters
        ----------
        info : sofia_redux.scan.info.info.Info
            The Info object which should belong to this source model.
        reduction : sofia_redux.scan.reduction.reduction.Reduction, optional
            The reduction for which this source model should be applied.
        &quot;&quot;&quot;
        super().__init__(info=info, reduction=reduction)
        self.data = None
        self.weight = None
        self.resolution = 0.0
        self.tamb = 0.0 * units.Unit(&#39;Kelvin&#39;)
        self.tamb_weight = 0.0 * units.Unit(&#39;second&#39;)
        self.signal_name = &#39;obs-channels&#39;
        self.signal_index = 0
        self.model = SkyDipModel()

<div class="viewcode-block" id="SkyDip.copy">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.source_models.sky_dip.SkyDip.html#sofia_redux.scan.source_models.sky_dip.SkyDip.copy">[docs]</a>
    def copy(self, with_contents=True):
        &quot;&quot;&quot;
        Return a copy of the SkyDip.

        Parameters
        ----------
        with_contents : bool, optional
            If `True`, return a true copy of the source model.  Otherwise, just
            return a basic version with the necessary meta data.

        Returns
        -------
        SkyDip
        &quot;&quot;&quot;
        copy = super().copy(with_contents=with_contents)
        return copy</div>


<div class="viewcode-block" id="SkyDip.clear_all_memory">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.source_models.sky_dip.SkyDip.html#sofia_redux.scan.source_models.sky_dip.SkyDip.clear_all_memory">[docs]</a>
    def clear_all_memory(self):
        &quot;&quot;&quot;
        Clear all memory references prior to deletion.

        Returns
        -------
        None
        &quot;&quot;&quot;
        super().clear_all_memory()
        self.data = None
        self.weight = None</div>


    @property
    def logging_id(self):
        &quot;&quot;&quot;
        Return the logging ID.

        Returns
        -------
        str
        &quot;&quot;&quot;
        return &#39;skydip&#39;

<div class="viewcode-block" id="SkyDip.get_unit">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.source_models.sky_dip.SkyDip.html#sofia_redux.scan.source_models.sky_dip.SkyDip.get_unit">[docs]</a>
    def get_unit(self):
        &quot;&quot;&quot;
        Return the unit for the model

        Returns
        -------
        units.Unit
        &quot;&quot;&quot;
        return units.Unit(&#39;Kelvin&#39;)</div>


<div class="viewcode-block" id="SkyDip.get_table_entry">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.source_models.sky_dip.SkyDip.html#sofia_redux.scan.source_models.sky_dip.SkyDip.get_table_entry">[docs]</a>
    def get_table_entry(self, name):
        &quot;&quot;&quot;
        Return a parameter value for a given name.

        Parameters
        ----------
        name : str

        Returns
        -------
        value
        &quot;&quot;&quot;
        parameters = self.model.parameters
        errors = self.model.errors
        if parameters is None:
            parameters = {}
        if errors is None:
            errors = {}

        if name == &#39;tau&#39;:
            return parameters.get(&#39;tau&#39;)
        elif name == &#39;dtau&#39;:
            return errors.get(&#39;tau&#39;)
        elif name == &#39;kelvin&#39;:
            return parameters.get(&#39;kelvin&#39;)
        elif name == &#39;dkelvin&#39;:
            return errors.get(&#39;kelvin&#39;)
        elif name == &#39;tsky&#39;:
            return parameters.get(&#39;tsky&#39;)
        elif name == &#39;dtsky&#39;:
            return errors.get(&#39;tsky&#39;)
        else:
            return super().get_table_entry(name)</div>


<div class="viewcode-block" id="SkyDip.clear_content">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.source_models.sky_dip.SkyDip.html#sofia_redux.scan.source_models.sky_dip.SkyDip.clear_content">[docs]</a>
    def clear_content(self):
        &quot;&quot;&quot;
        Clear the SkyDip data contents.

        Returns
        -------
        None
        &quot;&quot;&quot;
        if isinstance(self.data, np.ndarray):
            self.data.fill(0.0)
        else:
            self.data = None
        if isinstance(self.weight, np.ndarray):
            self.weight.fill(0.0)
        else:
            self.weight = None
        self.tamb = 0.0 * units.Unit(&#39;Kelvin&#39;)
        self.tamb_weight = 0.0 * units.Unit(&#39;second&#39;)</div>


<div class="viewcode-block" id="SkyDip.average_temp_with">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.source_models.sky_dip.SkyDip.html#sofia_redux.scan.source_models.sky_dip.SkyDip.average_temp_with">[docs]</a>
    def average_temp_with(self, temp, weight):
        &quot;&quot;&quot;
        Average the existing temperature with another.

        Parameters
        ----------
        temp : units.Quantity
            The temperature in Kelvins to average with the current temperature.
        weight : units.Quantity
            The weight value of `temp` in seconds.

        Returns
        -------
        None
        &quot;&quot;&quot;
        if np.isnan(temp) or np.isnan(weight) or weight == 0:
            return

        wd_sum = self.tamb * self.tamb_weight
        wd_sum += temp * weight
        w_sum = self.tamb_weight + weight
        self.tamb = wd_sum / w_sum if w_sum &gt; 0 else wd_sum / units.Unit(&#39;s&#39;)
        self.tamb_weight = w_sum</div>


<div class="viewcode-block" id="SkyDip.create_from">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.source_models.sky_dip.SkyDip.html#sofia_redux.scan.source_models.sky_dip.SkyDip.create_from">[docs]</a>
    def create_from(self, scans, assign_scans=True):
        &quot;&quot;&quot;
        Initialize a skydip model from scans.

        Sets the model scans to those provided, and the source model for each
        scan as this.  All integration gains are normalized to the first scan.
        If the first scan is non-sidereal, the system will be forced to an
        equatorial frame.

        Parameters
        ----------
        scans : list (Scan)
            A list of scans from which to create the model.
        assign_scans : bool, optional
            If `True`, assign the scans to this source model.  Otherwise,
            there will be no hard link between the scans and source model.

        Returns
        -------
        None
        &quot;&quot;&quot;
        super().create_from(scans, assign_scans=assign_scans)
        if self.has_option(&#39;skydip.grid&#39;):
            resolution = self.configuration.get_float(&#39;skydip.grid&#39;)
            self.resolution = resolution * units.Unit(&#39;arcsec&#39;)
        else:
            self.resolution = 900 * units.Unit(&#39;arcsec&#39;)  # 1/4 degree

        if self.has_option(&#39;skydip.signal&#39;):
            self.signal_name = self.configuration.get_string(&#39;skydip.signal&#39;)
        if self.has_option(&#39;skydip.mode&#39;):
            self.signal_index = self.configuration.get_int(&#39;skydip.mode&#39;)

        n_data = ((90 * units.Unit(&#39;degree&#39;)) / self.resolution).decompose()
        n_data = int(np.ceil(n_data))
        self.data = np.zeros(n_data, dtype=float)
        self.weight = np.zeros(n_data, dtype=float)</div>


<div class="viewcode-block" id="SkyDip.get_bin">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.source_models.sky_dip.SkyDip.html#sofia_redux.scan.source_models.sky_dip.SkyDip.get_bin">[docs]</a>
    def get_bin(self, elevation):
        &quot;&quot;&quot;
        Return the bin for the given elevation.

        Parameters
        ----------
        elevation : units.Quantity

        Returns
        -------
        bins : int or numpy.ndarray (int)
        &quot;&quot;&quot;
        singular = elevation.shape == ()
        if singular and (np.isnan(elevation) or self.resolution == 0):
            return -1

        float_bins = (elevation / self.resolution).decompose().value
        if singular:
            if not np.isfinite(float_bins):
                return -1
            else:
                return int(round_values(float_bins))

        float_bins[~np.isfinite(float_bins)] = -1
        return round_values(float_bins)</div>


<div class="viewcode-block" id="SkyDip.get_elevation">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.source_models.sky_dip.SkyDip.html#sofia_redux.scan.source_models.sky_dip.SkyDip.get_elevation">[docs]</a>
    def get_elevation(self, bins):
        &quot;&quot;&quot;
        Return the elevation for a given bin or bins.

        Parameters
        ----------
        bins : int or numpy.ndarray (int)

        Returns
        -------
        elevation : units.Quantity
        &quot;&quot;&quot;
        return (bins + 0.5) * self.resolution</div>


<div class="viewcode-block" id="SkyDip.add_model_data">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.source_models.sky_dip.SkyDip.html#sofia_redux.scan.source_models.sky_dip.SkyDip.add_model_data">[docs]</a>
    def add_model_data(self, skydip, weight=1.0):
        &quot;&quot;&quot;
        Add an increment source model data onto the current model.

        Parameters
        ----------
        skydip : SkyDip
            The skydip increment.
        weight : float, optional
            The weight of the model increment.  Not applicable for the skydip
            model.

        Returns
        -------
        None
        &quot;&quot;&quot;
        # Average the temperature
        self.average_temp_with(skydip.tamb, skydip.tamb_weight)

        # Average the data
        if skydip.data is None:
            return

        if self.data is None:
            self.data = skydip.data.copy()
            self.weight = skydip.weight.copy()
            return

        if self.data.shape != skydip.data.shape:
            raise ValueError(f&quot;SkyDip data shapes do not match: &quot;
                             f&quot;{self.data.shape} != {skydip.data.shape}&quot;)

        wd_sum = self.data * self.weight
        wd_sum += skydip.data * skydip.weight
        w_sum = self.weight + skydip.weight
        nzi = w_sum &gt; 0
        self.data[nzi] = wd_sum[nzi] / w_sum[nzi]
        self.data[~nzi] = wd_sum[~nzi]
        self.weight = w_sum</div>


<div class="viewcode-block" id="SkyDip.add_integration">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.source_models.sky_dip.SkyDip.html#sofia_redux.scan.source_models.sky_dip.SkyDip.add_integration">[docs]</a>
    def add_integration(self, integration):
        &quot;&quot;&quot;
        Add an integration to the sky dip.

        Parameters
        ----------
        integration : Integration

        Returns
        -------
        None
        &quot;&quot;&quot;
        integration.comments.append(&quot;[Dip]&quot;)
        modality = integration.channels.modalities.get(self.signal_name)
        if modality is None:
            raise ValueError(f&quot;{self.signal_name} not found in integration &quot;
                             f&quot;channel modalities.&quot;)
        try:
            mode = modality.modes[self.signal_index]
        except IndexError:
            raise ValueError(f&quot;Cannot retrieve signal &quot;
                             f&quot;index {self.signal_index} &quot;
                             f&quot;from integration channel {self.signal_name} &quot;
                             f&quot;modality modes.&quot;)

        signal = integration.get_signal(mode)
        if signal is None:
            signal_class = integration.get_correlated_signal_class()
            signal = signal_class(integration, mode)
            try:
                signal.update(robust=False)
            except Exception as err:
                log.error(f&quot;Cannot decorrelate sky channels: {err}&quot;)
            signal = integration.get_signal(mode)

        valid_frames = integration.frames.is_unflagged(&#39;SOURCE_FLAGS&#39;)
        valid_frames &amp;= integration.frames.valid

        frame_indices = np.arange(integration.frames.size)

        snf.add_skydip_frames(
            data=self.data,
            weight=self.weight,
            signal_values=signal.value_at(frame_indices),
            signal_weights=signal.weight_at(frame_indices),
            frame_weights=integration.frames.relative_weight,
            frame_valid=valid_frames,
            data_bins=self.get_bin(integration.frames.horizontal.el))</div>


<div class="viewcode-block" id="SkyDip.set_base">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.source_models.sky_dip.SkyDip.html#sofia_redux.scan.source_models.sky_dip.SkyDip.set_base">[docs]</a>
    def set_base(self):
        &quot;&quot;&quot;
        Set the base map of the model.

        This is unused for the SkyDip class.

        Returns
        -------
        None
        &quot;&quot;&quot;
        pass</div>


<div class="viewcode-block" id="SkyDip.get_source_name">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.source_models.sky_dip.SkyDip.html#sofia_redux.scan.source_models.sky_dip.SkyDip.get_source_name">[docs]</a>
    def get_source_name(self):
        &quot;&quot;&quot;
        Return the source name for the sky dip model.

        Returns
        -------
        str
        &quot;&quot;&quot;
        return &#39;SkyDip&#39;</div>


<div class="viewcode-block" id="SkyDip.end_accumulation">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.source_models.sky_dip.SkyDip.html#sofia_redux.scan.source_models.sky_dip.SkyDip.end_accumulation">[docs]</a>
    def end_accumulation(self):
        &quot;&quot;&quot;
        End model accumulation by scaling with inverse weights.

        Returns
        -------
        None
        &quot;&quot;&quot;
        if self.data is None or self.weight is None:
            return
        nzi = self.weight != 0
        self.data[nzi] /= self.weight[nzi]</div>


<div class="viewcode-block" id="SkyDip.process_scan">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.source_models.sky_dip.SkyDip.html#sofia_redux.scan.source_models.sky_dip.SkyDip.process_scan">[docs]</a>
    def process_scan(self, scan):
        &quot;&quot;&quot;
        Process a scan.

        Parameters
        ----------
        scan : Scan

        Returns
        -------
        None
        &quot;&quot;&quot;
        self.end_accumulation()
        if hasattr(scan.info, &#39;get_ambient_kelvins&#39;):
            ambient_temp = scan.info.get_ambient_kelvins()
            if not np.isnan(ambient_temp):
                obs_time = scan.get_observing_time()
                self.average_temp_with(ambient_temp, obs_time)</div>


<div class="viewcode-block" id="SkyDip.count_points">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.source_models.sky_dip.SkyDip.html#sofia_redux.scan.source_models.sky_dip.SkyDip.count_points">[docs]</a>
    def count_points(self):
        &quot;&quot;&quot;
        Return the number of points in the skydip model.

        Returns
        -------
        int
        &quot;&quot;&quot;
        if self.weight is None:
            return 0
        return int(np.sum(self.weight &gt; 0))</div>


<div class="viewcode-block" id="SkyDip.sync_integration">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.source_models.sky_dip.SkyDip.html#sofia_redux.scan.source_models.sky_dip.SkyDip.sync_integration">[docs]</a>
    def sync_integration(self, integration, signal_mode=None):
        &quot;&quot;&quot;
        Synchronize the sky dip model with an integration.

        This is not used for the :class:`SkyDip` class.

        Parameters
        ----------
        integration : Integration
        signal_mode : FrameFlagTypes
            The signal mode flag, indicating which signal should be used to
            extract the frame source gains.  Typically, TOTAL_POWER.

        Returns
        -------
        None
        &quot;&quot;&quot;
        pass</div>


<div class="viewcode-block" id="SkyDip.get_signal_range">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.source_models.sky_dip.SkyDip.html#sofia_redux.scan.source_models.sky_dip.SkyDip.get_signal_range">[docs]</a>
    def get_signal_range(self):
        &quot;&quot;&quot;
        Return the signal range of the SkyDip model.

        Returns
        -------
        Range
        &quot;&quot;&quot;
        signal_range = Range()
        if self.data is None or self.weight is None:
            return signal_range
        values = self.data[self.weight &gt; 0]
        with warnings.catch_warnings():
            warnings.simplefilter(&#39;ignore&#39;, RuntimeWarning)
            signal_range.min = np.nanmin(values)
            signal_range.max = np.nanmax(values)
        return signal_range</div>


<div class="viewcode-block" id="SkyDip.get_elevation_range">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.source_models.sky_dip.SkyDip.html#sofia_redux.scan.source_models.sky_dip.SkyDip.get_elevation_range">[docs]</a>
    def get_elevation_range(self):
        &quot;&quot;&quot;
        Return the elevation range of the model.

        Returns
        -------
        Range
        &quot;&quot;&quot;
        el_range = Range()
        valid = np.nonzero(self.weight &gt; 0)[0]
        elevations = self.get_elevation(valid)
        with warnings.catch_warnings():
            warnings.simplefilter(&#39;ignore&#39;, RuntimeWarning)
            el_range.min = np.nanmin(elevations)
            el_range.max = np.nanmax(elevations)
        return el_range</div>


<div class="viewcode-block" id="SkyDip.get_air_mass_range">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.source_models.sky_dip.SkyDip.html#sofia_redux.scan.source_models.sky_dip.SkyDip.get_air_mass_range">[docs]</a>
    def get_air_mass_range(self):
        &quot;&quot;&quot;
        Return the range of air masses in the model.

        Returns
        -------
        Range
        &quot;&quot;&quot;
        el_range = self.get_elevation_range()
        lower = 1.0 / np.sin(el_range.max)
        upper = 1.0 / np.sin(el_range.min)
        if isinstance(lower, units.Quantity):
            lower = lower.decompose().value
            upper = upper.decompose().value

        am_range = Range(min_val=lower, max_val=upper)
        return am_range</div>


<div class="viewcode-block" id="SkyDip.fit">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.source_models.sky_dip.SkyDip.html#sofia_redux.scan.source_models.sky_dip.SkyDip.fit">[docs]</a>
    def fit(self, model):
        &quot;&quot;&quot;
        Fit the sky dip data to a model.

        Parameters
        ----------
        model : SkyDipModel

        Returns
        -------
        None
        &quot;&quot;&quot;
        model.set_configuration(self.configuration)
        model.fit(self)</div>


<div class="viewcode-block" id="SkyDip.write">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.source_models.sky_dip.SkyDip.html#sofia_redux.scan.source_models.sky_dip.SkyDip.write">[docs]</a>
    def write(self, path=None):
        &quot;&quot;&quot;
        Write the sky dip model to file.

        Parameters
        ----------
        path : str, optional
            The directory in which to write the results.  The default is the
            reduction work path.

        Returns
        -------
        None
        &quot;&quot;&quot;
        self.model = SkyDipModel()
        if path is None:
            path = self.configuration.work_path

        initial_values = self.model.initial_guess
        initial_values[&#39;kelvin&#39;] = self.info.kelvin.to(
            &quot;Kelvin&quot;, equivalencies=units.temperature()).value
        self.model.data_unit = self.info.instrument.get_data_unit()
        self.fit(self.model)

        if self.model.has_converged:
            msg = [&#39;Skydip result:&#39;,
                   &#39;=================================================&#39;,
                   f&#39;{self.model}&#39;,
                   &#39;=================================================&#39;]
            log.info(&#39;\n&#39;.join(msg))
        else:  # pragma: no cover
            log.warning(&quot;Skydip fit did not converge...&quot;)

        name = self.configuration.get_string(
            &#39;name&#39;, default=self.get_default_core_name())
        core_name = os.path.join(path, name)
        filename = f&#39;{core_name}.dat&#39;
        header = [x.strip() for x in str(self.model).split(&#39;\n&#39;)]
        header = [f&#39;# {x}&#39; for x in header if x != &#39;&#39;]
        header.extend([&#39;#&#39;, &#39;# EL\tobs\tmodel&#39;])

        body = []
        n_data = self.data.size
        elevations = self.get_elevation(np.arange(n_data)).to(&#39;degree&#39;)
        fit = self.model.fit_elevation(elevations)
        el = elevations.value
        for i in range(self.data.size):
            line = f&#39;{el[i]:.3f}\t&#39;
            line += &#39;...\t&#39; if self.weight[i] == 0 else f&#39;{self.data[i]:.3e}\t&#39;
            line += f&#39;{fit[i]:.3e}&#39;
            body.append(line)

        with open(filename, &#39;w&#39;) as f:
            for line in (header + body):
                print(line, file=f)

        log.info(f&quot;Written {filename}&quot;)

        self.create_plot(core_name)</div>


<div class="viewcode-block" id="SkyDip.create_plot">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.source_models.sky_dip.SkyDip.html#sofia_redux.scan.source_models.sky_dip.SkyDip.create_plot">[docs]</a>
    def create_plot(self, core_name):
        &quot;&quot;&quot;
        Write a plot of the model and data to file.

        Parameters
        ----------
        core_name : str
            The name of the file to write to including the full file path but
            excluding the file extension.

        Returns
        -------
        None
        &quot;&quot;&quot;
        pass</div>


<div class="viewcode-block" id="SkyDip.no_parallel">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.source_models.sky_dip.SkyDip.html#sofia_redux.scan.source_models.sky_dip.SkyDip.no_parallel">[docs]</a>
    def no_parallel(self):
        &quot;&quot;&quot;
        Do not use parallel processing.

        Not applicable for the SkyDip model.

        Returns
        -------
        None
        &quot;&quot;&quot;
        pass</div>


<div class="viewcode-block" id="SkyDip.set_parallel">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.source_models.sky_dip.SkyDip.html#sofia_redux.scan.source_models.sky_dip.SkyDip.set_parallel">[docs]</a>
    def set_parallel(self, threads):
        &quot;&quot;&quot;
        Set the number of parallel operations for the skydip model.

        Not applicable for the SkyDip model.

        Parameters
        ----------
        threads : int

        Returns
        -------
        None
        &quot;&quot;&quot;
        pass</div>


<div class="viewcode-block" id="SkyDip.process">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.source_models.sky_dip.SkyDip.html#sofia_redux.scan.source_models.sky_dip.SkyDip.process">[docs]</a>
    def process(self):
        &quot;&quot;&quot;
        Process the skydip model.

        Not applicable for the SkyDip model.

        Returns
        -------
        None
        &quot;&quot;&quot;
        pass</div>


<div class="viewcode-block" id="SkyDip.is_valid">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.source_models.sky_dip.SkyDip.html#sofia_redux.scan.source_models.sky_dip.SkyDip.is_valid">[docs]</a>
    def is_valid(self):
        &quot;&quot;&quot;
        Return whether the skydip model is valid or not.

        Returns
        -------
        bool
        &quot;&quot;&quot;
        return self.count_points() &gt; 0</div>


<div class="viewcode-block" id="SkyDip.set_executor">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.source_models.sky_dip.SkyDip.html#sofia_redux.scan.source_models.sky_dip.SkyDip.set_executor">[docs]</a>
    def set_executor(self, executor):
        &quot;&quot;&quot;
        Set the parallel task executor.

        Not applicable for the SkyDip model.

        Parameters
        ----------
        executor : object

        Returns
        -------
        None
        &quot;&quot;&quot;
        pass</div>


<div class="viewcode-block" id="SkyDip.get_parallel">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.source_models.sky_dip.SkyDip.html#sofia_redux.scan.source_models.sky_dip.SkyDip.get_parallel">[docs]</a>
    def get_parallel(self):
        &quot;&quot;&quot;
        Get the number of parallel operations for the source model.

        Not applicable for the SkyDip model.

        Returns
        -------
        threads : int
        &quot;&quot;&quot;
        return 1</div>


<div class="viewcode-block" id="SkyDip.get_reference">
<a class="viewcode-back" href="../../../../api/sofia_redux.scan.source_models.sky_dip.SkyDip.html#sofia_redux.scan.source_models.sky_dip.SkyDip.get_reference">[docs]</a>
    def get_reference(self):
        &quot;&quot;&quot;
        Return the reference (x, y) coordinate.

        Not applicable for the SkyDip model.

        Returns
        -------
        None
        &quot;&quot;&quot;
        return None</div>
</div>

</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right"> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2024, SOFIA-USRA.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.2.6. &nbsp;
    Last built 05 Feb 2024. <br/>
  </p>
</footer>
  </body>
</html>